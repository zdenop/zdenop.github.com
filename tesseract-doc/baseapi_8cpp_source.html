<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Tesseract: tesseract-ocr/api/baseapi.cpp Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Tesseract
   &#160;<span id="projectnumber">3.02</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.5.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('baseapi_8cpp.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">tesseract-ocr/api/baseapi.cpp</div>  </div>
</div>
<div class="contents">
<a href="baseapi_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/**********************************************************************</span>
<a name="l00002"></a>00002 <span class="comment"> * File:        baseapi.cpp</span>
<a name="l00003"></a>00003 <span class="comment"> * Description: Simple API for calling tesseract.</span>
<a name="l00004"></a>00004 <span class="comment"> * Author:      Ray Smith</span>
<a name="l00005"></a>00005 <span class="comment"> * Created:     Fri Oct 06 15:35:01 PDT 2006</span>
<a name="l00006"></a>00006 <span class="comment"> *</span>
<a name="l00007"></a>00007 <span class="comment"> * (C) Copyright 2006, Google Inc.</span>
<a name="l00008"></a>00008 <span class="comment"> ** Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<a name="l00009"></a>00009 <span class="comment"> ** you may not use this file except in compliance with the License.</span>
<a name="l00010"></a>00010 <span class="comment"> ** You may obtain a copy of the License at</span>
<a name="l00011"></a>00011 <span class="comment"> ** http://www.apache.org/licenses/LICENSE-2.0</span>
<a name="l00012"></a>00012 <span class="comment"> ** Unless required by applicable law or agreed to in writing, software</span>
<a name="l00013"></a>00013 <span class="comment"> ** distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<a name="l00014"></a>00014 <span class="comment"> ** WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<a name="l00015"></a>00015 <span class="comment"> ** See the License for the specific language governing permissions and</span>
<a name="l00016"></a>00016 <span class="comment"> ** limitations under the License.</span>
<a name="l00017"></a>00017 <span class="comment"> *</span>
<a name="l00018"></a>00018 <span class="comment"> **********************************************************************/</span>
<a name="l00019"></a>00019 
<a name="l00020"></a>00020 <span class="comment">// Include automatically generated configuration file if running autoconf.</span>
<a name="l00021"></a>00021 <span class="preprocessor">#ifdef HAVE_CONFIG_H</span>
<a name="l00022"></a>00022 <span class="preprocessor"></span><span class="preprocessor">#include &quot;<a class="code" href="config__auto_8h.html">config_auto.h</a>&quot;</span>
<a name="l00023"></a>00023 <span class="preprocessor">#endif</span>
<a name="l00024"></a>00024 <span class="preprocessor"></span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &quot;allheaders.h&quot;</span>
<a name="l00026"></a>00026 
<a name="l00027"></a>00027 <span class="preprocessor">#ifdef USING_GETTEXT</span>
<a name="l00028"></a>00028 <span class="preprocessor"></span><span class="preprocessor">#include &lt;libintl.h&gt;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &lt;locale.h&gt;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#define _(x) gettext(x)</span>
<a name="l00031"></a>00031 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l00032"></a><a class="code" href="baseapi_8cpp.html#af20b8d139279b360b0fdeae71f8f43bc">00032</a> <span class="preprocessor"></span><span class="preprocessor">#define _(x) (x)</span>
<a name="l00033"></a>00033 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00034"></a>00034 <span class="preprocessor"></span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &quot;<a class="code" href="baseapi_8h.html">baseapi.h</a>&quot;</span>
<a name="l00036"></a>00036 
<a name="l00037"></a>00037 <span class="preprocessor">#include &quot;<a class="code" href="resultiterator_8h.html">resultiterator.h</a>&quot;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &quot;<a class="code" href="mutableiterator_8h.html">mutableiterator.h</a>&quot;</span>
<a name="l00039"></a>00039 <span class="preprocessor">#include &quot;<a class="code" href="thresholder_8h.html">thresholder.h</a>&quot;</span>
<a name="l00040"></a>00040 <span class="preprocessor">#include &quot;<a class="code" href="tesseractclass_8h.html">tesseractclass.h</a>&quot;</span>
<a name="l00041"></a>00041 <span class="preprocessor">#include &quot;<a class="code" href="pageres_8h.html">pageres.h</a>&quot;</span>
<a name="l00042"></a>00042 <span class="preprocessor">#include &quot;<a class="code" href="paragraphs_8h.html">paragraphs.h</a>&quot;</span>
<a name="l00043"></a>00043 <span class="preprocessor">#include &quot;<a class="code" href="tessvars_8h.html">tessvars.h</a>&quot;</span>
<a name="l00044"></a>00044 <span class="preprocessor">#include &quot;<a class="code" href="control_8h.html">control.h</a>&quot;</span>
<a name="l00045"></a>00045 <span class="preprocessor">#include &quot;<a class="code" href="pgedit_8h.html">pgedit.h</a>&quot;</span>
<a name="l00046"></a>00046 <span class="preprocessor">#include &quot;<a class="code" href="paramsd_8h.html">paramsd.h</a>&quot;</span>
<a name="l00047"></a>00047 <span class="preprocessor">#include &quot;<a class="code" href="output_8h.html">output.h</a>&quot;</span>
<a name="l00048"></a>00048 <span class="preprocessor">#include &quot;<a class="code" href="globals_8h.html">globals.h</a>&quot;</span>
<a name="l00049"></a>00049 <span class="preprocessor">#include &quot;<a class="code" href="edgblob_8h.html">edgblob.h</a>&quot;</span>
<a name="l00050"></a>00050 <span class="preprocessor">#include &quot;<a class="code" href="equationdetect_8h.html">equationdetect.h</a>&quot;</span>
<a name="l00051"></a>00051 <span class="preprocessor">#include &quot;<a class="code" href="tessbox_8h.html">tessbox.h</a>&quot;</span>
<a name="l00052"></a>00052 <span class="preprocessor">#include &quot;<a class="code" href="imgs_8h.html">imgs.h</a>&quot;</span>
<a name="l00053"></a>00053 <span class="preprocessor">#include &quot;<a class="code" href="imgtiff_8h.html">imgtiff.h</a>&quot;</span>
<a name="l00054"></a>00054 <span class="preprocessor">#include &quot;<a class="code" href="makerow_8h.html">makerow.h</a>&quot;</span>
<a name="l00055"></a>00055 <span class="preprocessor">#include &quot;<a class="code" href="permute_8h.html">permute.h</a>&quot;</span>
<a name="l00056"></a>00056 <span class="preprocessor">#include &quot;<a class="code" href="otsuthr_8h.html">otsuthr.h</a>&quot;</span>
<a name="l00057"></a>00057 <span class="preprocessor">#include &quot;<a class="code" href="osdetect_8h.html">osdetect.h</a>&quot;</span>
<a name="l00058"></a>00058 <span class="preprocessor">#include &quot;<a class="code" href="params_8h.html">params.h</a>&quot;</span>
<a name="l00059"></a>00059 
<a name="l00060"></a>00060 <span class="preprocessor">#if defined(_WIN32) &amp;&amp; !defined(VERSION)</span>
<a name="l00061"></a>00061 <span class="preprocessor"></span><span class="preprocessor">#include &quot;version.h&quot;</span>
<a name="l00062"></a>00062 <span class="preprocessor">#endif</span>
<a name="l00063"></a>00063 <span class="preprocessor"></span>
<a name="l00064"></a><a class="code" href="namespacetesseract.html">00064</a> <span class="keyword">namespace </span>tesseract {
<a name="l00065"></a>00065 
<a name="l00066"></a>00066 <span class="comment">// Minimum sensible image size to be worth running tesseract.</span>
<a name="l00067"></a><a class="code" href="namespacetesseract.html#a11307fd919d7a9313500b04cfc1a8e3d">00067</a> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="namespacetesseract.html#a11307fd919d7a9313500b04cfc1a8e3d">kMinRectSize</a> = 10;
<a name="l00068"></a>00068 <span class="comment">// Character returned when Tesseract couldn&#39;t recognize as anything.</span>
<a name="l00069"></a><a class="code" href="namespacetesseract.html#a1083ed81b6adbb6930e87d0c58671e26">00069</a> <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="namespacetesseract.html#a1083ed81b6adbb6930e87d0c58671e26">kTesseractReject</a> = <span class="charliteral">&#39;~&#39;</span>;
<a name="l00070"></a>00070 <span class="comment">// Character used by UNLV error counter as a reject.</span>
<a name="l00071"></a><a class="code" href="namespacetesseract.html#a99bec48b41ccb504c28851dbe5b1f106">00071</a> <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="namespacetesseract.html#a99bec48b41ccb504c28851dbe5b1f106">kUNLVReject</a> = <span class="charliteral">&#39;~&#39;</span>;
<a name="l00072"></a>00072 <span class="comment">// Character used by UNLV as a suspect marker.</span>
<a name="l00073"></a><a class="code" href="namespacetesseract.html#af7e73b761f145b66ffcc7585ed69d940">00073</a> <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="namespacetesseract.html#af7e73b761f145b66ffcc7585ed69d940">kUNLVSuspect</a> = <span class="charliteral">&#39;^&#39;</span>;
<a name="l00074"></a>00074 <span class="comment">// Filename used for input image file, from which to derive a name to search</span>
<a name="l00075"></a>00075 <span class="comment">// for a possible UNLV zone file, if none is specified by SetInputName.</span>
<a name="l00076"></a><a class="code" href="namespacetesseract.html#a3ba7b8d4b2132f72118c62fba346ffd0">00076</a> <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="namespacetesseract.html#a3ba7b8d4b2132f72118c62fba346ffd0">kInputFile</a> = <span class="stringliteral">&quot;noname.tif&quot;</span>;
<a name="l00077"></a>00077 <span class="comment">// Temp file used for storing current parameters before applying retry values.</span>
<a name="l00078"></a><a class="code" href="namespacetesseract.html#a46ecbfaef9e549b16cd97fee9d4614d2">00078</a> <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="namespacetesseract.html#a46ecbfaef9e549b16cd97fee9d4614d2">kOldVarsFile</a> = <span class="stringliteral">&quot;failed_vars.txt&quot;</span>;
<a name="l00079"></a>00079 <span class="comment">// Max string length of an int.</span>
<a name="l00080"></a><a class="code" href="namespacetesseract.html#a3e35711780f8c0254a2dd64071ef2b6b">00080</a> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="namespacetesseract.html#a3e35711780f8c0254a2dd64071ef2b6b">kMaxIntSize</a> = 22;
<a name="l00081"></a>00081 <span class="comment">// Minimum believable resolution. Used as a default if there is no other</span>
<a name="l00082"></a>00082 <span class="comment">// information, as it is safer to under-estimate than over-estimate.</span>
<a name="l00083"></a><a class="code" href="namespacetesseract.html#af670abba9a6fc5f36a04b8650e53d1b7">00083</a> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="namespacetesseract.html#af670abba9a6fc5f36a04b8650e53d1b7" title="Minimum believable resolution.">kMinCredibleResolution</a> = 70;
<a name="l00084"></a>00084 <span class="comment">// Maximum believable resolution.</span>
<a name="l00085"></a><a class="code" href="namespacetesseract.html#a8ce8daeb42d63f39924c0a342e2cfdf4">00085</a> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="namespacetesseract.html#a8ce8daeb42d63f39924c0a342e2cfdf4">kMaxCredibleResolution</a> = 2400;
<a name="l00086"></a>00086 
<a name="l00087"></a><a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a3bc4277652df23eaeccd0629f2b1419d">00087</a> <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a3bc4277652df23eaeccd0629f2b1419d">TessBaseAPI::TessBaseAPI</a>()
<a name="l00088"></a>00088   : tesseract_(<a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>),
<a name="l00089"></a>00089     osd_tesseract_(<a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>),
<a name="l00090"></a>00090     equ_detect_(<a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>),
<a name="l00091"></a>00091     <span class="comment">// Thresholder is initialized to NULL here, but will be set before use by:</span>
<a name="l00092"></a>00092     <span class="comment">// A constructor of a derived API,  SetThresholder(), or</span>
<a name="l00093"></a>00093     <span class="comment">// created implicitly when used in InternalSetImage.</span>
<a name="l00094"></a>00094     thresholder_(<a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>),
<a name="l00095"></a>00095     paragraph_models_(<a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>),
<a name="l00096"></a>00096     block_list_(<a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>),
<a name="l00097"></a>00097     page_res_(<a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>),
<a name="l00098"></a>00098     input_file_(<a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>),
<a name="l00099"></a>00099     output_file_(<a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>),
<a name="l00100"></a>00100     datapath_(<a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>),
<a name="l00101"></a>00101     language_(<a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>),
<a name="l00102"></a>00102     last_oem_requested_(<a class="code" href="namespacetesseract.html#a04550a0ed1279562027bf2fc92c421aeae7376c1e8d55b9d13e75c639a6930159">OEM_DEFAULT</a>),
<a name="l00103"></a>00103     recognition_done_(false),
<a name="l00104"></a>00104     truth_cb_(<a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>),
<a name="l00105"></a>00105     rect_left_(0), rect_top_(0), rect_width_(0), rect_height_(0),
<a name="l00106"></a>00106     image_width_(0), image_height_(0) {
<a name="l00107"></a>00107 }
<a name="l00108"></a>00108 
<a name="l00109"></a><a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a02df6c7886962e347e3c5f7c1f632337">00109</a> <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a02df6c7886962e347e3c5f7c1f632337">TessBaseAPI::~TessBaseAPI</a>() {
<a name="l00110"></a>00110   <a class="code" href="group___advanced_a_p_i.html#ga38027513ee9c0348de1790bddcdc3391">End</a>();
<a name="l00111"></a>00111 }
<a name="l00112"></a>00112 
<a name="l00116"></a><a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a3785779c909fcdd77e24b340f5913e4b">00116</a> <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a3785779c909fcdd77e24b340f5913e4b">TessBaseAPI::Version</a>() {
<a name="l00117"></a>00117   <span class="keywordflow">return</span> <a class="code" href="config__auto_8h.html#a1c6d5de492ac61ad29aec7aa9a436bbf">VERSION</a>;
<a name="l00118"></a>00118 }
<a name="l00119"></a>00119 
<a name="l00120"></a>00120 <span class="comment">// Set the name of the input file. Needed only for training and</span>
<a name="l00121"></a>00121 <span class="comment">// loading a UNLV zone file.</span>
<a name="l00122"></a><a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a896312e68d246b58e704a8f5576e6917">00122</a> <span class="keywordtype">void</span> <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a896312e68d246b58e704a8f5576e6917">TessBaseAPI::SetInputName</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* name) {
<a name="l00123"></a>00123   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a4690919aa9d4eabda36bdefdaadf7ac9" title="Name used by training code.">input_file_</a> == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00124"></a>00124     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a4690919aa9d4eabda36bdefdaadf7ac9" title="Name used by training code.">input_file_</a> = <span class="keyword">new</span> <a class="code" href="class_s_t_r_i_n_g.html">STRING</a>(name);
<a name="l00125"></a>00125   <span class="keywordflow">else</span>
<a name="l00126"></a>00126     *<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a4690919aa9d4eabda36bdefdaadf7ac9" title="Name used by training code.">input_file_</a> = name;
<a name="l00127"></a>00127 }
<a name="l00128"></a>00128 
<a name="l00129"></a>00129 <span class="comment">// Set the name of the output files. Needed only for debugging.</span>
<a name="l00130"></a><a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#af997008815be7af2edcd9ff1a5d55896">00130</a> <span class="keywordtype">void</span> <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#af997008815be7af2edcd9ff1a5d55896">TessBaseAPI::SetOutputName</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* name) {
<a name="l00131"></a>00131   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a22a0c520bc88e2d80fb8b6a10b7caba1" title="Name used by debug code.">output_file_</a> == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00132"></a>00132     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a22a0c520bc88e2d80fb8b6a10b7caba1" title="Name used by debug code.">output_file_</a> = <span class="keyword">new</span> <a class="code" href="class_s_t_r_i_n_g.html">STRING</a>(name);
<a name="l00133"></a>00133   <span class="keywordflow">else</span>
<a name="l00134"></a>00134     *<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a22a0c520bc88e2d80fb8b6a10b7caba1" title="Name used by debug code.">output_file_</a> = name;
<a name="l00135"></a>00135 }
<a name="l00136"></a>00136 
<a name="l00137"></a><a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a2e09259c558c6d8e0f7e523cbaf5adf5">00137</a> <span class="keywordtype">bool</span> <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a2e09259c558c6d8e0f7e523cbaf5adf5">TessBaseAPI::SetVariable</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* name, <span class="keyword">const</span> <span class="keywordtype">char</span>* value) {
<a name="l00138"></a>00138   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a> == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a> = <span class="keyword">new</span> <a class="code" href="classtesseract_1_1_tesseract.html">Tesseract</a>;
<a name="l00139"></a>00139   <span class="keywordflow">return</span> <a class="code" href="classtesseract_1_1_param_utils.html#aecfd4f0112e3753b19c856d210fb8f69">ParamUtils::SetParam</a>(name, value, <a class="code" href="namespacetesseract.html#a0fc9989588ecf8f236da49b58f96a6c5a713c7bc13788ed69eb16dd9e5f309d12">SET_PARAM_CONSTRAINT_NON_INIT_ONLY</a>,
<a name="l00140"></a>00140                               <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_c_c_util.html#ac993425386ae1f73762107299ee8a114">params</a>());
<a name="l00141"></a>00141 }
<a name="l00142"></a>00142 
<a name="l00143"></a><a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a20c9b24d670ab01dd7f011727b7a8daa">00143</a> <span class="keywordtype">bool</span> <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a20c9b24d670ab01dd7f011727b7a8daa">TessBaseAPI::SetDebugVariable</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* name, <span class="keyword">const</span> <span class="keywordtype">char</span>* value) {
<a name="l00144"></a>00144   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a> == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a> = <span class="keyword">new</span> <a class="code" href="classtesseract_1_1_tesseract.html">Tesseract</a>;
<a name="l00145"></a>00145   <span class="keywordflow">return</span> <a class="code" href="classtesseract_1_1_param_utils.html#aecfd4f0112e3753b19c856d210fb8f69">ParamUtils::SetParam</a>(name, value, <a class="code" href="namespacetesseract.html#a0fc9989588ecf8f236da49b58f96a6c5ab006bbe489e53081990e1f41174bb9e0">SET_PARAM_CONSTRAINT_DEBUG_ONLY</a>,
<a name="l00146"></a>00146                               <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_c_c_util.html#ac993425386ae1f73762107299ee8a114">params</a>());
<a name="l00147"></a>00147 }
<a name="l00148"></a>00148 
<a name="l00149"></a><a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a5923cccbe20988f0f99072844d1af573">00149</a> <span class="keywordtype">bool</span> <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a5923cccbe20988f0f99072844d1af573">TessBaseAPI::GetIntVariable</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keywordtype">int</span> *value)<span class="keyword"> const </span>{
<a name="l00150"></a>00150   <a class="code" href="classtesseract_1_1_int_param.html">IntParam</a> *p = ParamUtils::FindParam&lt;IntParam&gt;(
<a name="l00151"></a>00151       name, <a class="code" href="params_8cpp.html#a71a3243019391d3a438fd279c07cef87">GlobalParams</a>()-&gt;<a class="code" href="structtesseract_1_1_params_vectors.html#a22c42b48d2c626d2f3f3b0abd21bc902">int_params</a>, <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_c_c_util.html#ac993425386ae1f73762107299ee8a114">params</a>()-&gt;<a class="code" href="structtesseract_1_1_params_vectors.html#a22c42b48d2c626d2f3f3b0abd21bc902">int_params</a>);
<a name="l00152"></a>00152   <span class="keywordflow">if</span> (p == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00153"></a>00153   *value = (<a class="code" href="host_8h.html#aba1f582fd0168f3ff9225d8c90fa9eb8">inT32</a>)(*p);
<a name="l00154"></a>00154   <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00155"></a>00155 }
<a name="l00156"></a>00156 
<a name="l00157"></a><a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ac5e219cbaa2c19c67ccef3246ff838a6">00157</a> <span class="keywordtype">bool</span> <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ac5e219cbaa2c19c67ccef3246ff838a6">TessBaseAPI::GetBoolVariable</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keywordtype">bool</span> *value)<span class="keyword"> const </span>{
<a name="l00158"></a>00158   <a class="code" href="classtesseract_1_1_bool_param.html">BoolParam</a> *p = ParamUtils::FindParam&lt;BoolParam&gt;(
<a name="l00159"></a>00159       name, <a class="code" href="params_8cpp.html#a71a3243019391d3a438fd279c07cef87">GlobalParams</a>()-&gt;<a class="code" href="structtesseract_1_1_params_vectors.html#a6bb13133287d8d8d18c81bb974b1b54f">bool_params</a>, <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_c_c_util.html#ac993425386ae1f73762107299ee8a114">params</a>()-&gt;<a class="code" href="structtesseract_1_1_params_vectors.html#a6bb13133287d8d8d18c81bb974b1b54f">bool_params</a>);
<a name="l00160"></a>00160   <span class="keywordflow">if</span> (p == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00161"></a>00161   *value = (<a class="code" href="host_8h.html#a7712a7e28433d0ade59219a129549b6f">BOOL8</a>)(*p);
<a name="l00162"></a>00162   <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00163"></a>00163 }
<a name="l00164"></a>00164 
<a name="l00165"></a><a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a03dfbc60eeb4cef2937703c9df60003b">00165</a> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a03dfbc60eeb4cef2937703c9df60003b">TessBaseAPI::GetStringVariable</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name)<span class="keyword"> const </span>{
<a name="l00166"></a>00166   <a class="code" href="classtesseract_1_1_string_param.html">StringParam</a> *p = ParamUtils::FindParam&lt;StringParam&gt;(
<a name="l00167"></a>00167       name, <a class="code" href="params_8cpp.html#a71a3243019391d3a438fd279c07cef87">GlobalParams</a>()-&gt;<a class="code" href="structtesseract_1_1_params_vectors.html#a446a70d7d7c85af255d053ae54c5df8a">string_params</a>, <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_c_c_util.html#ac993425386ae1f73762107299ee8a114">params</a>()-&gt;<a class="code" href="structtesseract_1_1_params_vectors.html#a446a70d7d7c85af255d053ae54c5df8a">string_params</a>);
<a name="l00168"></a>00168   <span class="keywordflow">return</span> (p != <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) ? p-&gt;<a class="code" href="classtesseract_1_1_string_param.html#a722ffc30ba31e0993847178593eca10b">string</a>() : <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00169"></a>00169 }
<a name="l00170"></a>00170 
<a name="l00171"></a><a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a66a87a36eaee72d6ce12409f99f28eb8">00171</a> <span class="keywordtype">bool</span> <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a66a87a36eaee72d6ce12409f99f28eb8">TessBaseAPI::GetDoubleVariable</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keywordtype">double</span> *value)<span class="keyword"> const </span>{
<a name="l00172"></a>00172   <a class="code" href="classtesseract_1_1_double_param.html">DoubleParam</a> *p = ParamUtils::FindParam&lt;DoubleParam&gt;(
<a name="l00173"></a>00173       name, <a class="code" href="params_8cpp.html#a71a3243019391d3a438fd279c07cef87">GlobalParams</a>()-&gt;<a class="code" href="structtesseract_1_1_params_vectors.html#a83a1b9a0571c97380bdf3a32591cf196">double_params</a>, <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_c_c_util.html#ac993425386ae1f73762107299ee8a114">params</a>()-&gt;<a class="code" href="structtesseract_1_1_params_vectors.html#a83a1b9a0571c97380bdf3a32591cf196">double_params</a>);
<a name="l00174"></a>00174   <span class="keywordflow">if</span> (p == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00175"></a>00175   *value = (double)(*p);
<a name="l00176"></a>00176   <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00177"></a>00177 }
<a name="l00178"></a>00178 
<a name="l00179"></a>00179 <span class="comment">// Get value of named variable as a string, if it exists.</span>
<a name="l00180"></a><a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#aa40487f19e71221f05bb3ad5dd36c437">00180</a> <span class="keywordtype">bool</span> <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#aa40487f19e71221f05bb3ad5dd36c437">TessBaseAPI::GetVariableAsString</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name, <a class="code" href="class_s_t_r_i_n_g.html">STRING</a> *val) {
<a name="l00181"></a>00181   <span class="keywordflow">return</span> <a class="code" href="classtesseract_1_1_param_utils.html#a53d101144fd6a9e6d45980e832f9e054">ParamUtils::GetParamAsString</a>(name, <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_c_c_util.html#ac993425386ae1f73762107299ee8a114">params</a>(), val);
<a name="l00182"></a>00182 }
<a name="l00183"></a>00183 
<a name="l00184"></a>00184 <span class="comment">// Print Tesseract parameters to the given file.</span>
<a name="l00185"></a><a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#aa00be783b6ce3c3178fc86afdf1cba7d">00185</a> <span class="keywordtype">void</span> <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#aa00be783b6ce3c3178fc86afdf1cba7d">TessBaseAPI::PrintVariables</a>(FILE *fp)<span class="keyword"> const </span>{
<a name="l00186"></a>00186   <a class="code" href="classtesseract_1_1_param_utils.html#ac9884aced9c9941e8df8763960d798c4">ParamUtils::PrintParams</a>(fp, <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_c_c_util.html#ac993425386ae1f73762107299ee8a114">params</a>());
<a name="l00187"></a>00187 }
<a name="l00188"></a>00188 
<a name="l00189"></a>00189 <span class="comment">// The datapath must be the name of the data directory (no ending /) or</span>
<a name="l00190"></a>00190 <span class="comment">// some other file in which the data directory resides (for instance argv[0].)</span>
<a name="l00191"></a>00191 <span class="comment">// The language is (usually) an ISO 639-3 string or NULL will default to eng.</span>
<a name="l00192"></a>00192 <span class="comment">// If numeric_mode is true, then only digits and Roman numerals will</span>
<a name="l00193"></a>00193 <span class="comment">// be returned.</span>
<a name="l00194"></a>00194 <span class="comment">// Returns 0 on success and -1 on initialization failure.</span>
<a name="l00195"></a><a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a96899e8e5358d96752ab1cfc3bc09f3e">00195</a> <span class="keywordtype">int</span> <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a96899e8e5358d96752ab1cfc3bc09f3e">TessBaseAPI::Init</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* datapath, <span class="keyword">const</span> <span class="keywordtype">char</span>* language,
<a name="l00196"></a>00196                       <a class="code" href="namespacetesseract.html#a04550a0ed1279562027bf2fc92c421ae">OcrEngineMode</a> oem, <span class="keywordtype">char</span> **configs, <span class="keywordtype">int</span> configs_size,
<a name="l00197"></a>00197                       <span class="keyword">const</span> <a class="code" href="class_generic_vector.html">GenericVector&lt;STRING&gt;</a> *vars_vec,
<a name="l00198"></a>00198                       <span class="keyword">const</span> <a class="code" href="class_generic_vector.html">GenericVector&lt;STRING&gt;</a> *vars_values,
<a name="l00199"></a>00199                       <span class="keywordtype">bool</span> set_only_non_debug_params) {
<a name="l00200"></a>00200   <span class="comment">// Default language is &quot;eng&quot;.</span>
<a name="l00201"></a>00201   <span class="keywordflow">if</span> (language == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) language = <span class="stringliteral">&quot;eng&quot;</span>;
<a name="l00202"></a>00202   <span class="comment">// If the datapath, OcrEngineMode or the language have changed - start again.</span>
<a name="l00203"></a>00203   <span class="comment">// Note that the language_ field stores the last requested language that was</span>
<a name="l00204"></a>00204   <span class="comment">// initialized successfully, while tesseract_-&gt;lang stores the language</span>
<a name="l00205"></a>00205   <span class="comment">// actually used. They differ only if the requested language was NULL, in</span>
<a name="l00206"></a>00206   <span class="comment">// which case tesseract_-&gt;lang is set to the Tesseract default (&quot;eng&quot;).</span>
<a name="l00207"></a>00207   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a> != <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp;
<a name="l00208"></a>00208       (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ad7c3d4ead7b9c8e27e45e710e5407913" title="Current location of tessdata.">datapath_</a> == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a74a291190aa0bbf90b57f678b1fb0a5c" title="Last initialized language.">language_</a> == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> ||
<a name="l00209"></a>00209        *<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ad7c3d4ead7b9c8e27e45e710e5407913" title="Current location of tessdata.">datapath_</a> != datapath || <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#af9d4095a569fbf8687cefc005d2f58ee" title="Last ocr language mode requested.">last_oem_requested_</a> != oem ||
<a name="l00210"></a>00210        (*<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a74a291190aa0bbf90b57f678b1fb0a5c" title="Last initialized language.">language_</a> != language &amp;&amp; <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_c_c_util.html#ae453cbd7e4899ebfc5cc3831e5a8dd66">lang</a> != language))) {
<a name="l00211"></a>00211     <span class="keyword">delete</span> <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>;
<a name="l00212"></a>00212     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a> = <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00213"></a>00213   }
<a name="l00214"></a>00214 
<a name="l00215"></a>00215   <span class="keywordtype">bool</span> reset_classifier = <span class="keyword">true</span>;
<a name="l00216"></a>00216   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a> == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l00217"></a>00217     reset_classifier = <span class="keyword">false</span>;
<a name="l00218"></a>00218     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a> = <span class="keyword">new</span> <a class="code" href="classtesseract_1_1_tesseract.html">Tesseract</a>;
<a name="l00219"></a>00219     <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#ae4558a3c1f64abeec1e1829056d8d1f3">init_tesseract</a>(
<a name="l00220"></a>00220             datapath, <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a22a0c520bc88e2d80fb8b6a10b7caba1" title="Name used by debug code.">output_file_</a> != <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> ? <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a22a0c520bc88e2d80fb8b6a10b7caba1" title="Name used by debug code.">output_file_</a>-&gt;<a class="code" href="class_s_t_r_i_n_g.html#a32beee43ecab1bed8bebc3466896ad6e">string</a>() : <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,
<a name="l00221"></a>00221             language, <a class="code" href="group___advanced_a_p_i.html#gaf810a9dc1e6d74132796c298445ea06d">oem</a>, configs, configs_size, vars_vec, vars_values,
<a name="l00222"></a>00222             set_only_non_debug_params) != 0) {
<a name="l00223"></a>00223       <span class="keywordflow">return</span> -1;
<a name="l00224"></a>00224     }
<a name="l00225"></a>00225   }
<a name="l00226"></a>00226   <span class="comment">// Update datapath and language requested for the last valid initialization.</span>
<a name="l00227"></a>00227   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ad7c3d4ead7b9c8e27e45e710e5407913" title="Current location of tessdata.">datapath_</a> == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00228"></a>00228     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ad7c3d4ead7b9c8e27e45e710e5407913" title="Current location of tessdata.">datapath_</a> = <span class="keyword">new</span> <a class="code" href="class_s_t_r_i_n_g.html">STRING</a>(datapath);
<a name="l00229"></a>00229   <span class="keywordflow">else</span>
<a name="l00230"></a>00230     *<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ad7c3d4ead7b9c8e27e45e710e5407913" title="Current location of tessdata.">datapath_</a> = datapath;
<a name="l00231"></a>00231   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a74a291190aa0bbf90b57f678b1fb0a5c" title="Last initialized language.">language_</a> == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00232"></a>00232     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a74a291190aa0bbf90b57f678b1fb0a5c" title="Last initialized language.">language_</a> = <span class="keyword">new</span> <a class="code" href="class_s_t_r_i_n_g.html">STRING</a>(language);
<a name="l00233"></a>00233   <span class="keywordflow">else</span>
<a name="l00234"></a>00234     *<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a74a291190aa0bbf90b57f678b1fb0a5c" title="Last initialized language.">language_</a> = language;
<a name="l00235"></a>00235   <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#af9d4095a569fbf8687cefc005d2f58ee" title="Last ocr language mode requested.">last_oem_requested_</a> = <a class="code" href="group___advanced_a_p_i.html#gaf810a9dc1e6d74132796c298445ea06d">oem</a>;
<a name="l00236"></a>00236 
<a name="l00237"></a>00237   <span class="comment">// For same language and datapath, just reset the adaptive classifier.</span>
<a name="l00238"></a>00238   <span class="keywordflow">if</span> (reset_classifier) <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#aa1c9c8ed630b708cf88c97b863c0f1f8">ResetAdaptiveClassifier</a>();
<a name="l00239"></a>00239 
<a name="l00240"></a>00240   <span class="keywordflow">return</span> 0;
<a name="l00241"></a>00241 }
<a name="l00242"></a>00242 
<a name="l00243"></a>00243 <span class="comment">// Returns the languages string used in the last valid initialization.</span>
<a name="l00244"></a>00244 <span class="comment">// If the last initialization specified &quot;deu+hin&quot; then that will be</span>
<a name="l00245"></a>00245 <span class="comment">// returned. If hin loaded eng automatically as well, then that will</span>
<a name="l00246"></a>00246 <span class="comment">// not be included in this list. To find the languages actually</span>
<a name="l00247"></a>00247 <span class="comment">// loaded use GetLoadedLanguagesAsVector.</span>
<a name="l00248"></a>00248 <span class="comment">// The returned string should NOT be deleted.</span>
<a name="l00249"></a><a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#af4eab4c95ee65eff4f36de0b4d27d07a">00249</a> <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#af4eab4c95ee65eff4f36de0b4d27d07a">TessBaseAPI::GetInitLanguagesAsString</a>()<span class="keyword"> const </span>{
<a name="l00250"></a>00250   <span class="keywordflow">return</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a74a291190aa0bbf90b57f678b1fb0a5c" title="Last initialized language.">language_</a> == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a74a291190aa0bbf90b57f678b1fb0a5c" title="Last initialized language.">language_</a>-&gt;<a class="code" href="class_s_t_r_i_n_g.html#a32beee43ecab1bed8bebc3466896ad6e">string</a>() == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) ?
<a name="l00251"></a>00251       <span class="stringliteral">&quot;&quot;</span> : <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a74a291190aa0bbf90b57f678b1fb0a5c" title="Last initialized language.">language_</a>-&gt;<a class="code" href="class_s_t_r_i_n_g.html#a32beee43ecab1bed8bebc3466896ad6e">string</a>();
<a name="l00252"></a>00252 }
<a name="l00253"></a>00253 
<a name="l00254"></a>00254 <span class="comment">// Returns the loaded languages in the vector of STRINGs.</span>
<a name="l00255"></a>00255 <span class="comment">// Includes all languages loaded by the last Init, including those loaded</span>
<a name="l00256"></a>00256 <span class="comment">// as dependencies of other loaded languages.</span>
<a name="l00257"></a><a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a16a8fb0d6583e1990d79757dc32c760c">00257</a> <span class="keywordtype">void</span> <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a16a8fb0d6583e1990d79757dc32c760c">TessBaseAPI::GetLoadedLanguagesAsVector</a>(
<a name="l00258"></a>00258     <a class="code" href="class_generic_vector.html">GenericVector&lt;STRING&gt;</a>* langs)<span class="keyword"> const </span>{
<a name="l00259"></a>00259   langs-&gt;<a class="code" href="class_generic_vector.html#a9cdbff49b186574b83e43afba606fdd9">clear</a>();
<a name="l00260"></a>00260   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a> != <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l00261"></a>00261     langs-&gt;<a class="code" href="class_generic_vector.html#a0dc89fe2a365b04a61017f9d78c1a303">push_back</a>(<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_c_c_util.html#ae453cbd7e4899ebfc5cc3831e5a8dd66">lang</a>);
<a name="l00262"></a>00262     <span class="keywordtype">int</span> num_subs = <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#acdb611d653926772113b91423edbd004">num_sub_langs</a>();
<a name="l00263"></a>00263     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; num_subs; ++i)
<a name="l00264"></a>00264       langs-&gt;<a class="code" href="class_generic_vector.html#a0dc89fe2a365b04a61017f9d78c1a303">push_back</a>(<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#afe9d7c06d9190dc4b686cb7342a01b52">get_sub_lang</a>(i)-&gt;<a class="code" href="classtesseract_1_1_c_c_util.html#ae453cbd7e4899ebfc5cc3831e5a8dd66">lang</a>);
<a name="l00265"></a>00265   }
<a name="l00266"></a>00266 }
<a name="l00267"></a>00267 
<a name="l00268"></a>00268 <span class="comment">// Init only the lang model component of Tesseract. The only functions</span>
<a name="l00269"></a>00269 <span class="comment">// that work after this init are SetVariable and IsValidWord.</span>
<a name="l00270"></a>00270 <span class="comment">// WARNING: temporary! This function will be removed from here and placed</span>
<a name="l00271"></a>00271 <span class="comment">// in a separate API at some future time.</span>
<a name="l00272"></a><a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ac5fdc031598e1237ec7e30c5efa95840">00272</a> <span class="keywordtype">int</span> <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ac5fdc031598e1237ec7e30c5efa95840">TessBaseAPI::InitLangMod</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* datapath, <span class="keyword">const</span> <span class="keywordtype">char</span>* language) {
<a name="l00273"></a>00273   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a> == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00274"></a>00274     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a> = <span class="keyword">new</span> <a class="code" href="classtesseract_1_1_tesseract.html">Tesseract</a>;
<a name="l00275"></a>00275   <span class="keywordflow">return</span> <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#af024065359dd49d91ed8d602f57e0fc2">init_tesseract_lm</a>(datapath, <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, language);
<a name="l00276"></a>00276 }
<a name="l00277"></a>00277 
<a name="l00278"></a>00278 <span class="comment">// Init only for page layout analysis. Use only for calls to SetImage and</span>
<a name="l00279"></a>00279 <span class="comment">// AnalysePage. Calls that attempt recognition will generate an error.</span>
<a name="l00280"></a><a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a23d63e2cac00b958eb8803cab4943b4c">00280</a> <span class="keywordtype">void</span> <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a23d63e2cac00b958eb8803cab4943b4c">TessBaseAPI::InitForAnalysePage</a>() {
<a name="l00281"></a>00281   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a> == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l00282"></a>00282     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a> = <span class="keyword">new</span> <a class="code" href="classtesseract_1_1_tesseract.html">Tesseract</a>;
<a name="l00283"></a>00283     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_classify.html#a2f9389a2d855d2a59e7892d3ba884887">InitAdaptiveClassifier</a>(<span class="keyword">false</span>);
<a name="l00284"></a>00284   }
<a name="l00285"></a>00285 }
<a name="l00286"></a>00286 
<a name="l00287"></a>00287 <span class="comment">// Read a &quot;config&quot; file containing a set of parameter name, value pairs.</span>
<a name="l00288"></a>00288 <span class="comment">// Searches the standard places: tessdata/configs, tessdata/tessconfigs</span>
<a name="l00289"></a>00289 <span class="comment">// and also accepts a relative or absolute path name.</span>
<a name="l00290"></a><a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ab3bd61f8ccb7c4e1c41801ea708d2181">00290</a> <span class="keywordtype">void</span> <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ab3bd61f8ccb7c4e1c41801ea708d2181">TessBaseAPI::ReadConfigFile</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* filename) {
<a name="l00291"></a>00291   <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#a4784885f7626438d0f5438c60fdac672">read_config_file</a>(filename, <a class="code" href="namespacetesseract.html#a0fc9989588ecf8f236da49b58f96a6c5a713c7bc13788ed69eb16dd9e5f309d12">SET_PARAM_CONSTRAINT_NON_INIT_ONLY</a>);
<a name="l00292"></a>00292 }
<a name="l00293"></a>00293 <span class="comment">// Same as above, but only set debug params from the given config file.</span>
<a name="l00294"></a><a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a4f3eec49763f76c347c216eed79cae93">00294</a> <span class="keywordtype">void</span> <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a4f3eec49763f76c347c216eed79cae93">TessBaseAPI::ReadDebugConfigFile</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* filename) {
<a name="l00295"></a>00295   <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#a4784885f7626438d0f5438c60fdac672">read_config_file</a>(filename, <a class="code" href="namespacetesseract.html#a0fc9989588ecf8f236da49b58f96a6c5ab006bbe489e53081990e1f41174bb9e0">SET_PARAM_CONSTRAINT_DEBUG_ONLY</a>);
<a name="l00296"></a>00296 }
<a name="l00297"></a>00297 
<a name="l00298"></a>00298 <span class="comment">// Set the current page segmentation mode. Defaults to PSM_AUTO.</span>
<a name="l00299"></a>00299 <span class="comment">// The mode is stored as an IntParam so it can also be modified by</span>
<a name="l00300"></a>00300 <span class="comment">// ReadConfigFile or SetVariable(&quot;tessedit_pageseg_mode&quot;, mode as string).</span>
<a name="l00301"></a><a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a15a7a9c1afbba3078a55b4566de891ab">00301</a> <span class="keywordtype">void</span> <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a15a7a9c1afbba3078a55b4566de891ab">TessBaseAPI::SetPageSegMode</a>(<a class="code" href="namespacetesseract.html#a338d4c8b5d497b5ec3e6e4269d8ac66a">PageSegMode</a> <a class="code" href="pgedit_8cpp.html#afc03cf3e39248c2e339fee4d31f5f750">mode</a>) {
<a name="l00302"></a>00302   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a> == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00303"></a>00303     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a> = <span class="keyword">new</span> <a class="code" href="classtesseract_1_1_tesseract.html">Tesseract</a>;
<a name="l00304"></a>00304   <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#a053d30f2b3df317e0d12e4a64f10d831">tessedit_pageseg_mode</a>.set_value(mode);
<a name="l00305"></a>00305 }
<a name="l00306"></a>00306 
<a name="l00307"></a>00307 <span class="comment">// Return the current page segmentation mode.</span>
<a name="l00308"></a><a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a943206e3548bfb517c67354ee50661f3">00308</a> <a class="code" href="namespacetesseract.html#a338d4c8b5d497b5ec3e6e4269d8ac66a">PageSegMode</a> <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a943206e3548bfb517c67354ee50661f3">TessBaseAPI::GetPageSegMode</a>()<span class="keyword"> const </span>{
<a name="l00309"></a>00309   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a> == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00310"></a>00310     <span class="keywordflow">return</span> <a class="code" href="namespacetesseract.html#a338d4c8b5d497b5ec3e6e4269d8ac66aab76fe3ca390d99e070ea60b892ee18ef" title="Assume a single uniform block of text. (Default.)">PSM_SINGLE_BLOCK</a>;
<a name="l00311"></a>00311   <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><a class="code" href="namespacetesseract.html#a338d4c8b5d497b5ec3e6e4269d8ac66a">PageSegMode</a><span class="keyword">&gt;</span>(
<a name="l00312"></a>00312     <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#a053d30f2b3df317e0d12e4a64f10d831">tessedit_pageseg_mode</a>));
<a name="l00313"></a>00313 }
<a name="l00314"></a>00314 
<a name="l00315"></a>00315 <span class="comment">// Recognize a rectangle from an image and return the result as a string.</span>
<a name="l00316"></a>00316 <span class="comment">// May be called many times for a single Init.</span>
<a name="l00317"></a>00317 <span class="comment">// Currently has no error checking.</span>
<a name="l00318"></a>00318 <span class="comment">// Greyscale of 8 and color of 24 or 32 bits per pixel may be given.</span>
<a name="l00319"></a>00319 <span class="comment">// Palette color images will not work properly and must be converted to</span>
<a name="l00320"></a>00320 <span class="comment">// 24 bit.</span>
<a name="l00321"></a>00321 <span class="comment">// Binary images of 1 bit per pixel may also be given but they must be</span>
<a name="l00322"></a>00322 <span class="comment">// byte packed with the MSB of the first byte being the first pixel, and a</span>
<a name="l00323"></a>00323 <span class="comment">// one pixel is WHITE. For binary images set bytes_per_pixel=0.</span>
<a name="l00324"></a>00324 <span class="comment">// The recognized text is returned as a char* which is coded</span>
<a name="l00325"></a>00325 <span class="comment">// as UTF8 and must be freed with the delete [] operator.</span>
<a name="l00326"></a><a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ad34c56e08d999ece9972f4c9a9301f93">00326</a> <span class="keywordtype">char</span>* <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ad34c56e08d999ece9972f4c9a9301f93">TessBaseAPI::TesseractRect</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* imagedata,
<a name="l00327"></a>00327                                  <span class="keywordtype">int</span> bytes_per_pixel,
<a name="l00328"></a>00328                                  <span class="keywordtype">int</span> bytes_per_line,
<a name="l00329"></a>00329                                  <span class="keywordtype">int</span> left, <span class="keywordtype">int</span> top,
<a name="l00330"></a>00330                                  <span class="keywordtype">int</span> width, <span class="keywordtype">int</span> height) {
<a name="l00331"></a>00331   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a> == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || width &lt; <a class="code" href="namespacetesseract.html#a11307fd919d7a9313500b04cfc1a8e3d">kMinRectSize</a> || height &lt; <a class="code" href="namespacetesseract.html#a11307fd919d7a9313500b04cfc1a8e3d">kMinRectSize</a>)
<a name="l00332"></a>00332     <span class="keywordflow">return</span> <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;  <span class="comment">// Nothing worth doing.</span>
<a name="l00333"></a>00333 
<a name="l00334"></a>00334   <span class="comment">// Since this original api didn&#39;t give the exact size of the image,</span>
<a name="l00335"></a>00335   <span class="comment">// we have to invent a reasonable value.</span>
<a name="l00336"></a>00336   <span class="keywordtype">int</span> bits_per_pixel = bytes_per_pixel == 0 ? 1 : bytes_per_pixel * 8;
<a name="l00337"></a>00337   <a class="code" href="group___advanced_a_p_i.html#gaa463622111f3b11d8fca5863709cc699">SetImage</a>(imagedata, bytes_per_line * 8 / bits_per_pixel, height + top,
<a name="l00338"></a>00338            bytes_per_pixel, bytes_per_line);
<a name="l00339"></a>00339   <a class="code" href="group___advanced_a_p_i.html#ga284228c7e9d18bbbd3984d44e252d625">SetRectangle</a>(left, top, width, height);
<a name="l00340"></a>00340 
<a name="l00341"></a>00341   <span class="keywordflow">return</span> <a class="code" href="group___advanced_a_p_i.html#ga115ef656f83352ba608b4f0bf9cfa2c4">GetUTF8Text</a>();
<a name="l00342"></a>00342 }
<a name="l00343"></a>00343 
<a name="l00344"></a>00344 <span class="comment">// Call between pages or documents etc to free up memory and forget</span>
<a name="l00345"></a>00345 <span class="comment">// adaptive data.</span>
<a name="l00346"></a><a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ae16cc5135aba401b609e49d6790281e3">00346</a> <span class="keywordtype">void</span> <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ae16cc5135aba401b609e49d6790281e3">TessBaseAPI::ClearAdaptiveClassifier</a>() {
<a name="l00347"></a>00347   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a> == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00348"></a>00348     <span class="keywordflow">return</span>;
<a name="l00349"></a>00349   <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#aa1c9c8ed630b708cf88c97b863c0f1f8">ResetAdaptiveClassifier</a>();
<a name="l00350"></a>00350   <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#acf30e84d821dad180e2e3c752bf5af28">ResetDocumentDictionary</a>();
<a name="l00351"></a>00351 }
<a name="l00352"></a>00352 
<a name="l00353"></a>00353 <span class="comment">// Provide an image for Tesseract to recognize. Format is as</span>
<a name="l00354"></a>00354 <span class="comment">// TesseractRect above. Does not copy the image buffer, or take</span>
<a name="l00355"></a>00355 <span class="comment">// ownership. The source image may be destroyed after Recognize is called,</span>
<a name="l00356"></a>00356 <span class="comment">// either explicitly or implicitly via one of the Get*Text functions.</span>
<a name="l00357"></a>00357 <span class="comment">// SetImage clears all recognition results, and sets the rectangle to the</span>
<a name="l00358"></a>00358 <span class="comment">// full image, so it may be followed immediately by a GetUTF8Text, and it</span>
<a name="l00359"></a>00359 <span class="comment">// will automatically perform recognition.</span>
<a name="l00360"></a><a class="code" href="group___advanced_a_p_i.html#gaa463622111f3b11d8fca5863709cc699">00360</a> <span class="keywordtype">void</span> <a class="code" href="group___advanced_a_p_i.html#gaa463622111f3b11d8fca5863709cc699">TessBaseAPI::SetImage</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* imagedata,
<a name="l00361"></a>00361                            <span class="keywordtype">int</span> width, <span class="keywordtype">int</span> height,
<a name="l00362"></a>00362                            <span class="keywordtype">int</span> bytes_per_pixel, <span class="keywordtype">int</span> bytes_per_line) {
<a name="l00363"></a>00363   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a17820a43c31b66c3a12eda59e0b51bba">InternalSetImage</a>())
<a name="l00364"></a>00364     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a9d93e1d92ca230ae02b81d44bc88a55c" title="Image thresholding module.">thresholder_</a>-&gt;<a class="code" href="classtesseract_1_1_image_thresholder.html#a6273ef2894757191288f857702fdd044">SetImage</a>(imagedata, width, height,
<a name="l00365"></a>00365                            bytes_per_pixel, bytes_per_line);
<a name="l00366"></a>00366 }
<a name="l00367"></a>00367 
<a name="l00368"></a><a class="code" href="group___advanced_a_p_i.html#ga4ded6137507a4e8eb6ed4bea0b9648f4">00368</a> <span class="keywordtype">void</span> <a class="code" href="group___advanced_a_p_i.html#ga4ded6137507a4e8eb6ed4bea0b9648f4">TessBaseAPI::SetSourceResolution</a>(<span class="keywordtype">int</span> ppi) {
<a name="l00369"></a>00369   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a9d93e1d92ca230ae02b81d44bc88a55c" title="Image thresholding module.">thresholder_</a>)
<a name="l00370"></a>00370     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a9d93e1d92ca230ae02b81d44bc88a55c" title="Image thresholding module.">thresholder_</a>-&gt;<a class="code" href="classtesseract_1_1_image_thresholder.html#af96fa2b6f4d1271640d5c8842f4fa9d6">SetSourceYResolution</a>(ppi);
<a name="l00371"></a>00371   <span class="keywordflow">else</span>
<a name="l00372"></a>00372     <a class="code" href="tprintf_8cpp.html#a0c2bcd4462ec67ab0971b34a0f610f55">tprintf</a>(<span class="stringliteral">&quot;Please call SetImage before SetSourceResolution.\n&quot;</span>);
<a name="l00373"></a>00373 }
<a name="l00374"></a>00374 
<a name="l00375"></a>00375 <span class="comment">// Provide an image for Tesseract to recognize. As with SetImage above,</span>
<a name="l00376"></a>00376 <span class="comment">// Tesseract doesn&#39;t take a copy or ownership or pixDestroy the image, so</span>
<a name="l00377"></a>00377 <span class="comment">// it must persist until after Recognize.</span>
<a name="l00378"></a>00378 <span class="comment">// Pix vs raw, which to use?</span>
<a name="l00379"></a>00379 <span class="comment">// Use Pix where possible. A future version of Tesseract may choose to use Pix</span>
<a name="l00380"></a>00380 <span class="comment">// as its internal representation and discard IMAGE altogether.</span>
<a name="l00381"></a>00381 <span class="comment">// Because of that, an implementation that sources and targets Pix may end up</span>
<a name="l00382"></a>00382 <span class="comment">// with less copies than an implementation that does not.</span>
<a name="l00383"></a><a class="code" href="group___advanced_a_p_i.html#ga89aa20dee8b772168b2d18150984bd2f">00383</a> <span class="keywordtype">void</span> <a class="code" href="group___advanced_a_p_i.html#gaa463622111f3b11d8fca5863709cc699">TessBaseAPI::SetImage</a>(<span class="keyword">const</span> Pix* pix) {
<a name="l00384"></a>00384   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a17820a43c31b66c3a12eda59e0b51bba">InternalSetImage</a>())
<a name="l00385"></a>00385     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a9d93e1d92ca230ae02b81d44bc88a55c" title="Image thresholding module.">thresholder_</a>-&gt;<a class="code" href="classtesseract_1_1_image_thresholder.html#a6273ef2894757191288f857702fdd044">SetImage</a>(pix);
<a name="l00386"></a>00386 }
<a name="l00387"></a>00387 
<a name="l00388"></a>00388 <span class="comment">// Restrict recognition to a sub-rectangle of the image. Call after SetImage.</span>
<a name="l00389"></a>00389 <span class="comment">// Each SetRectangle clears the recogntion results so multiple rectangles</span>
<a name="l00390"></a>00390 <span class="comment">// can be recognized with the same image.</span>
<a name="l00391"></a><a class="code" href="group___advanced_a_p_i.html#ga284228c7e9d18bbbd3984d44e252d625">00391</a> <span class="keywordtype">void</span> <a class="code" href="group___advanced_a_p_i.html#ga284228c7e9d18bbbd3984d44e252d625">TessBaseAPI::SetRectangle</a>(<span class="keywordtype">int</span> left, <span class="keywordtype">int</span> top, <span class="keywordtype">int</span> width, <span class="keywordtype">int</span> height) {
<a name="l00392"></a>00392   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a9d93e1d92ca230ae02b81d44bc88a55c" title="Image thresholding module.">thresholder_</a> == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00393"></a>00393     <span class="keywordflow">return</span>;
<a name="l00394"></a>00394   <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a9d93e1d92ca230ae02b81d44bc88a55c" title="Image thresholding module.">thresholder_</a>-&gt;<a class="code" href="classtesseract_1_1_image_thresholder.html#ab230142a51f5ed6347f1a9221e52d264">SetRectangle</a>(left, top, width, height);
<a name="l00395"></a>00395   <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a83ca325b5e521416b1edcd020b169be0">ClearResults</a>();
<a name="l00396"></a>00396 }
<a name="l00397"></a>00397 
<a name="l00398"></a>00398 <span class="comment">// ONLY available if you have Leptonica installed.</span>
<a name="l00399"></a>00399 <span class="comment">// Get a copy of the internal thresholded image from Tesseract.</span>
<a name="l00400"></a><a class="code" href="group___advanced_a_p_i.html#gaee19c9ea78a647420bbe99a447569995">00400</a> Pix* <a class="code" href="group___advanced_a_p_i.html#gaee19c9ea78a647420bbe99a447569995">TessBaseAPI::GetThresholdedImage</a>() {
<a name="l00401"></a>00401   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a> == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00402"></a>00402     <span class="keywordflow">return</span> <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00403"></a>00403   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#a97fde2a457aa76137737b247a2418cb7">pix_binary</a>() == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00404"></a>00404     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a8c8a3b050d6c356c4846345a3818f79e">Threshold</a>(<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#a512809e371c7bff1a24bb531721010a3">mutable_pix_binary</a>());
<a name="l00405"></a>00405   <span class="keywordflow">return</span> pixClone(<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#a97fde2a457aa76137737b247a2418cb7">pix_binary</a>());
<a name="l00406"></a>00406 }
<a name="l00407"></a>00407 
<a name="l00408"></a>00408 <span class="comment">// Get the result of page layout analysis as a leptonica-style</span>
<a name="l00409"></a>00409 <span class="comment">// Boxa, Pixa pair, in reading order.</span>
<a name="l00410"></a>00410 <span class="comment">// Can be called before or after Recognize.</span>
<a name="l00411"></a><a class="code" href="group___advanced_a_p_i.html#gafdd23f73100c54cff18ecfa14efa0379">00411</a> Boxa* <a class="code" href="group___advanced_a_p_i.html#gafdd23f73100c54cff18ecfa14efa0379">TessBaseAPI::GetRegions</a>(Pixa** pixa) {
<a name="l00412"></a>00412   <span class="keywordflow">return</span> <a class="code" href="group___advanced_a_p_i.html#ga56369b1654400ef97e581bb65749ec3d">GetComponentImages</a>(<a class="code" href="namespacetesseract.html#aa26c22b65cc9765a0e747120f4287fd7a2dcea8d4208c16055353029d26f9bf49">RIL_BLOCK</a>, <span class="keyword">false</span>, pixa, <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00413"></a>00413 }
<a name="l00414"></a>00414 
<a name="l00415"></a>00415 <span class="comment">// Get the textlines as a leptonica-style Boxa, Pixa pair, in reading order.</span>
<a name="l00416"></a>00416 <span class="comment">// Can be called before or after Recognize.</span>
<a name="l00417"></a>00417 <span class="comment">// If blockids is not NULL, the block-id of each line is also returned as an</span>
<a name="l00418"></a>00418 <span class="comment">// array of one element per line. delete [] after use.</span>
<a name="l00419"></a><a class="code" href="group___advanced_a_p_i.html#ga337bd007c5fff9336bba8dfade1924ce">00419</a> Boxa* <a class="code" href="group___advanced_a_p_i.html#ga337bd007c5fff9336bba8dfade1924ce">TessBaseAPI::GetTextlines</a>(Pixa** pixa, <span class="keywordtype">int</span>** blockids) {
<a name="l00420"></a>00420   <span class="keywordflow">return</span> <a class="code" href="group___advanced_a_p_i.html#ga56369b1654400ef97e581bb65749ec3d">GetComponentImages</a>(<a class="code" href="namespacetesseract.html#aa26c22b65cc9765a0e747120f4287fd7a5e87a35f16de644593c353159ede11d1">RIL_TEXTLINE</a>, <span class="keyword">true</span>, pixa, blockids);
<a name="l00421"></a>00421 }
<a name="l00422"></a>00422 
<a name="l00423"></a>00423 <span class="comment">// Get textlines and strips of image regions as a leptonica-style Boxa, Pixa</span>
<a name="l00424"></a>00424 <span class="comment">// pair, in reading order. Enables downstream handling of non-rectangular</span>
<a name="l00425"></a>00425 <span class="comment">// regions.</span>
<a name="l00426"></a>00426 <span class="comment">// Can be called before or after Recognize.</span>
<a name="l00427"></a>00427 <span class="comment">// If blockids is not NULL, the block-id of each line is also returned as an</span>
<a name="l00428"></a>00428 <span class="comment">// array of one element per line. delete [] after use.</span>
<a name="l00429"></a><a class="code" href="group___advanced_a_p_i.html#gac7c249f9f7e11eadc557d4b3cab123a1">00429</a> Boxa* <a class="code" href="group___advanced_a_p_i.html#gac7c249f9f7e11eadc557d4b3cab123a1">TessBaseAPI::GetStrips</a>(Pixa** pixa, <span class="keywordtype">int</span>** blockids) {
<a name="l00430"></a>00430   <span class="keywordflow">return</span> <a class="code" href="group___advanced_a_p_i.html#ga56369b1654400ef97e581bb65749ec3d">GetComponentImages</a>(<a class="code" href="namespacetesseract.html#aa26c22b65cc9765a0e747120f4287fd7a5e87a35f16de644593c353159ede11d1">RIL_TEXTLINE</a>, <span class="keyword">false</span>, pixa, blockids);
<a name="l00431"></a>00431 }
<a name="l00432"></a>00432 
<a name="l00433"></a>00433 <span class="comment">// Get the words as a leptonica-style</span>
<a name="l00434"></a>00434 <span class="comment">// Boxa, Pixa pair, in reading order.</span>
<a name="l00435"></a>00435 <span class="comment">// Can be called before or after Recognize.</span>
<a name="l00436"></a><a class="code" href="group___advanced_a_p_i.html#ga4133bcbe38dca1173db2882ef0727703">00436</a> Boxa* <a class="code" href="group___advanced_a_p_i.html#ga4133bcbe38dca1173db2882ef0727703">TessBaseAPI::GetWords</a>(Pixa** pixa) {
<a name="l00437"></a>00437   <span class="keywordflow">return</span> <a class="code" href="group___advanced_a_p_i.html#ga56369b1654400ef97e581bb65749ec3d">GetComponentImages</a>(<a class="code" href="namespacetesseract.html#aa26c22b65cc9765a0e747120f4287fd7afd466aec253e5daa6f0c112b0f0e0610">RIL_WORD</a>, <span class="keyword">true</span>, pixa, <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00438"></a>00438 }
<a name="l00439"></a>00439 
<a name="l00440"></a>00440 <span class="comment">// Gets the individual connected (text) components (created</span>
<a name="l00441"></a>00441 <span class="comment">// after pages segmentation step, but before recognition)</span>
<a name="l00442"></a>00442 <span class="comment">// as a leptonica-style Boxa, Pixa pair, in reading order.</span>
<a name="l00443"></a>00443 <span class="comment">// Can be called before or after Recognize.</span>
<a name="l00444"></a><a class="code" href="group___advanced_a_p_i.html#gaf2b4f88c53457fa5153dc80f5a60e152">00444</a> Boxa* <a class="code" href="group___advanced_a_p_i.html#gaf2b4f88c53457fa5153dc80f5a60e152">TessBaseAPI::GetConnectedComponents</a>(Pixa** pixa) {
<a name="l00445"></a>00445   <span class="keywordflow">return</span> <a class="code" href="group___advanced_a_p_i.html#ga56369b1654400ef97e581bb65749ec3d">GetComponentImages</a>(<a class="code" href="namespacetesseract.html#aa26c22b65cc9765a0e747120f4287fd7adbd62c7f34a9ebdd6e3b813a34cd812d">RIL_SYMBOL</a>, <span class="keyword">true</span>, pixa, <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00446"></a>00446 }
<a name="l00447"></a>00447 
<a name="l00448"></a>00448 <span class="comment">// Get the given level kind of components (block, textline, word etc.) as a</span>
<a name="l00449"></a>00449 <span class="comment">// leptonica-style Boxa, Pixa pair, in reading order.</span>
<a name="l00450"></a>00450 <span class="comment">// Can be called before or after Recognize.</span>
<a name="l00451"></a>00451 <span class="comment">// If blockids is not NULL, the block-id of each component is also returned</span>
<a name="l00452"></a>00452 <span class="comment">// as an array of one element per component. delete [] after use.</span>
<a name="l00453"></a>00453 <span class="comment">// If text_only is true, then only text components are returned.</span>
<a name="l00454"></a><a class="code" href="group___advanced_a_p_i.html#ga56369b1654400ef97e581bb65749ec3d">00454</a> Boxa* <a class="code" href="group___advanced_a_p_i.html#ga56369b1654400ef97e581bb65749ec3d">TessBaseAPI::GetComponentImages</a>(<a class="code" href="namespacetesseract.html#aa26c22b65cc9765a0e747120f4287fd7">PageIteratorLevel</a> level,
<a name="l00455"></a>00455                                       <span class="keywordtype">bool</span> text_only,
<a name="l00456"></a>00456                                       Pixa** pixa, <span class="keywordtype">int</span>** blockids) {
<a name="l00457"></a>00457   <a class="code" href="classtesseract_1_1_page_iterator.html">PageIterator</a>* page_it = <a class="code" href="group___advanced_a_p_i.html#ga52eee8b9a4f147c26e4b64c16b46bc04">GetIterator</a>();
<a name="l00458"></a>00458   <span class="keywordflow">if</span> (page_it == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00459"></a>00459     page_it = <a class="code" href="group___advanced_a_p_i.html#gaaac2abf8505c89afb8466dc3cff2c666">AnalyseLayout</a>();
<a name="l00460"></a>00460   <span class="keywordflow">if</span> (page_it == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00461"></a>00461     <span class="keywordflow">return</span> <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;  <span class="comment">// Failed.</span>
<a name="l00462"></a>00462 
<a name="l00463"></a>00463   <span class="comment">// Count the components to get a size for the arrays.</span>
<a name="l00464"></a>00464   <span class="keywordtype">int</span> component_count = 0;
<a name="l00465"></a>00465   <span class="keywordtype">int</span> left, top, right, bottom;
<a name="l00466"></a>00466   <span class="keywordflow">do</span> {
<a name="l00467"></a>00467     <span class="keywordflow">if</span> (page_it-&gt;<a class="code" href="classtesseract_1_1_page_iterator.html#a2351fffe02706e3cd35b97cb89e6242d">BoundingBoxInternal</a>(level, &amp;left, &amp;top, &amp;right, &amp;bottom) &amp;&amp;
<a name="l00468"></a>00468         (!text_only || <a class="code" href="publictypes_8h.html#a49b7c03fb4e55b82a8fd22b7c6094082">PTIsTextType</a>(page_it-&gt;<a class="code" href="classtesseract_1_1_page_iterator.html#a26c0bc6c991feaf5615f2941b13d0977">BlockType</a>())))
<a name="l00469"></a>00469       ++component_count;
<a name="l00470"></a>00470   } <span class="keywordflow">while</span> (page_it-&gt;<a class="code" href="classtesseract_1_1_page_iterator.html#a415ea7c61e24868bc67e676184be0bb9">Next</a>(level));
<a name="l00471"></a>00471 
<a name="l00472"></a>00472   Boxa* boxa = boxaCreate(component_count);
<a name="l00473"></a>00473   <span class="keywordflow">if</span> (pixa != <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00474"></a>00474     *pixa = pixaCreate(component_count);
<a name="l00475"></a>00475   <span class="keywordflow">if</span> (blockids != <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00476"></a>00476     *blockids = <span class="keyword">new</span> <span class="keywordtype">int</span>[component_count];
<a name="l00477"></a>00477 
<a name="l00478"></a>00478   <span class="keywordtype">int</span> blockid = 0;
<a name="l00479"></a>00479   <span class="keywordtype">int</span> component_index = 0;
<a name="l00480"></a>00480   page_it-&gt;<a class="code" href="classtesseract_1_1_page_iterator.html#a5cc369eb577150a3a677f9c342ce1240">Begin</a>();
<a name="l00481"></a>00481   <span class="keywordflow">do</span> {
<a name="l00482"></a>00482     <span class="keywordflow">if</span> (page_it-&gt;<a class="code" href="classtesseract_1_1_page_iterator.html#a2351fffe02706e3cd35b97cb89e6242d">BoundingBoxInternal</a>(level, &amp;left, &amp;top, &amp;right, &amp;bottom) &amp;&amp;
<a name="l00483"></a>00483         (!text_only || <a class="code" href="publictypes_8h.html#a49b7c03fb4e55b82a8fd22b7c6094082">PTIsTextType</a>(page_it-&gt;<a class="code" href="classtesseract_1_1_page_iterator.html#a26c0bc6c991feaf5615f2941b13d0977">BlockType</a>()))) {
<a name="l00484"></a>00484       Box* lbox = boxCreate(left, top, right - left, bottom - top);
<a name="l00485"></a>00485       boxaAddBox(boxa, lbox, L_INSERT);
<a name="l00486"></a>00486       <span class="keywordflow">if</span> (pixa != <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l00487"></a>00487         Pix* pix = page_it-&gt;<a class="code" href="classtesseract_1_1_page_iterator.html#ad8fb0c95849e23f3c67ab1e765e50ae8">GetBinaryImage</a>(level);
<a name="l00488"></a>00488         pixaAddPix(*pixa, pix, L_INSERT);
<a name="l00489"></a>00489         pixaAddBox(*pixa, lbox, L_CLONE);
<a name="l00490"></a>00490       }
<a name="l00491"></a>00491       <span class="keywordflow">if</span> (blockids != <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l00492"></a>00492         (*blockids)[component_index] = blockid;
<a name="l00493"></a>00493         <span class="keywordflow">if</span> (page_it-&gt;<a class="code" href="classtesseract_1_1_page_iterator.html#af9db4780e93dd192f7cee28f11476cce">IsAtFinalElement</a>(<a class="code" href="namespacetesseract.html#aa26c22b65cc9765a0e747120f4287fd7a2dcea8d4208c16055353029d26f9bf49">RIL_BLOCK</a>, level))
<a name="l00494"></a>00494           ++blockid;
<a name="l00495"></a>00495       }
<a name="l00496"></a>00496       ++component_index;
<a name="l00497"></a>00497     }
<a name="l00498"></a>00498   } <span class="keywordflow">while</span> (page_it-&gt;<a class="code" href="classtesseract_1_1_page_iterator.html#a415ea7c61e24868bc67e676184be0bb9">Next</a>(level));
<a name="l00499"></a>00499   <span class="keyword">delete</span> page_it;
<a name="l00500"></a>00500   <span class="keywordflow">return</span> boxa;
<a name="l00501"></a>00501 }
<a name="l00502"></a>00502 
<a name="l00503"></a><a class="code" href="group___advanced_a_p_i.html#ga6b1c8cac1ba7da32dfd32cf708eea8b4">00503</a> <span class="keywordtype">int</span> <a class="code" href="group___advanced_a_p_i.html#ga6b1c8cac1ba7da32dfd32cf708eea8b4">TessBaseAPI::GetThresholdedImageScaleFactor</a>()<span class="keyword"> const </span>{
<a name="l00504"></a>00504   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a9d93e1d92ca230ae02b81d44bc88a55c" title="Image thresholding module.">thresholder_</a> == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l00505"></a>00505     <span class="keywordflow">return</span> 0;
<a name="l00506"></a>00506   }
<a name="l00507"></a>00507   <span class="keywordflow">return</span> <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a9d93e1d92ca230ae02b81d44bc88a55c" title="Image thresholding module.">thresholder_</a>-&gt;<a class="code" href="classtesseract_1_1_image_thresholder.html#a7d8c733e8624ebc10e74ec2afd517398">GetScaleFactor</a>();
<a name="l00508"></a>00508 }
<a name="l00509"></a>00509 
<a name="l00510"></a>00510 <span class="comment">// Dump the internal binary image to a PGM file.</span>
<a name="l00511"></a><a class="code" href="group___advanced_a_p_i.html#ga4e4a8dbd25ac8816155481bfb53f011a">00511</a> <span class="keywordtype">void</span> <a class="code" href="group___advanced_a_p_i.html#ga4e4a8dbd25ac8816155481bfb53f011a">TessBaseAPI::DumpPGM</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* filename) {
<a name="l00512"></a>00512   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a> == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00513"></a>00513     <span class="keywordflow">return</span>;
<a name="l00514"></a>00514   FILE *fp = fopen(filename, <span class="stringliteral">&quot;wb&quot;</span>);
<a name="l00515"></a>00515   Pix* pix = <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#a97fde2a457aa76137737b247a2418cb7">pix_binary</a>();
<a name="l00516"></a>00516   <span class="keywordtype">int</span> width = pixGetWidth(pix);
<a name="l00517"></a>00517   <span class="keywordtype">int</span> height = pixGetHeight(pix);
<a name="l00518"></a>00518   l_uint32* data = pixGetData(pix);
<a name="l00519"></a>00519   fprintf(fp, <span class="stringliteral">&quot;P5 %d %d 255\n&quot;</span>, width, height);
<a name="l00520"></a>00520   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> y = 0; y &lt; height; ++y, data += pixGetWpl(pix)) {
<a name="l00521"></a>00521     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> x = 0; x &lt; width; ++x) {
<a name="l00522"></a>00522       <a class="code" href="host_8h.html#a458fe97f82495945f8071bb3c18d1783">uinT8</a> b = GET_DATA_BIT(data, x) ? 0 : 255;
<a name="l00523"></a>00523       fwrite(&amp;b, 1, 1, fp);
<a name="l00524"></a>00524     }
<a name="l00525"></a>00525   }
<a name="l00526"></a>00526   fclose(fp);
<a name="l00527"></a>00527 }
<a name="l00528"></a>00528 
<a name="l00529"></a>00529 <span class="comment">// Placeholder for call to Cube and test that the input data is correct.</span>
<a name="l00530"></a>00530 <span class="comment">// reskew is the direction of baselines in the skewed image in</span>
<a name="l00531"></a>00531 <span class="comment">// normalized (cos theta, sin theta) form, so (0.866, 0.5) would represent</span>
<a name="l00532"></a>00532 <span class="comment">// a 30 degree anticlockwise skew.</span>
<a name="l00533"></a><a class="code" href="namespacetesseract.html#a94bf40501f379eb684323383a926162c">00533</a> <span class="keywordtype">int</span> <a class="code" href="namespacetesseract.html#a94bf40501f379eb684323383a926162c">CubeAPITest</a>(Boxa* boxa_blocks, Pixa* pixa_blocks,
<a name="l00534"></a>00534                 Boxa* boxa_words, Pixa* pixa_words,
<a name="l00535"></a>00535                 <span class="keyword">const</span> <a class="code" href="class_f_c_o_o_r_d.html">FCOORD</a>&amp; reskew, Pix* page_pix,
<a name="l00536"></a>00536                 <a class="code" href="class_p_a_g_e___r_e_s.html">PAGE_RES</a>* page_res) {
<a name="l00537"></a>00537   <span class="keywordtype">int</span> block_count = boxaGetCount(boxa_blocks);
<a name="l00538"></a>00538   <a class="code" href="errcode_8h.html#a93a603f4063a6b9403d81caa245a583b">ASSERT_HOST</a>(block_count == pixaGetCount(pixa_blocks));
<a name="l00539"></a>00539   <span class="comment">// Write each block to the current directory as junk_write_display.nnn.png.</span>
<a name="l00540"></a>00540   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; block_count; ++i) {
<a name="l00541"></a>00541     Pix* pix = pixaGetPix(pixa_blocks, i, L_CLONE);
<a name="l00542"></a>00542     pixDisplayWrite(pix, 1);
<a name="l00543"></a>00543   }
<a name="l00544"></a>00544   <span class="keywordtype">int</span> word_count = boxaGetCount(boxa_words);
<a name="l00545"></a>00545   <a class="code" href="errcode_8h.html#a93a603f4063a6b9403d81caa245a583b">ASSERT_HOST</a>(word_count == pixaGetCount(pixa_words));
<a name="l00546"></a>00546   <span class="keywordtype">int</span> pr_word = 0;
<a name="l00547"></a>00547   <a class="code" href="class_p_a_g_e___r_e_s___i_t.html">PAGE_RES_IT</a> page_res_it(page_res);
<a name="l00548"></a>00548   <span class="keywordflow">for</span> (page_res_it.<a class="code" href="class_p_a_g_e___r_e_s___i_t.html#a15febd45d0904bb3c5f7d506368177f0">restart_page</a>(); page_res_it.<a class="code" href="class_p_a_g_e___r_e_s___i_t.html#ab84b4850200ba8802791c6197c113fd0">word</a> () != <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00549"></a>00549        page_res_it.<a class="code" href="class_p_a_g_e___r_e_s___i_t.html#ab29005f235cc738eebafb7d9ed6fe70b">forward</a>(), ++pr_word) {
<a name="l00550"></a>00550     <a class="code" href="class_w_e_r_d___r_e_s.html">WERD_RES</a> *word = page_res_it.<a class="code" href="class_p_a_g_e___r_e_s___i_t.html#ab84b4850200ba8802791c6197c113fd0">word</a>();
<a name="l00551"></a>00551     <a class="code" href="class_w_e_r_d___c_h_o_i_c_e.html">WERD_CHOICE</a>* choice = word-&gt;<a class="code" href="class_w_e_r_d___r_e_s.html#a3d42ac7ec121263e757c9b7160dfd50d">best_choice</a>;
<a name="l00552"></a>00552     <span class="comment">// Write the first 100 words to files names wordims/&lt;wordstring&gt;.tif.</span>
<a name="l00553"></a>00553     <span class="keywordflow">if</span> (pr_word &lt; 100) {
<a name="l00554"></a>00554       <a class="code" href="class_s_t_r_i_n_g.html">STRING</a> filename(<span class="stringliteral">&quot;wordims/&quot;</span>);
<a name="l00555"></a>00555       <span class="keywordflow">if</span> (choice != <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l00556"></a>00556         filename += choice-&gt;<a class="code" href="class_w_e_r_d___c_h_o_i_c_e.html#a41d740f0accccdfb245d34d554122116">unichar_string</a>();
<a name="l00557"></a>00557       } <span class="keywordflow">else</span> {
<a name="l00558"></a>00558         <span class="keywordtype">char</span> numbuf[32];
<a name="l00559"></a>00559         filename += <span class="stringliteral">&quot;unclassified&quot;</span>;
<a name="l00560"></a>00560         snprintf(numbuf, 32, <span class="stringliteral">&quot;%03d&quot;</span>, pr_word);
<a name="l00561"></a>00561         filename += numbuf;
<a name="l00562"></a>00562       }
<a name="l00563"></a>00563       filename += <span class="stringliteral">&quot;.tif&quot;</span>;
<a name="l00564"></a>00564       Pix* pix = pixaGetPix(pixa_words, pr_word, L_CLONE);
<a name="l00565"></a>00565       pixWrite(filename.<a class="code" href="class_s_t_r_i_n_g.html#a32beee43ecab1bed8bebc3466896ad6e">string</a>(), pix, IFF_TIFF_G4);
<a name="l00566"></a>00566     }
<a name="l00567"></a>00567   }
<a name="l00568"></a>00568   <a class="code" href="errcode_8h.html#a93a603f4063a6b9403d81caa245a583b">ASSERT_HOST</a>(pr_word == word_count);
<a name="l00569"></a>00569   <span class="keywordflow">return</span> 0;
<a name="l00570"></a>00570 }
<a name="l00571"></a>00571 
<a name="l00572"></a>00572 <span class="comment">// Runs page layout analysis in the mode set by SetPageSegMode.</span>
<a name="l00573"></a>00573 <span class="comment">// May optionally be called prior to Recognize to get access to just</span>
<a name="l00574"></a>00574 <span class="comment">// the page layout results. Returns an iterator to the results.</span>
<a name="l00575"></a>00575 <span class="comment">// Returns NULL on error or an empty page.</span>
<a name="l00576"></a>00576 <span class="comment">// The returned iterator must be deleted after use.</span>
<a name="l00577"></a>00577 <span class="comment">// WARNING! This class points to data held within the TessBaseAPI class, and</span>
<a name="l00578"></a>00578 <span class="comment">// therefore can only be used while the TessBaseAPI class still exists and</span>
<a name="l00579"></a>00579 <span class="comment">// has not been subjected to a call of Init, SetImage, Recognize, Clear, End</span>
<a name="l00580"></a>00580 <span class="comment">// DetectOS, or anything else that changes the internal PAGE_RES.</span>
<a name="l00581"></a><a class="code" href="group___advanced_a_p_i.html#gaaac2abf8505c89afb8466dc3cff2c666">00581</a> <a class="code" href="classtesseract_1_1_page_iterator.html">PageIterator</a>* <a class="code" href="group___advanced_a_p_i.html#gaaac2abf8505c89afb8466dc3cff2c666">TessBaseAPI::AnalyseLayout</a>() {
<a name="l00582"></a>00582   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a86899716a1adde396be4efd57b547d27">FindLines</a>() == 0) {
<a name="l00583"></a>00583     <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ac22c36258b0cd727188505a9a1dbc7e1" title="The page layout.">block_list_</a>-&gt;empty())
<a name="l00584"></a>00584       <span class="keywordflow">return</span> <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;  <span class="comment">// The page was empty.</span>
<a name="l00585"></a>00585     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a12dda612630eba40e15f9d0b9955a04c" title="The page-level data.">page_res_</a> = <span class="keyword">new</span> <a class="code" href="class_p_a_g_e___r_e_s.html">PAGE_RES</a>(<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ac22c36258b0cd727188505a9a1dbc7e1" title="The page layout.">block_list_</a>, <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00586"></a>00586     <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classtesseract_1_1_page_iterator.html">PageIterator</a>(<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a12dda612630eba40e15f9d0b9955a04c" title="The page-level data.">page_res_</a>, <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>,
<a name="l00587"></a>00587                             <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a9d93e1d92ca230ae02b81d44bc88a55c" title="Image thresholding module.">thresholder_</a>-&gt;<a class="code" href="classtesseract_1_1_image_thresholder.html#a7d8c733e8624ebc10e74ec2afd517398">GetScaleFactor</a>(),
<a name="l00588"></a>00588                             <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a9d93e1d92ca230ae02b81d44bc88a55c" title="Image thresholding module.">thresholder_</a>-&gt;<a class="code" href="classtesseract_1_1_image_thresholder.html#a2fb94a4d1697c06bff68e33269297c59">GetScaledYResolution</a>(),
<a name="l00589"></a>00589                             <a class="code" href="group___thresholder_params.html#gab3c90d43a3628dc7abeb93e9ca01bc97">rect_left_</a>, <a class="code" href="group___thresholder_params.html#gac71648cd860510ca65b94d87d7d9bb1f">rect_top_</a>, <a class="code" href="group___thresholder_params.html#ga31dbaec91a5dd8ee7d399786a4bd5ef8">rect_width_</a>, <a class="code" href="group___thresholder_params.html#ga978edc537da096ec07d4bb8e4ae5332d">rect_height_</a>);
<a name="l00590"></a>00590   }
<a name="l00591"></a>00591   <span class="keywordflow">return</span> <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00592"></a>00592 }
<a name="l00593"></a>00593 
<a name="l00594"></a>00594 <span class="comment">// Recognize the tesseract global image and return the result as Tesseract</span>
<a name="l00595"></a>00595 <span class="comment">// internal structures.</span>
<a name="l00596"></a><a class="code" href="group___advanced_a_p_i.html#ga0e4065c20b142d69a2324ee0c74ae0b0">00596</a> <span class="keywordtype">int</span> <a class="code" href="group___advanced_a_p_i.html#ga0e4065c20b142d69a2324ee0c74ae0b0">TessBaseAPI::Recognize</a>(<a class="code" href="class_e_t_e_x_t___d_e_s_c.html">ETEXT_DESC</a>* monitor) {
<a name="l00597"></a>00597   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a> == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00598"></a>00598     <span class="keywordflow">return</span> -1;
<a name="l00599"></a>00599   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a86899716a1adde396be4efd57b547d27">FindLines</a>() != 0)
<a name="l00600"></a>00600     <span class="keywordflow">return</span> -1;
<a name="l00601"></a>00601   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a12dda612630eba40e15f9d0b9955a04c" title="The page-level data.">page_res_</a> != <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00602"></a>00602     <span class="keyword">delete</span> <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a12dda612630eba40e15f9d0b9955a04c" title="The page-level data.">page_res_</a>;
<a name="l00603"></a>00603 
<a name="l00604"></a>00604   <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#a35e62e060c86649e14cdf688d09a0f7a">SetBlackAndWhitelist</a>();
<a name="l00605"></a>00605   <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a7d4627f300b1096d43a3e7d54d8aa5df" title="page_res_ contains recognition data.">recognition_done_</a> = <span class="keyword">true</span>;
<a name="l00606"></a>00606   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#a7fc8d9323b89b20e8d153eef861266b8">tessedit_resegment_from_line_boxes</a>)
<a name="l00607"></a>00607     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a12dda612630eba40e15f9d0b9955a04c" title="The page-level data.">page_res_</a> = <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#ad8d1403d0d4862f9c07fc1eafdd13a00">ApplyBoxes</a>(*<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a4690919aa9d4eabda36bdefdaadf7ac9" title="Name used by training code.">input_file_</a>, <span class="keyword">true</span>, <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ac22c36258b0cd727188505a9a1dbc7e1" title="The page layout.">block_list_</a>);
<a name="l00608"></a>00608   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#a62f5e64459a2d2a15526c3229c12e6a0">tessedit_resegment_from_boxes</a>)
<a name="l00609"></a>00609     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a12dda612630eba40e15f9d0b9955a04c" title="The page-level data.">page_res_</a> = <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#ad8d1403d0d4862f9c07fc1eafdd13a00">ApplyBoxes</a>(*<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a4690919aa9d4eabda36bdefdaadf7ac9" title="Name used by training code.">input_file_</a>, <span class="keyword">false</span>, <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ac22c36258b0cd727188505a9a1dbc7e1" title="The page layout.">block_list_</a>);
<a name="l00610"></a>00610   <span class="keywordflow">else</span>
<a name="l00611"></a>00611     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a12dda612630eba40e15f9d0b9955a04c" title="The page-level data.">page_res_</a> = <span class="keyword">new</span> <a class="code" href="class_p_a_g_e___r_e_s.html">PAGE_RES</a>(<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ac22c36258b0cd727188505a9a1dbc7e1" title="The page layout.">block_list_</a>, &amp;<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_wordrec.html#a143608f482c6c0c4f312740e6a5f5fd9">prev_word_best_choice_</a>);
<a name="l00612"></a>00612   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#ab079fbbd71433f3de894f912e5b11e6d">tessedit_make_boxes_from_boxes</a>) {
<a name="l00613"></a>00613     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#aaac7729b5dc17651a6b3ee44689302d5">CorrectClassifyWords</a>(<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a12dda612630eba40e15f9d0b9955a04c" title="The page-level data.">page_res_</a>);
<a name="l00614"></a>00614     <span class="keywordflow">return</span> 0;
<a name="l00615"></a>00615   }
<a name="l00616"></a>00616 
<a name="l00617"></a>00617   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ac7eaed7f3fedb15212eb39b747de0102">truth_cb_</a> != <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l00618"></a>00618     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_wordrec.html#a5f360cd76704a08b03a4738a97e8457b">wordrec_run_blamer</a>.set_value(<span class="keyword">true</span>);
<a name="l00619"></a>00619     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ac7eaed7f3fedb15212eb39b747de0102">truth_cb_</a>-&gt;<a class="code" href="class_tess_callback3.html#ac5973fd77da4c98d0fc240427ecc923d">Run</a>(<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_classify.html#a83e4207353a1bb07adfaa6a82a74c9ce">getDict</a>().<a class="code" href="classtesseract_1_1_dict.html#a635ce00ba9aa24247563d26ae26da631">getUnicharset</a>(),
<a name="l00620"></a>00620                    <a class="code" href="group___thresholder_params.html#gab7d24a78f3565c5bfb42b2592b9e8df0">image_height_</a>, <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a12dda612630eba40e15f9d0b9955a04c" title="The page-level data.">page_res_</a>);
<a name="l00621"></a>00621   }
<a name="l00622"></a>00622 
<a name="l00623"></a>00623   <span class="keywordtype">int</span> result = 0;
<a name="l00624"></a>00624   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#a51f1cb37c2fff5e2ade385b160c3a0e3">interactive_display_mode</a>) {
<a name="l00625"></a>00625 <span class="preprocessor">    #ifndef GRAPHICS_DISABLED</span>
<a name="l00626"></a>00626 <span class="preprocessor"></span>    <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#ab48cff8de587e3a573a327846e57c51d">pgeditor_main</a>(<a class="code" href="group___thresholder_params.html#ga31dbaec91a5dd8ee7d399786a4bd5ef8">rect_width_</a>, <a class="code" href="group___thresholder_params.html#ga978edc537da096ec07d4bb8e4ae5332d">rect_height_</a>, <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a12dda612630eba40e15f9d0b9955a04c" title="The page-level data.">page_res_</a>);
<a name="l00627"></a>00627 <span class="preprocessor">    #endif  // GRAPHICS_DISABLED</span>
<a name="l00628"></a>00628 <span class="preprocessor"></span>    <span class="comment">// The page_res is invalid after an interactive session, so cleanup</span>
<a name="l00629"></a>00629     <span class="comment">// in a way that lets us continue to the next page without crashing.</span>
<a name="l00630"></a>00630     <span class="keyword">delete</span> <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a12dda612630eba40e15f9d0b9955a04c" title="The page-level data.">page_res_</a>;
<a name="l00631"></a>00631     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a12dda612630eba40e15f9d0b9955a04c" title="The page-level data.">page_res_</a> = <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00632"></a>00632     <span class="keywordflow">return</span> -1;
<a name="l00633"></a>00633   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#a95bb008c7903633f1f3cd50540c05742">tessedit_train_from_boxes</a>) {
<a name="l00634"></a>00634     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#a8a81b9367a8ec670835f766f64f773db">ApplyBoxTraining</a>(*<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a22a0c520bc88e2d80fb8b6a10b7caba1" title="Name used by debug code.">output_file_</a>, <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a12dda612630eba40e15f9d0b9955a04c" title="The page-level data.">page_res_</a>);
<a name="l00635"></a>00635   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#aeed33f786b5c71bf0b47452c76bf0c8a">tessedit_ambigs_training</a>) {
<a name="l00636"></a>00636     FILE *training_output_file = <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#a4b787b26c3c009f5b2dbfdd9ef5f55d7">init_recog_training</a>(*<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a4690919aa9d4eabda36bdefdaadf7ac9" title="Name used by training code.">input_file_</a>);
<a name="l00637"></a>00637     <span class="comment">// OCR the page segmented into words by tesseract.</span>
<a name="l00638"></a>00638     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#a02591ce36a6ff477040bf844b4d1d364">recog_training_segmented</a>(
<a name="l00639"></a>00639         *<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a4690919aa9d4eabda36bdefdaadf7ac9" title="Name used by training code.">input_file_</a>, <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a12dda612630eba40e15f9d0b9955a04c" title="The page-level data.">page_res_</a>, monitor, training_output_file);
<a name="l00640"></a>00640     fclose(training_output_file);
<a name="l00641"></a>00641   } <span class="keywordflow">else</span> {
<a name="l00642"></a>00642     <span class="comment">// Now run the main recognition.</span>
<a name="l00643"></a>00643     <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#af9c097177e82c5f5495a7dc1506d66ed">recog_all_words</a>(<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a12dda612630eba40e15f9d0b9955a04c" title="The page-level data.">page_res_</a>, monitor, <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0)) {
<a name="l00644"></a>00644       <span class="keywordtype">int</span> paragraph_debug_level = 0;
<a name="l00645"></a>00645       <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a5923cccbe20988f0f99072844d1af573">GetIntVariable</a>(<span class="stringliteral">&quot;paragraph_debug_level&quot;</span>, &amp;paragraph_debug_level);
<a name="l00646"></a>00646       <a class="code" href="group__ocropus_add_ons.html#ga97bb9808a0759d47e056ef516e8df47e">DetectParagraphs</a>(paragraph_debug_level);
<a name="l00647"></a>00647     } <span class="keywordflow">else</span> {
<a name="l00648"></a>00648       result = -1;
<a name="l00649"></a>00649     }
<a name="l00650"></a>00650   }
<a name="l00651"></a>00651   <span class="keywordflow">return</span> result;
<a name="l00652"></a>00652 }
<a name="l00653"></a>00653 
<a name="l00654"></a>00654 <span class="comment">// Tests the chopper by exhaustively running chop_one_blob.</span>
<a name="l00655"></a><a class="code" href="group___advanced_a_p_i.html#gaec56194587e149ae38a08eccd2e0d96a">00655</a> <span class="keywordtype">int</span> <a class="code" href="group___advanced_a_p_i.html#gaec56194587e149ae38a08eccd2e0d96a">TessBaseAPI::RecognizeForChopTest</a>(<a class="code" href="class_e_t_e_x_t___d_e_s_c.html">ETEXT_DESC</a>* monitor) {
<a name="l00656"></a>00656   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a> == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00657"></a>00657     <span class="keywordflow">return</span> -1;
<a name="l00658"></a>00658   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a9d93e1d92ca230ae02b81d44bc88a55c" title="Image thresholding module.">thresholder_</a> == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a9d93e1d92ca230ae02b81d44bc88a55c" title="Image thresholding module.">thresholder_</a>-&gt;<a class="code" href="classtesseract_1_1_image_thresholder.html#a4a643445e9ab0e22fabe45308c6d2548" title="Return true if no image has been set.">IsEmpty</a>()) {
<a name="l00659"></a>00659     <a class="code" href="tprintf_8cpp.html#a0c2bcd4462ec67ab0971b34a0f610f55">tprintf</a>(<span class="stringliteral">&quot;Please call SetImage before attempting recognition.&quot;</span>);
<a name="l00660"></a>00660     <span class="keywordflow">return</span> -1;
<a name="l00661"></a>00661   }
<a name="l00662"></a>00662   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a12dda612630eba40e15f9d0b9955a04c" title="The page-level data.">page_res_</a> != <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00663"></a>00663     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a83ca325b5e521416b1edcd020b169be0">ClearResults</a>();
<a name="l00664"></a>00664   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a86899716a1adde396be4efd57b547d27">FindLines</a>() != 0)
<a name="l00665"></a>00665     <span class="keywordflow">return</span> -1;
<a name="l00666"></a>00666   <span class="comment">// Additional conditions under which chopper test cannot be run</span>
<a name="l00667"></a>00667   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#a51f1cb37c2fff5e2ade385b160c3a0e3">interactive_display_mode</a>) <span class="keywordflow">return</span> -1;
<a name="l00668"></a>00668 
<a name="l00669"></a>00669   <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a7d4627f300b1096d43a3e7d54d8aa5df" title="page_res_ contains recognition data.">recognition_done_</a> = <span class="keyword">true</span>;
<a name="l00670"></a>00670 
<a name="l00671"></a>00671   <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a12dda612630eba40e15f9d0b9955a04c" title="The page-level data.">page_res_</a> = <span class="keyword">new</span> <a class="code" href="class_p_a_g_e___r_e_s.html">PAGE_RES</a>(<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ac22c36258b0cd727188505a9a1dbc7e1" title="The page layout.">block_list_</a>, &amp;(<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_wordrec.html#a143608f482c6c0c4f312740e6a5f5fd9">prev_word_best_choice_</a>));
<a name="l00672"></a>00672 
<a name="l00673"></a>00673   <a class="code" href="class_p_a_g_e___r_e_s___i_t.html">PAGE_RES_IT</a> page_res_it(<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a12dda612630eba40e15f9d0b9955a04c" title="The page-level data.">page_res_</a>);
<a name="l00674"></a>00674 
<a name="l00675"></a>00675   <span class="keywordflow">while</span> (page_res_it.<a class="code" href="class_p_a_g_e___r_e_s___i_t.html#ab84b4850200ba8802791c6197c113fd0">word</a>() != <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l00676"></a>00676     <a class="code" href="class_w_e_r_d___r_e_s.html">WERD_RES</a> *word_res = page_res_it.<a class="code" href="class_p_a_g_e___r_e_s___i_t.html#ab84b4850200ba8802791c6197c113fd0">word</a>();
<a name="l00677"></a>00677     <a class="code" href="class_generic_vector.html">GenericVector&lt;TBOX&gt;</a> boxes;
<a name="l00678"></a>00678     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#aab153649250a4b8bd6ffb4e22f44f79f">MaximallyChopWord</a>(boxes, page_res_it.<a class="code" href="class_p_a_g_e___r_e_s___i_t.html#a8a349c5163802e1f127d5c88db044059">block</a>()-&gt;<a class="code" href="class_b_l_o_c_k___r_e_s.html#ae7c240d4878247ebdfe78433446751bf">block</a>,
<a name="l00679"></a>00679                                   page_res_it.<a class="code" href="class_p_a_g_e___r_e_s___i_t.html#a312f58081e9410962396160eaf5f90e4">row</a>()-&gt;<a class="code" href="class_r_o_w___r_e_s.html#ad3a856f3e9217c47b8f2f54cd3908721">row</a>, word_res);
<a name="l00680"></a>00680     page_res_it.<a class="code" href="class_p_a_g_e___r_e_s___i_t.html#ab29005f235cc738eebafb7d9ed6fe70b">forward</a>();
<a name="l00681"></a>00681   }
<a name="l00682"></a>00682   <span class="keywordflow">return</span> 0;
<a name="l00683"></a>00683 }
<a name="l00684"></a>00684 
<a name="l00685"></a>00685 
<a name="l00686"></a>00686 <span class="comment">// Recognizes all the pages in the named file, as a multi-page tiff or</span>
<a name="l00687"></a>00687 <span class="comment">// list of filenames, or single image, and gets the appropriate kind of text</span>
<a name="l00688"></a>00688 <span class="comment">// according to parameters: tessedit_create_boxfile,</span>
<a name="l00689"></a>00689 <span class="comment">// tessedit_make_boxes_from_boxes, tessedit_write_unlv, tessedit_create_hocr.</span>
<a name="l00690"></a>00690 <span class="comment">// Calls ProcessPage on each page in the input file, which may be a</span>
<a name="l00691"></a>00691 <span class="comment">// multi-page tiff, single-page other file format, or a plain text list of</span>
<a name="l00692"></a>00692 <span class="comment">// images to read. If tessedit_page_number is non-negative, processing begins</span>
<a name="l00693"></a>00693 <span class="comment">// at that page of a multi-page tiff file, or filelist.</span>
<a name="l00694"></a>00694 <span class="comment">// The text is returned in text_out. Returns false on error.</span>
<a name="l00695"></a>00695 <span class="comment">// If non-zero timeout_millisec terminates processing after the timeout on</span>
<a name="l00696"></a>00696 <span class="comment">// a single page.</span>
<a name="l00697"></a>00697 <span class="comment">// If non-NULL and non-empty, and some page fails for some reason,</span>
<a name="l00698"></a>00698 <span class="comment">// the page is reprocessed with the retry_config config file. Useful</span>
<a name="l00699"></a>00699 <span class="comment">// for interactively debugging a bad page.</span>
<a name="l00700"></a><a class="code" href="group___advanced_a_p_i.html#gaf89df932c29b0abe4fb4ca3ae852506b">00700</a> <span class="keywordtype">bool</span> <a class="code" href="group___advanced_a_p_i.html#gaf89df932c29b0abe4fb4ca3ae852506b">TessBaseAPI::ProcessPages</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* filename,
<a name="l00701"></a>00701                                <span class="keyword">const</span> <span class="keywordtype">char</span>* retry_config, <span class="keywordtype">int</span> timeout_millisec,
<a name="l00702"></a>00702                                <a class="code" href="class_s_t_r_i_n_g.html">STRING</a>* text_out) {
<a name="l00703"></a>00703   <span class="keywordtype">int</span> page = <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#a9ea498e7c3d83469257493f8900c3922">tessedit_page_number</a>;
<a name="l00704"></a>00704   <span class="keywordflow">if</span> (page &lt; 0)
<a name="l00705"></a>00705     page = 0;
<a name="l00706"></a>00706   FILE* fp = fopen(filename, <span class="stringliteral">&quot;rb&quot;</span>);
<a name="l00707"></a>00707   <span class="keywordflow">if</span> (fp == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l00708"></a>00708     <a class="code" href="tprintf_8cpp.html#a0c2bcd4462ec67ab0971b34a0f610f55">tprintf</a>(<a class="code" href="baseapi_8cpp.html#af20b8d139279b360b0fdeae71f8f43bc">_</a>(<span class="stringliteral">&quot;Image file %s cannot be opened!\n&quot;</span>), filename);
<a name="l00709"></a>00709     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00710"></a>00710   }
<a name="l00711"></a>00711   <span class="comment">// Find the number of pages if a tiff file, or zero otherwise.</span>
<a name="l00712"></a>00712   <span class="keywordtype">int</span> npages = <a class="code" href="imgtiff_8cpp.html#a9a7b4b88acbe06eecfea0c8e28797849">CountTiffPages</a>(fp);
<a name="l00713"></a>00713   fclose(fp);
<a name="l00714"></a>00714 
<a name="l00715"></a>00715   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#a843cff0b614a5a71e5a00302011c811c">tessedit_create_hocr</a>) {
<a name="l00716"></a>00716     *text_out =
<a name="l00717"></a>00717         <span class="stringliteral">&quot;&lt;!DOCTYPE html PUBLIC \&quot;-//W3C//DTD HTML 4.01 Transitional//EN\&quot;&quot;</span>
<a name="l00718"></a>00718         <span class="stringliteral">&quot; \&quot;http://www.w3.org/TR/html4/loose.dtd\&quot;&gt;\n&quot;</span>
<a name="l00719"></a>00719         <span class="stringliteral">&quot;&lt;html&gt;\n&lt;head&gt;\n&lt;title&gt;&lt;/title&gt;\n&quot;</span>
<a name="l00720"></a>00720         <span class="stringliteral">&quot;&lt;meta http-equiv=\&quot;Content-Type\&quot; content=\&quot;text/html;&quot;</span>
<a name="l00721"></a>00721         <span class="stringliteral">&quot;charset=utf-8\&quot; /&gt;\n&lt;meta name=&#39;ocr-system&#39; content=&#39;tesseract&#39;/&gt;\n&quot;</span>
<a name="l00722"></a>00722         <span class="stringliteral">&quot;&lt;/head&gt;\n&lt;body&gt;\n&quot;</span>;
<a name="l00723"></a>00723   } <span class="keywordflow">else</span> {
<a name="l00724"></a>00724     *text_out = <span class="stringliteral">&quot;&quot;</span>;
<a name="l00725"></a>00725   }
<a name="l00726"></a>00726 
<a name="l00727"></a>00727   <span class="keywordtype">bool</span> success = <span class="keyword">true</span>;
<a name="l00728"></a>00728   Pix *pix;
<a name="l00729"></a>00729   <span class="keywordflow">if</span> (npages &gt; 0) {
<a name="l00730"></a>00730     <span class="keywordflow">for</span> (; page &lt; npages &amp;&amp; (pix = pixReadTiff(filename, page)) != <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00731"></a>00731          ++page) {
<a name="l00732"></a>00732       <span class="keywordflow">if</span> ((page &gt;= 0) &amp;&amp; (npages &gt; 1))
<a name="l00733"></a>00733         <a class="code" href="tprintf_8cpp.html#a0c2bcd4462ec67ab0971b34a0f610f55">tprintf</a>(<a class="code" href="baseapi_8cpp.html#af20b8d139279b360b0fdeae71f8f43bc">_</a>(<span class="stringliteral">&quot;Page %d of %d\n&quot;</span>), page + 1, npages);
<a name="l00734"></a>00734       <span class="keywordtype">char</span> page_str[<a class="code" href="namespacetesseract.html#a3e35711780f8c0254a2dd64071ef2b6b">kMaxIntSize</a>];
<a name="l00735"></a>00735       snprintf(page_str, <a class="code" href="namespacetesseract.html#a3e35711780f8c0254a2dd64071ef2b6b">kMaxIntSize</a> - 1, <span class="stringliteral">&quot;%d&quot;</span>, page);
<a name="l00736"></a>00736       <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a2e09259c558c6d8e0f7e523cbaf5adf5">SetVariable</a>(<span class="stringliteral">&quot;applybox_page&quot;</span>, page_str);
<a name="l00737"></a>00737       success &amp;= <a class="code" href="group___advanced_a_p_i.html#ga09be3b61fd89f7803fe37cc420b92b30">ProcessPage</a>(pix, page, filename, retry_config,
<a name="l00738"></a>00738                              timeout_millisec, text_out);
<a name="l00739"></a>00739       pixDestroy(&amp;pix);
<a name="l00740"></a>00740       <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#a9ea498e7c3d83469257493f8900c3922">tessedit_page_number</a> &gt;= 0 || npages == 1) {
<a name="l00741"></a>00741         <span class="keywordflow">break</span>;
<a name="l00742"></a>00742       }
<a name="l00743"></a>00743     }
<a name="l00744"></a>00744   } <span class="keywordflow">else</span> {
<a name="l00745"></a>00745     <span class="comment">// The file is not a tiff file, so use the general pixRead function.</span>
<a name="l00746"></a>00746     pix = pixRead(filename);
<a name="l00747"></a>00747     <span class="keywordflow">if</span> (pix != <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l00748"></a>00748       success &amp;= <a class="code" href="group___advanced_a_p_i.html#ga09be3b61fd89f7803fe37cc420b92b30">ProcessPage</a>(pix, 0, filename, retry_config,
<a name="l00749"></a>00749                              timeout_millisec, text_out);
<a name="l00750"></a>00750       pixDestroy(&amp;pix);
<a name="l00751"></a>00751     } <span class="keywordflow">else</span> {
<a name="l00752"></a>00752       <span class="comment">// The file is not an image file, so try it as a list of filenames.</span>
<a name="l00753"></a>00753       FILE* fimg = fopen(filename, <span class="stringliteral">&quot;rb&quot;</span>);
<a name="l00754"></a>00754       <span class="keywordflow">if</span> (fimg == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l00755"></a>00755         <a class="code" href="tprintf_8cpp.html#a0c2bcd4462ec67ab0971b34a0f610f55">tprintf</a>(<a class="code" href="baseapi_8cpp.html#af20b8d139279b360b0fdeae71f8f43bc">_</a>(<span class="stringliteral">&quot;File %s cannot be opened!\n&quot;</span>), filename);
<a name="l00756"></a>00756         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00757"></a>00757       }
<a name="l00758"></a>00758       <a class="code" href="tprintf_8cpp.html#a0c2bcd4462ec67ab0971b34a0f610f55">tprintf</a>(<a class="code" href="baseapi_8cpp.html#af20b8d139279b360b0fdeae71f8f43bc">_</a>(<span class="stringliteral">&quot;Reading %s as a list of filenames...\n&quot;</span>), filename);
<a name="l00759"></a>00759       <span class="keywordtype">char</span> pagename[<a class="code" href="platform_8h.html#ab99ded389af74001a6298fc9e44e74e5">MAX_PATH</a>];
<a name="l00760"></a>00760       <span class="comment">// Skip to the requested page number.</span>
<a name="l00761"></a>00761       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; page &amp;&amp;
<a name="l00762"></a>00762            fgets(pagename, <span class="keyword">sizeof</span>(pagename), fimg) != <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00763"></a>00763            ++i);
<a name="l00764"></a>00764       <span class="keywordflow">while</span> (fgets(pagename, <span class="keyword">sizeof</span>(pagename), fimg) != <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l00765"></a>00765         <a class="code" href="helpers_8h.html#a31bec0ef73dd383e256fa462e9fa7e1f">chomp_string</a>(pagename);
<a name="l00766"></a>00766         pix = pixRead(pagename);
<a name="l00767"></a>00767         <span class="keywordflow">if</span> (pix == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l00768"></a>00768           <a class="code" href="tprintf_8cpp.html#a0c2bcd4462ec67ab0971b34a0f610f55">tprintf</a>(<a class="code" href="baseapi_8cpp.html#af20b8d139279b360b0fdeae71f8f43bc">_</a>(<span class="stringliteral">&quot;Image file %s cannot be read!\n&quot;</span>), pagename);
<a name="l00769"></a>00769           fclose(fimg);
<a name="l00770"></a>00770           <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00771"></a>00771         }
<a name="l00772"></a>00772         <a class="code" href="tprintf_8cpp.html#a0c2bcd4462ec67ab0971b34a0f610f55">tprintf</a>(<a class="code" href="baseapi_8cpp.html#af20b8d139279b360b0fdeae71f8f43bc">_</a>(<span class="stringliteral">&quot;Page %d : %s\n&quot;</span>), page, pagename);
<a name="l00773"></a>00773         success &amp;= <a class="code" href="group___advanced_a_p_i.html#ga09be3b61fd89f7803fe37cc420b92b30">ProcessPage</a>(pix, page, pagename, retry_config,
<a name="l00774"></a>00774                                timeout_millisec, text_out);
<a name="l00775"></a>00775         pixDestroy(&amp;pix);
<a name="l00776"></a>00776         ++page;
<a name="l00777"></a>00777       }
<a name="l00778"></a>00778       fclose(fimg);
<a name="l00779"></a>00779     }
<a name="l00780"></a>00780   }
<a name="l00781"></a>00781   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#a843cff0b614a5a71e5a00302011c811c">tessedit_create_hocr</a>)
<a name="l00782"></a>00782     *text_out += <span class="stringliteral">&quot;&lt;/body&gt;\n&lt;/html&gt;\n&quot;</span>;
<a name="l00783"></a>00783   <span class="keywordflow">return</span> success;
<a name="l00784"></a>00784 }
<a name="l00785"></a>00785 
<a name="l00786"></a>00786 
<a name="l00787"></a>00787 <span class="comment">// Recognizes a single page for ProcessPages, appending the text to text_out.</span>
<a name="l00788"></a>00788 <span class="comment">// The pix is the image processed - filename and page_index are metadata</span>
<a name="l00789"></a>00789 <span class="comment">// used by side-effect processes, such as reading a box file or formatting</span>
<a name="l00790"></a>00790 <span class="comment">// as hOCR.</span>
<a name="l00791"></a>00791 <span class="comment">// If non-zero timeout_millisec terminates processing after the timeout.</span>
<a name="l00792"></a>00792 <span class="comment">// If non-NULL and non-empty, and some page fails for some reason,</span>
<a name="l00793"></a>00793 <span class="comment">// the page is reprocessed with the retry_config config file. Useful</span>
<a name="l00794"></a>00794 <span class="comment">// for interactively debugging a bad page.</span>
<a name="l00795"></a>00795 <span class="comment">// The text is returned in text_out. Returns false on error.</span>
<a name="l00796"></a><a class="code" href="group___advanced_a_p_i.html#ga09be3b61fd89f7803fe37cc420b92b30">00796</a> <span class="keywordtype">bool</span> <a class="code" href="group___advanced_a_p_i.html#ga09be3b61fd89f7803fe37cc420b92b30">TessBaseAPI::ProcessPage</a>(Pix* pix, <span class="keywordtype">int</span> page_index, <span class="keyword">const</span> <span class="keywordtype">char</span>* filename,
<a name="l00797"></a>00797                               <span class="keyword">const</span> <span class="keywordtype">char</span>* retry_config, <span class="keywordtype">int</span> timeout_millisec,
<a name="l00798"></a>00798                               <a class="code" href="class_s_t_r_i_n_g.html">STRING</a>* text_out) {
<a name="l00799"></a>00799   <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a896312e68d246b58e704a8f5576e6917">SetInputName</a>(filename);
<a name="l00800"></a>00800   <a class="code" href="group___advanced_a_p_i.html#gaa463622111f3b11d8fca5863709cc699">SetImage</a>(pix);
<a name="l00801"></a>00801   <span class="keywordtype">bool</span> failed = <span class="keyword">false</span>;
<a name="l00802"></a>00802   <span class="keywordflow">if</span> (timeout_millisec &gt; 0) {
<a name="l00803"></a>00803     <span class="comment">// Running with a timeout.</span>
<a name="l00804"></a>00804     <a class="code" href="class_e_t_e_x_t___d_e_s_c.html">ETEXT_DESC</a> monitor;
<a name="l00805"></a>00805     monitor.<a class="code" href="class_e_t_e_x_t___d_e_s_c.html#afcea4319ceed9b37f3c43eec9ec5d55a">cancel</a> = <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00806"></a>00806     monitor.<a class="code" href="class_e_t_e_x_t___d_e_s_c.html#a4844a3e9868a0fde7ad2fcaa37f5c5f1">cancel_this</a> = <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00807"></a>00807     monitor.<a class="code" href="class_e_t_e_x_t___d_e_s_c.html#acbbc24327ecc909b78274d339c27236e">set_deadline_msecs</a>(timeout_millisec);
<a name="l00808"></a>00808     <span class="comment">// Now run the main recognition.</span>
<a name="l00809"></a>00809     failed = <a class="code" href="group___advanced_a_p_i.html#ga0e4065c20b142d69a2324ee0c74ae0b0">Recognize</a>(&amp;monitor) &lt; 0;
<a name="l00810"></a>00810   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#a053d30f2b3df317e0d12e4a64f10d831">tessedit_pageseg_mode</a> == <a class="code" href="namespacetesseract.html#a338d4c8b5d497b5ec3e6e4269d8ac66aa319d6168eaa4b2002ac84c0558ba947d" title="Orientation and script detection only.">PSM_OSD_ONLY</a> ||
<a name="l00811"></a>00811              <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#a053d30f2b3df317e0d12e4a64f10d831">tessedit_pageseg_mode</a> == <a class="code" href="namespacetesseract.html#a338d4c8b5d497b5ec3e6e4269d8ac66aa6c70374f53473ba410723e32b12f3f01" title="Automatic page segmentation, but no OSD, or OCR.">PSM_AUTO_ONLY</a>) {
<a name="l00812"></a>00812     <span class="comment">// Disabled character recognition.</span>
<a name="l00813"></a>00813     <a class="code" href="classtesseract_1_1_page_iterator.html">PageIterator</a>* it = <a class="code" href="group___advanced_a_p_i.html#gaaac2abf8505c89afb8466dc3cff2c666">AnalyseLayout</a>();
<a name="l00814"></a>00814     <span class="keywordflow">if</span> (it == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l00815"></a>00815       failed = <span class="keyword">true</span>;
<a name="l00816"></a>00816     } <span class="keywordflow">else</span> {
<a name="l00817"></a>00817       <span class="keyword">delete</span> it;
<a name="l00818"></a>00818       <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00819"></a>00819     }
<a name="l00820"></a>00820   } <span class="keywordflow">else</span> {
<a name="l00821"></a>00821     <span class="comment">// Normal layout and character recognition with no timeout.</span>
<a name="l00822"></a>00822     failed = <a class="code" href="group___advanced_a_p_i.html#ga0e4065c20b142d69a2324ee0c74ae0b0">Recognize</a>(<a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) &lt; 0;
<a name="l00823"></a>00823   }
<a name="l00824"></a>00824   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#ab0c56686c9d207a42e67ba1f8c31a00b">tessedit_write_images</a>) {
<a name="l00825"></a>00825     Pix* page_pix = <a class="code" href="group___advanced_a_p_i.html#gaee19c9ea78a647420bbe99a447569995">GetThresholdedImage</a>();
<a name="l00826"></a>00826     pixWrite(<span class="stringliteral">&quot;tessinput.tif&quot;</span>, page_pix, IFF_TIFF_G4);
<a name="l00827"></a>00827   }
<a name="l00828"></a>00828   <span class="keywordflow">if</span> (failed &amp;&amp; retry_config != <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; retry_config[0] != <span class="charliteral">&#39;\0&#39;</span>) {
<a name="l00829"></a>00829     <span class="comment">// Save current config variables before switching modes.</span>
<a name="l00830"></a>00830     FILE* fp = fopen(<a class="code" href="namespacetesseract.html#a46ecbfaef9e549b16cd97fee9d4614d2">kOldVarsFile</a>, <span class="stringliteral">&quot;wb&quot;</span>);
<a name="l00831"></a>00831     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#aa00be783b6ce3c3178fc86afdf1cba7d">PrintVariables</a>(fp);
<a name="l00832"></a>00832     fclose(fp);
<a name="l00833"></a>00833     <span class="comment">// Switch to alternate mode for retry.</span>
<a name="l00834"></a>00834     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ab3bd61f8ccb7c4e1c41801ea708d2181">ReadConfigFile</a>(retry_config);
<a name="l00835"></a>00835     <a class="code" href="group___advanced_a_p_i.html#gaa463622111f3b11d8fca5863709cc699">SetImage</a>(pix);
<a name="l00836"></a>00836     <a class="code" href="group___advanced_a_p_i.html#ga0e4065c20b142d69a2324ee0c74ae0b0">Recognize</a>(<a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00837"></a>00837     <span class="comment">// Restore saved config variables.</span>
<a name="l00838"></a>00838     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ab3bd61f8ccb7c4e1c41801ea708d2181">ReadConfigFile</a>(<a class="code" href="namespacetesseract.html#a46ecbfaef9e549b16cd97fee9d4614d2">kOldVarsFile</a>);
<a name="l00839"></a>00839   }
<a name="l00840"></a>00840   <span class="comment">// Get text only if successful.</span>
<a name="l00841"></a>00841   <span class="keywordflow">if</span> (!failed) {
<a name="l00842"></a>00842     <span class="keywordtype">char</span>* text;
<a name="l00843"></a>00843     <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#a83f5ef8e7e6410b8a5c1220f96c7f244">tessedit_create_boxfile</a> ||
<a name="l00844"></a>00844         <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#ab079fbbd71433f3de894f912e5b11e6d">tessedit_make_boxes_from_boxes</a>) {
<a name="l00845"></a>00845       text = <a class="code" href="group___advanced_a_p_i.html#gaadda8cd6abe770d2f6a70a18329b1973">GetBoxText</a>(page_index);
<a name="l00846"></a>00846     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#a86c6f34b0388d11a0c63cd468947a4ad">tessedit_write_unlv</a>) {
<a name="l00847"></a>00847       text = <a class="code" href="group___advanced_a_p_i.html#ga173b4289191b6c2faf2a4a4b7c94affc">GetUNLVText</a>();
<a name="l00848"></a>00848     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#a843cff0b614a5a71e5a00302011c811c">tessedit_create_hocr</a>) {
<a name="l00849"></a>00849       text = <a class="code" href="group___advanced_a_p_i.html#ga655f906bbf64dcd6f33ce633ecce997d">GetHOCRText</a>(page_index);
<a name="l00850"></a>00850     } <span class="keywordflow">else</span> {
<a name="l00851"></a>00851       text = <a class="code" href="group___advanced_a_p_i.html#ga115ef656f83352ba608b4f0bf9cfa2c4">GetUTF8Text</a>();
<a name="l00852"></a>00852     }
<a name="l00853"></a>00853     *text_out += text;
<a name="l00854"></a>00854     <span class="keyword">delete</span> [] text;
<a name="l00855"></a>00855     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00856"></a>00856   }
<a name="l00857"></a>00857   <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00858"></a>00858 }
<a name="l00859"></a>00859 
<a name="l00860"></a>00860 <span class="comment">// Get a left-to-right iterator to the results of LayoutAnalysis and/or</span>
<a name="l00861"></a>00861 <span class="comment">// Recognize. The returned iterator must be deleted after use.</span>
<a name="l00862"></a><a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ad7a9b7f45f94801d7891035bf38d4861">00862</a> <a class="code" href="classtesseract_1_1_l_t_r_result_iterator.html">LTRResultIterator</a>* <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ad7a9b7f45f94801d7891035bf38d4861">TessBaseAPI::GetLTRIterator</a>() {
<a name="l00863"></a>00863   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a> == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a12dda612630eba40e15f9d0b9955a04c" title="The page-level data.">page_res_</a> == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00864"></a>00864     <span class="keywordflow">return</span> <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00865"></a>00865   <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classtesseract_1_1_l_t_r_result_iterator.html">LTRResultIterator</a>(
<a name="l00866"></a>00866       <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a12dda612630eba40e15f9d0b9955a04c" title="The page-level data.">page_res_</a>, <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>,
<a name="l00867"></a>00867       <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a9d93e1d92ca230ae02b81d44bc88a55c" title="Image thresholding module.">thresholder_</a>-&gt;<a class="code" href="classtesseract_1_1_image_thresholder.html#a7d8c733e8624ebc10e74ec2afd517398">GetScaleFactor</a>(), <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a9d93e1d92ca230ae02b81d44bc88a55c" title="Image thresholding module.">thresholder_</a>-&gt;<a class="code" href="classtesseract_1_1_image_thresholder.html#a2fb94a4d1697c06bff68e33269297c59">GetScaledYResolution</a>(),
<a name="l00868"></a>00868       <a class="code" href="group___thresholder_params.html#gab3c90d43a3628dc7abeb93e9ca01bc97">rect_left_</a>, <a class="code" href="group___thresholder_params.html#gac71648cd860510ca65b94d87d7d9bb1f">rect_top_</a>, <a class="code" href="group___thresholder_params.html#ga31dbaec91a5dd8ee7d399786a4bd5ef8">rect_width_</a>, <a class="code" href="group___thresholder_params.html#ga978edc537da096ec07d4bb8e4ae5332d">rect_height_</a>);
<a name="l00869"></a>00869 }
<a name="l00870"></a>00870 
<a name="l00871"></a>00871 <span class="comment">// Get a reading-order iterator to the results of LayoutAnalysis and/or</span>
<a name="l00872"></a>00872 <span class="comment">// Recognize. The returned iterator must be deleted after use.</span>
<a name="l00873"></a>00873 <span class="comment">// WARNING! This class points to data held within the TessBaseAPI class, and</span>
<a name="l00874"></a>00874 <span class="comment">// therefore can only be used while the TessBaseAPI class still exists and</span>
<a name="l00875"></a>00875 <span class="comment">// has not been subjected to a call of Init, SetImage, Recognize, Clear, End</span>
<a name="l00876"></a>00876 <span class="comment">// DetectOS, or anything else that changes the internal PAGE_RES.</span>
<a name="l00877"></a><a class="code" href="group___advanced_a_p_i.html#ga52eee8b9a4f147c26e4b64c16b46bc04">00877</a> <a class="code" href="classtesseract_1_1_result_iterator.html">ResultIterator</a>* <a class="code" href="group___advanced_a_p_i.html#ga52eee8b9a4f147c26e4b64c16b46bc04">TessBaseAPI::GetIterator</a>() {
<a name="l00878"></a>00878   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a> == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a12dda612630eba40e15f9d0b9955a04c" title="The page-level data.">page_res_</a> == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00879"></a>00879     <span class="keywordflow">return</span> <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00880"></a>00880   <span class="keywordflow">return</span> <a class="code" href="classtesseract_1_1_result_iterator.html#a961e7ee57edae85e855332a301cccacf">ResultIterator::StartOfParagraph</a>(<a class="code" href="classtesseract_1_1_l_t_r_result_iterator.html">LTRResultIterator</a>(
<a name="l00881"></a>00881       <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a12dda612630eba40e15f9d0b9955a04c" title="The page-level data.">page_res_</a>, <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>,
<a name="l00882"></a>00882       <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a9d93e1d92ca230ae02b81d44bc88a55c" title="Image thresholding module.">thresholder_</a>-&gt;<a class="code" href="classtesseract_1_1_image_thresholder.html#a7d8c733e8624ebc10e74ec2afd517398">GetScaleFactor</a>(), <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a9d93e1d92ca230ae02b81d44bc88a55c" title="Image thresholding module.">thresholder_</a>-&gt;<a class="code" href="classtesseract_1_1_image_thresholder.html#a2fb94a4d1697c06bff68e33269297c59">GetScaledYResolution</a>(),
<a name="l00883"></a>00883       <a class="code" href="group___thresholder_params.html#gab3c90d43a3628dc7abeb93e9ca01bc97">rect_left_</a>, <a class="code" href="group___thresholder_params.html#gac71648cd860510ca65b94d87d7d9bb1f">rect_top_</a>, <a class="code" href="group___thresholder_params.html#ga31dbaec91a5dd8ee7d399786a4bd5ef8">rect_width_</a>, <a class="code" href="group___thresholder_params.html#ga978edc537da096ec07d4bb8e4ae5332d">rect_height_</a>));
<a name="l00884"></a>00884 }
<a name="l00885"></a>00885 
<a name="l00886"></a>00886 <span class="comment">// Get a mutable iterator to the results of LayoutAnalysis and/or Recognize.</span>
<a name="l00887"></a>00887 <span class="comment">// The returned iterator must be deleted after use.</span>
<a name="l00888"></a>00888 <span class="comment">// WARNING! This class points to data held within the TessBaseAPI class, and</span>
<a name="l00889"></a>00889 <span class="comment">// therefore can only be used while the TessBaseAPI class still exists and</span>
<a name="l00890"></a>00890 <span class="comment">// has not been subjected to a call of Init, SetImage, Recognize, Clear, End</span>
<a name="l00891"></a>00891 <span class="comment">// DetectOS, or anything else that changes the internal PAGE_RES.</span>
<a name="l00892"></a><a class="code" href="group___advanced_a_p_i.html#ga29906219f78adc7fd76a83bde37e09eb">00892</a> <a class="code" href="classtesseract_1_1_mutable_iterator.html">MutableIterator</a>* <a class="code" href="group___advanced_a_p_i.html#ga29906219f78adc7fd76a83bde37e09eb">TessBaseAPI::GetMutableIterator</a>() {
<a name="l00893"></a>00893   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a> == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a12dda612630eba40e15f9d0b9955a04c" title="The page-level data.">page_res_</a> == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00894"></a>00894     <span class="keywordflow">return</span> <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00895"></a>00895   <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classtesseract_1_1_mutable_iterator.html">MutableIterator</a>(<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a12dda612630eba40e15f9d0b9955a04c" title="The page-level data.">page_res_</a>, <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>,
<a name="l00896"></a>00896                              <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a9d93e1d92ca230ae02b81d44bc88a55c" title="Image thresholding module.">thresholder_</a>-&gt;<a class="code" href="classtesseract_1_1_image_thresholder.html#a7d8c733e8624ebc10e74ec2afd517398">GetScaleFactor</a>(),
<a name="l00897"></a>00897                              <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a9d93e1d92ca230ae02b81d44bc88a55c" title="Image thresholding module.">thresholder_</a>-&gt;<a class="code" href="classtesseract_1_1_image_thresholder.html#a2fb94a4d1697c06bff68e33269297c59">GetScaledYResolution</a>(),
<a name="l00898"></a>00898                              <a class="code" href="group___thresholder_params.html#gab3c90d43a3628dc7abeb93e9ca01bc97">rect_left_</a>, <a class="code" href="group___thresholder_params.html#gac71648cd860510ca65b94d87d7d9bb1f">rect_top_</a>, <a class="code" href="group___thresholder_params.html#ga31dbaec91a5dd8ee7d399786a4bd5ef8">rect_width_</a>, <a class="code" href="group___thresholder_params.html#ga978edc537da096ec07d4bb8e4ae5332d">rect_height_</a>);
<a name="l00899"></a>00899 }
<a name="l00900"></a>00900 
<a name="l00901"></a>00901 <span class="comment">// Make a text string from the internal data structures.</span>
<a name="l00902"></a><a class="code" href="group___advanced_a_p_i.html#ga115ef656f83352ba608b4f0bf9cfa2c4">00902</a> <span class="keywordtype">char</span>* <a class="code" href="group___advanced_a_p_i.html#ga115ef656f83352ba608b4f0bf9cfa2c4">TessBaseAPI::GetUTF8Text</a>() {
<a name="l00903"></a>00903   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a> == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> ||
<a name="l00904"></a>00904       (!<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a7d4627f300b1096d43a3e7d54d8aa5df" title="page_res_ contains recognition data.">recognition_done_</a> &amp;&amp; <a class="code" href="group___advanced_a_p_i.html#ga0e4065c20b142d69a2324ee0c74ae0b0">Recognize</a>(<a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) &lt; 0))
<a name="l00905"></a>00905     <span class="keywordflow">return</span> <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00906"></a>00906   <a class="code" href="class_s_t_r_i_n_g.html">STRING</a> text(<span class="stringliteral">&quot;&quot;</span>);
<a name="l00907"></a>00907   <a class="code" href="classtesseract_1_1_result_iterator.html">ResultIterator</a> *it = <a class="code" href="group___advanced_a_p_i.html#ga52eee8b9a4f147c26e4b64c16b46bc04">GetIterator</a>();
<a name="l00908"></a>00908   <span class="keywordflow">do</span> {
<a name="l00909"></a>00909     <span class="keywordflow">if</span> (it-&gt;<a class="code" href="classtesseract_1_1_page_iterator.html#ae1d2f1725fabeafb6e235ccb482d47d6">Empty</a>(<a class="code" href="namespacetesseract.html#aa26c22b65cc9765a0e747120f4287fd7a3e63980691bf64801c704f59bd795bd9">RIL_PARA</a>)) <span class="keywordflow">continue</span>;
<a name="l00910"></a>00910     <span class="keywordtype">char</span> *para_text = it-&gt;<a class="code" href="classtesseract_1_1_result_iterator.html#a7a35dd667c73efeeaf7457df90c6199a">GetUTF8Text</a>(<a class="code" href="namespacetesseract.html#aa26c22b65cc9765a0e747120f4287fd7a3e63980691bf64801c704f59bd795bd9">RIL_PARA</a>);
<a name="l00911"></a>00911     text += para_text;
<a name="l00912"></a>00912     <span class="keyword">delete</span> []para_text;
<a name="l00913"></a>00913   } <span class="keywordflow">while</span> (it-&gt;<a class="code" href="classtesseract_1_1_result_iterator.html#abd8987e2387f1945b53cf23f99b663e1">Next</a>(<a class="code" href="namespacetesseract.html#aa26c22b65cc9765a0e747120f4287fd7a3e63980691bf64801c704f59bd795bd9">RIL_PARA</a>));
<a name="l00914"></a>00914   <span class="keywordtype">char</span>* result = <span class="keyword">new</span> <span class="keywordtype">char</span>[text.<a class="code" href="class_s_t_r_i_n_g.html#a168505a533eda60219c93e25adf4cdc5">length</a>() + 1];
<a name="l00915"></a>00915   strncpy(result, text.<a class="code" href="class_s_t_r_i_n_g.html#a32beee43ecab1bed8bebc3466896ad6e">string</a>(), text.<a class="code" href="class_s_t_r_i_n_g.html#a168505a533eda60219c93e25adf4cdc5">length</a>() + 1);
<a name="l00916"></a>00916   <span class="keyword">delete</span> it;
<a name="l00917"></a>00917   <span class="keywordflow">return</span> result;
<a name="l00918"></a>00918 }
<a name="l00919"></a>00919 
<a name="l00920"></a>00920 <span class="keyword">static</span> <span class="keywordtype">void</span> AddBoxTohOCR(<span class="keyword">const</span> <a class="code" href="classtesseract_1_1_page_iterator.html">PageIterator</a> *it,
<a name="l00921"></a>00921                          <a class="code" href="namespacetesseract.html#aa26c22b65cc9765a0e747120f4287fd7">PageIteratorLevel</a> level,
<a name="l00922"></a>00922                          <a class="code" href="class_s_t_r_i_n_g.html">STRING</a>* hocr_str) {
<a name="l00923"></a>00923   <span class="keywordtype">int</span> left, top, right, bottom;
<a name="l00924"></a>00924   it-&gt;<a class="code" href="classtesseract_1_1_page_iterator.html#a38f6d7da2a9b9ef8983286383729fa73">BoundingBox</a>(level, &amp;left, &amp;top, &amp;right, &amp;bottom);
<a name="l00925"></a>00925   hocr_str-&gt;<a class="code" href="class_s_t_r_i_n_g.html#a779cd637dd42d58d5500a3a657077e84">add_str_int</a>(<span class="stringliteral">&quot;&#39; title=\&quot;bbox &quot;</span>, left);
<a name="l00926"></a>00926   hocr_str-&gt;<a class="code" href="class_s_t_r_i_n_g.html#a779cd637dd42d58d5500a3a657077e84">add_str_int</a>(<span class="stringliteral">&quot; &quot;</span>, top);
<a name="l00927"></a>00927   hocr_str-&gt;<a class="code" href="class_s_t_r_i_n_g.html#a779cd637dd42d58d5500a3a657077e84">add_str_int</a>(<span class="stringliteral">&quot; &quot;</span>, right);
<a name="l00928"></a>00928   hocr_str-&gt;<a class="code" href="class_s_t_r_i_n_g.html#a779cd637dd42d58d5500a3a657077e84">add_str_int</a>(<span class="stringliteral">&quot; &quot;</span>, bottom);
<a name="l00929"></a>00929   *hocr_str += <span class="stringliteral">&quot;\&quot;&gt;&quot;</span>;
<a name="l00930"></a>00930 }
<a name="l00931"></a>00931 
<a name="l00932"></a>00932 <span class="comment">// Make a HTML-formatted string with hOCR markup from the internal</span>
<a name="l00933"></a>00933 <span class="comment">// data structures.</span>
<a name="l00934"></a>00934 <span class="comment">// page_number is 0-based but will appear in the output as 1-based.</span>
<a name="l00935"></a>00935 <span class="comment">// Image name/input_file_ can be set by SetInputName before calling</span>
<a name="l00936"></a>00936 <span class="comment">// GetHOCRText</span>
<a name="l00937"></a>00937 <span class="comment">// STL removed from original patch submission and refactored by rays.</span>
<a name="l00938"></a><a class="code" href="group___advanced_a_p_i.html#ga655f906bbf64dcd6f33ce633ecce997d">00938</a> <span class="keywordtype">char</span>* <a class="code" href="group___advanced_a_p_i.html#ga655f906bbf64dcd6f33ce633ecce997d">TessBaseAPI::GetHOCRText</a>(<span class="keywordtype">int</span> page_number) {
<a name="l00939"></a>00939   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a> == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> ||
<a name="l00940"></a>00940       (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a12dda612630eba40e15f9d0b9955a04c" title="The page-level data.">page_res_</a> == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; <a class="code" href="group___advanced_a_p_i.html#ga0e4065c20b142d69a2324ee0c74ae0b0">Recognize</a>(<a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) &lt; 0))
<a name="l00941"></a>00941     <span class="keywordflow">return</span> <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00942"></a>00942 
<a name="l00943"></a>00943   <span class="keywordtype">int</span> lcnt = 1, bcnt = 1, pcnt = 1, wcnt = 1;
<a name="l00944"></a>00944   <span class="keywordtype">int</span> page_id = page_number + 1;  <span class="comment">// hOCR uses 1-based page numbers.</span>
<a name="l00945"></a>00945 
<a name="l00946"></a>00946   <a class="code" href="class_s_t_r_i_n_g.html">STRING</a> hocr_str(<span class="stringliteral">&quot;&quot;</span>);
<a name="l00947"></a>00947 
<a name="l00948"></a>00948   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a4690919aa9d4eabda36bdefdaadf7ac9" title="Name used by training code.">input_file_</a> == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00949"></a>00949       <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a896312e68d246b58e704a8f5576e6917">SetInputName</a>(<a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00950"></a>00950 
<a name="l00951"></a>00951   hocr_str.<a class="code" href="class_s_t_r_i_n_g.html#a779cd637dd42d58d5500a3a657077e84">add_str_int</a>(<span class="stringliteral">&quot;&lt;div class=&#39;ocr_page&#39; id=&#39;page_&quot;</span>, page_id);
<a name="l00952"></a>00952   hocr_str += <span class="stringliteral">&quot;&#39; title=&#39;image \&quot;&quot;</span>;
<a name="l00953"></a>00953   hocr_str += <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a4690919aa9d4eabda36bdefdaadf7ac9" title="Name used by training code.">input_file_</a> ? *<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a4690919aa9d4eabda36bdefdaadf7ac9" title="Name used by training code.">input_file_</a> : <span class="stringliteral">&quot;unknown&quot;</span>;
<a name="l00954"></a>00954   hocr_str.<a class="code" href="class_s_t_r_i_n_g.html#a779cd637dd42d58d5500a3a657077e84">add_str_int</a>(<span class="stringliteral">&quot;\&quot;; bbox &quot;</span>, <a class="code" href="group___thresholder_params.html#gab3c90d43a3628dc7abeb93e9ca01bc97">rect_left_</a>);
<a name="l00955"></a>00955   hocr_str.<a class="code" href="class_s_t_r_i_n_g.html#a779cd637dd42d58d5500a3a657077e84">add_str_int</a>(<span class="stringliteral">&quot; &quot;</span>, <a class="code" href="group___thresholder_params.html#gac71648cd860510ca65b94d87d7d9bb1f">rect_top_</a>);
<a name="l00956"></a>00956   hocr_str.<a class="code" href="class_s_t_r_i_n_g.html#a779cd637dd42d58d5500a3a657077e84">add_str_int</a>(<span class="stringliteral">&quot; &quot;</span>, <a class="code" href="group___thresholder_params.html#ga31dbaec91a5dd8ee7d399786a4bd5ef8">rect_width_</a>);
<a name="l00957"></a>00957   hocr_str.<a class="code" href="class_s_t_r_i_n_g.html#a779cd637dd42d58d5500a3a657077e84">add_str_int</a>(<span class="stringliteral">&quot; &quot;</span>, <a class="code" href="group___thresholder_params.html#ga978edc537da096ec07d4bb8e4ae5332d">rect_height_</a>);
<a name="l00958"></a>00958   hocr_str += <span class="stringliteral">&quot;&#39;&gt;\n&quot;</span>;
<a name="l00959"></a>00959 
<a name="l00960"></a>00960   <a class="code" href="classtesseract_1_1_result_iterator.html">ResultIterator</a> *res_it = <a class="code" href="group___advanced_a_p_i.html#ga52eee8b9a4f147c26e4b64c16b46bc04">GetIterator</a>();
<a name="l00961"></a>00961   <span class="keywordflow">for</span> (; !res_it-&gt;<a class="code" href="classtesseract_1_1_page_iterator.html#ae1d2f1725fabeafb6e235ccb482d47d6">Empty</a>(<a class="code" href="namespacetesseract.html#aa26c22b65cc9765a0e747120f4287fd7a2dcea8d4208c16055353029d26f9bf49">RIL_BLOCK</a>); wcnt++) {
<a name="l00962"></a>00962     <span class="keywordflow">if</span> (res_it-&gt;<a class="code" href="classtesseract_1_1_page_iterator.html#ae1d2f1725fabeafb6e235ccb482d47d6">Empty</a>(<a class="code" href="namespacetesseract.html#aa26c22b65cc9765a0e747120f4287fd7afd466aec253e5daa6f0c112b0f0e0610">RIL_WORD</a>)) {
<a name="l00963"></a>00963       res_it-&gt;<a class="code" href="classtesseract_1_1_result_iterator.html#abd8987e2387f1945b53cf23f99b663e1">Next</a>(<a class="code" href="namespacetesseract.html#aa26c22b65cc9765a0e747120f4287fd7afd466aec253e5daa6f0c112b0f0e0610">RIL_WORD</a>);
<a name="l00964"></a>00964       <span class="keywordflow">continue</span>;
<a name="l00965"></a>00965     }
<a name="l00966"></a>00966 
<a name="l00967"></a>00967     <span class="comment">// Open any new block/paragraph/textline.</span>
<a name="l00968"></a>00968     <span class="keywordflow">if</span> (res_it-&gt;<a class="code" href="classtesseract_1_1_result_iterator.html#a983b601204f2fee0428213c4fca779e1">IsAtBeginningOf</a>(<a class="code" href="namespacetesseract.html#aa26c22b65cc9765a0e747120f4287fd7a2dcea8d4208c16055353029d26f9bf49">RIL_BLOCK</a>)) {
<a name="l00969"></a>00969       hocr_str.<a class="code" href="class_s_t_r_i_n_g.html#a779cd637dd42d58d5500a3a657077e84">add_str_int</a>(<span class="stringliteral">&quot;&lt;div class=&#39;ocr_carea&#39; id=&#39;block_&quot;</span>, bcnt);
<a name="l00970"></a>00970       hocr_str.<a class="code" href="class_s_t_r_i_n_g.html#a779cd637dd42d58d5500a3a657077e84">add_str_int</a>(<span class="stringliteral">&quot;_&quot;</span>, bcnt);
<a name="l00971"></a>00971       AddBoxTohOCR(res_it, <a class="code" href="namespacetesseract.html#aa26c22b65cc9765a0e747120f4287fd7a2dcea8d4208c16055353029d26f9bf49">RIL_BLOCK</a>, &amp;hocr_str);
<a name="l00972"></a>00972     }
<a name="l00973"></a>00973     <span class="keywordflow">if</span> (res_it-&gt;<a class="code" href="classtesseract_1_1_result_iterator.html#a983b601204f2fee0428213c4fca779e1">IsAtBeginningOf</a>(<a class="code" href="namespacetesseract.html#aa26c22b65cc9765a0e747120f4287fd7a3e63980691bf64801c704f59bd795bd9">RIL_PARA</a>)) {
<a name="l00974"></a>00974       <span class="keywordflow">if</span> (res_it-&gt;<a class="code" href="classtesseract_1_1_result_iterator.html#a71525d396c6cdeea89f576adca599474">ParagraphIsLtr</a>()) {
<a name="l00975"></a>00975         hocr_str.<a class="code" href="class_s_t_r_i_n_g.html#a779cd637dd42d58d5500a3a657077e84">add_str_int</a>(<span class="stringliteral">&quot;\n&lt;p class=&#39;ocr_par&#39; dir=&#39;ltr&#39; id=&#39;par_&quot;</span>, pcnt);
<a name="l00976"></a>00976       } <span class="keywordflow">else</span> {
<a name="l00977"></a>00977         hocr_str.<a class="code" href="class_s_t_r_i_n_g.html#a779cd637dd42d58d5500a3a657077e84">add_str_int</a>(<span class="stringliteral">&quot;\n&lt;p class=&#39;ocr_par&#39; dir=&#39;rtl&#39; id=&#39;par_&quot;</span>, pcnt);
<a name="l00978"></a>00978       }
<a name="l00979"></a>00979       AddBoxTohOCR(res_it, <a class="code" href="namespacetesseract.html#aa26c22b65cc9765a0e747120f4287fd7a3e63980691bf64801c704f59bd795bd9">RIL_PARA</a>, &amp;hocr_str);
<a name="l00980"></a>00980     }
<a name="l00981"></a>00981     <span class="keywordflow">if</span> (res_it-&gt;<a class="code" href="classtesseract_1_1_result_iterator.html#a983b601204f2fee0428213c4fca779e1">IsAtBeginningOf</a>(<a class="code" href="namespacetesseract.html#aa26c22b65cc9765a0e747120f4287fd7a5e87a35f16de644593c353159ede11d1">RIL_TEXTLINE</a>)) {
<a name="l00982"></a>00982       hocr_str.<a class="code" href="class_s_t_r_i_n_g.html#a779cd637dd42d58d5500a3a657077e84">add_str_int</a>(<span class="stringliteral">&quot;&lt;span class=&#39;ocr_line&#39; id=&#39;line_&quot;</span>, lcnt);
<a name="l00983"></a>00983       AddBoxTohOCR(res_it, <a class="code" href="namespacetesseract.html#aa26c22b65cc9765a0e747120f4287fd7a5e87a35f16de644593c353159ede11d1">RIL_TEXTLINE</a>, &amp;hocr_str);
<a name="l00984"></a>00984     }
<a name="l00985"></a>00985 
<a name="l00986"></a>00986     <span class="comment">// Now, process the word...</span>
<a name="l00987"></a>00987     hocr_str.<a class="code" href="class_s_t_r_i_n_g.html#a779cd637dd42d58d5500a3a657077e84">add_str_int</a>(<span class="stringliteral">&quot;&lt;span class=&#39;ocr_word&#39; id=&#39;word_&quot;</span>, wcnt);
<a name="l00988"></a>00988     AddBoxTohOCR(res_it, <a class="code" href="namespacetesseract.html#aa26c22b65cc9765a0e747120f4287fd7afd466aec253e5daa6f0c112b0f0e0610">RIL_WORD</a>, &amp;hocr_str);
<a name="l00989"></a>00989     <span class="keyword">const</span> <span class="keywordtype">char</span> *font_name;
<a name="l00990"></a>00990     <span class="keywordtype">bool</span> bold, italic, underlined, monospace, serif, smallcaps;
<a name="l00991"></a>00991     <span class="keywordtype">int</span> pointsize, font_id;
<a name="l00992"></a>00992     font_name = res_it-&gt;<a class="code" href="classtesseract_1_1_l_t_r_result_iterator.html#ad38e4b44797617e01ad4aab01765720e">WordFontAttributes</a>(&amp;bold, &amp;italic, &amp;underlined,
<a name="l00993"></a>00993                                            &amp;monospace, &amp;serif, &amp;smallcaps,
<a name="l00994"></a>00994                                            &amp;pointsize, &amp;font_id);
<a name="l00995"></a>00995     <span class="keywordtype">bool</span> last_word_in_line = res_it-&gt;<a class="code" href="classtesseract_1_1_result_iterator.html#a4ba47a7d01d3bc7f0fbf777605f8297d">IsAtFinalElement</a>(<a class="code" href="namespacetesseract.html#aa26c22b65cc9765a0e747120f4287fd7a5e87a35f16de644593c353159ede11d1">RIL_TEXTLINE</a>, <a class="code" href="namespacetesseract.html#aa26c22b65cc9765a0e747120f4287fd7afd466aec253e5daa6f0c112b0f0e0610">RIL_WORD</a>);
<a name="l00996"></a>00996     <span class="keywordtype">bool</span> last_word_in_para = res_it-&gt;<a class="code" href="classtesseract_1_1_result_iterator.html#a4ba47a7d01d3bc7f0fbf777605f8297d">IsAtFinalElement</a>(<a class="code" href="namespacetesseract.html#aa26c22b65cc9765a0e747120f4287fd7a3e63980691bf64801c704f59bd795bd9">RIL_PARA</a>, <a class="code" href="namespacetesseract.html#aa26c22b65cc9765a0e747120f4287fd7afd466aec253e5daa6f0c112b0f0e0610">RIL_WORD</a>);
<a name="l00997"></a>00997     <span class="keywordtype">bool</span> last_word_in_block = res_it-&gt;<a class="code" href="classtesseract_1_1_result_iterator.html#a4ba47a7d01d3bc7f0fbf777605f8297d">IsAtFinalElement</a>(<a class="code" href="namespacetesseract.html#aa26c22b65cc9765a0e747120f4287fd7a2dcea8d4208c16055353029d26f9bf49">RIL_BLOCK</a>, <a class="code" href="namespacetesseract.html#aa26c22b65cc9765a0e747120f4287fd7afd466aec253e5daa6f0c112b0f0e0610">RIL_WORD</a>);
<a name="l00998"></a>00998     <span class="keywordflow">if</span> (bold) hocr_str += <span class="stringliteral">&quot;&lt;strong&gt;&quot;</span>;
<a name="l00999"></a>00999     <span class="keywordflow">if</span> (italic) hocr_str += <span class="stringliteral">&quot;&lt;em&gt;&quot;</span>;
<a name="l01000"></a>01000     <span class="keywordflow">do</span> {
<a name="l01001"></a>01001       <span class="keyword">const</span> <span class="keywordtype">char</span> *grapheme = res_it-&gt;<a class="code" href="classtesseract_1_1_result_iterator.html#a7a35dd667c73efeeaf7457df90c6199a">GetUTF8Text</a>(<a class="code" href="namespacetesseract.html#aa26c22b65cc9765a0e747120f4287fd7adbd62c7f34a9ebdd6e3b813a34cd812d">RIL_SYMBOL</a>);
<a name="l01002"></a>01002       <span class="keywordflow">if</span> (grapheme &amp;&amp; grapheme[0] != 0) {
<a name="l01003"></a>01003         <span class="keywordflow">if</span> (grapheme[1] == 0) {
<a name="l01004"></a>01004           <span class="keywordflow">switch</span> (grapheme[0]) {
<a name="l01005"></a>01005             <span class="keywordflow">case</span> <span class="charliteral">&#39;&lt;&#39;</span>: hocr_str += <span class="stringliteral">&quot;&amp;lt;&quot;</span>; <span class="keywordflow">break</span>;
<a name="l01006"></a>01006             <span class="keywordflow">case</span> <span class="charliteral">&#39;&gt;&#39;</span>: hocr_str += <span class="stringliteral">&quot;&amp;gt;&quot;</span>; <span class="keywordflow">break</span>;
<a name="l01007"></a>01007             <span class="keywordflow">case</span> <span class="charliteral">&#39;&amp;&#39;</span>: hocr_str += <span class="stringliteral">&quot;&amp;amp;&quot;</span>; <span class="keywordflow">break</span>;
<a name="l01008"></a>01008             <span class="keywordflow">case</span> <span class="charliteral">&#39;&quot;&#39;</span>: hocr_str += <span class="stringliteral">&quot;&amp;quot;&quot;</span>; <span class="keywordflow">break</span>;
<a name="l01009"></a>01009             <span class="keywordflow">case</span> <span class="charliteral">&#39;\&#39;&#39;</span>: hocr_str += <span class="stringliteral">&quot;&amp;#39;&quot;</span>; <span class="keywordflow">break</span>;
<a name="l01010"></a>01010             <span class="keywordflow">default</span>: hocr_str += grapheme;
<a name="l01011"></a>01011           }
<a name="l01012"></a>01012         } <span class="keywordflow">else</span> {
<a name="l01013"></a>01013           hocr_str += grapheme;
<a name="l01014"></a>01014         }
<a name="l01015"></a>01015       }
<a name="l01016"></a>01016       <span class="keyword">delete</span> []grapheme;
<a name="l01017"></a>01017       res_it-&gt;<a class="code" href="classtesseract_1_1_result_iterator.html#abd8987e2387f1945b53cf23f99b663e1">Next</a>(<a class="code" href="namespacetesseract.html#aa26c22b65cc9765a0e747120f4287fd7adbd62c7f34a9ebdd6e3b813a34cd812d">RIL_SYMBOL</a>);
<a name="l01018"></a>01018     } <span class="keywordflow">while</span> (!res_it-&gt;<a class="code" href="classtesseract_1_1_page_iterator.html#ae1d2f1725fabeafb6e235ccb482d47d6">Empty</a>(<a class="code" href="namespacetesseract.html#aa26c22b65cc9765a0e747120f4287fd7a2dcea8d4208c16055353029d26f9bf49">RIL_BLOCK</a>) &amp;&amp; !res_it-&gt;<a class="code" href="classtesseract_1_1_result_iterator.html#a983b601204f2fee0428213c4fca779e1">IsAtBeginningOf</a>(<a class="code" href="namespacetesseract.html#aa26c22b65cc9765a0e747120f4287fd7afd466aec253e5daa6f0c112b0f0e0610">RIL_WORD</a>));
<a name="l01019"></a>01019     <span class="keywordflow">if</span> (italic) hocr_str += <span class="stringliteral">&quot;&lt;/em&gt;&quot;</span>;
<a name="l01020"></a>01020     <span class="keywordflow">if</span> (bold) hocr_str += <span class="stringliteral">&quot;&lt;/strong&gt;&quot;</span>;
<a name="l01021"></a>01021     hocr_str += <span class="stringliteral">&quot;&lt;/span&gt; &quot;</span>;
<a name="l01022"></a>01022     wcnt++;
<a name="l01023"></a>01023     <span class="comment">// Close any ending block/paragraph/textline.</span>
<a name="l01024"></a>01024     <span class="keywordflow">if</span> (last_word_in_line) {
<a name="l01025"></a>01025       hocr_str += <span class="stringliteral">&quot;&lt;/span&gt;\n&quot;</span>;
<a name="l01026"></a>01026       lcnt++;
<a name="l01027"></a>01027     }
<a name="l01028"></a>01028     <span class="keywordflow">if</span> (last_word_in_para) {
<a name="l01029"></a>01029       hocr_str += <span class="stringliteral">&quot;&lt;/p&gt;\n&quot;</span>;
<a name="l01030"></a>01030       pcnt++;
<a name="l01031"></a>01031     }
<a name="l01032"></a>01032     <span class="keywordflow">if</span> (last_word_in_block) {
<a name="l01033"></a>01033       hocr_str += <span class="stringliteral">&quot;&lt;/div&gt;\n&quot;</span>;
<a name="l01034"></a>01034       bcnt++;
<a name="l01035"></a>01035     }
<a name="l01036"></a>01036   }
<a name="l01037"></a>01037   hocr_str += <span class="stringliteral">&quot;&lt;/div&gt;\n&quot;</span>;
<a name="l01038"></a>01038 
<a name="l01039"></a>01039   <span class="keywordtype">char</span> *ret = <span class="keyword">new</span> <span class="keywordtype">char</span>[hocr_str.<a class="code" href="class_s_t_r_i_n_g.html#a168505a533eda60219c93e25adf4cdc5">length</a>() + 1];
<a name="l01040"></a>01040   strcpy(ret, hocr_str.<a class="code" href="class_s_t_r_i_n_g.html#a32beee43ecab1bed8bebc3466896ad6e">string</a>());
<a name="l01041"></a>01041   <span class="keyword">delete</span> res_it;
<a name="l01042"></a>01042   <span class="keywordflow">return</span> ret;
<a name="l01043"></a>01043 }
<a name="l01044"></a>01044 
<a name="l01045"></a>01045 <span class="comment">// The 5 numbers output for each box (the usual 4 and a page number.)</span>
<a name="l01046"></a><a class="code" href="namespacetesseract.html#aa46d9454c58be9a34a7a91737d553900">01046</a> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="namespacetesseract.html#aa46d9454c58be9a34a7a91737d553900">kNumbersPerBlob</a> = 5;
<a name="l01047"></a>01047 <span class="comment">// The number of bytes taken by each number. Since we use inT16 for ICOORD,</span>
<a name="l01048"></a>01048 <span class="comment">// assume only 5 digits max.</span>
<a name="l01049"></a><a class="code" href="namespacetesseract.html#a929cce152875849d022496470235b437">01049</a> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="namespacetesseract.html#a929cce152875849d022496470235b437">kBytesPerNumber</a> = 5;
<a name="l01050"></a>01050 <span class="comment">// Multiplier for max expected textlength assumes (kBytesPerNumber + space)</span>
<a name="l01051"></a>01051 <span class="comment">// * kNumbersPerBlob plus the newline. Add to this the</span>
<a name="l01052"></a>01052 <span class="comment">// original UTF8 characters, and one kMaxBytesPerLine for safety.</span>
<a name="l01053"></a><a class="code" href="namespacetesseract.html#ada8c39277dfe2d8bd85135eaa66f9047">01053</a> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="namespacetesseract.html#ada8c39277dfe2d8bd85135eaa66f9047">kBytesPerBlob</a> = <a class="code" href="namespacetesseract.html#aa46d9454c58be9a34a7a91737d553900">kNumbersPerBlob</a> * (<a class="code" href="namespacetesseract.html#a929cce152875849d022496470235b437">kBytesPerNumber</a> + 1) + 1;
<a name="l01054"></a><a class="code" href="namespacetesseract.html#a294e870871cf3fb0928cbd5686346b3d">01054</a> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="namespacetesseract.html#a294e870871cf3fb0928cbd5686346b3d">kBytesPerBoxFileLine</a> = (<a class="code" href="namespacetesseract.html#a929cce152875849d022496470235b437">kBytesPerNumber</a> + 1) * <a class="code" href="namespacetesseract.html#aa46d9454c58be9a34a7a91737d553900">kNumbersPerBlob</a> + 1;
<a name="l01055"></a>01055 <span class="comment">// Max bytes in the decimal representation of inT64.</span>
<a name="l01056"></a><a class="code" href="namespacetesseract.html#a6007ea2fe11067865156fb804c36079e">01056</a> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="namespacetesseract.html#a6007ea2fe11067865156fb804c36079e">kBytesPer64BitNumber</a> = 20;
<a name="l01057"></a>01057 <span class="comment">// A maximal single box could occupy kNumbersPerBlob numbers at</span>
<a name="l01058"></a>01058 <span class="comment">// kBytesPer64BitNumber digits (if someone sneaks in a 64 bit value) and a</span>
<a name="l01059"></a>01059 <span class="comment">// space plus the newline and the maximum length of a UNICHAR.</span>
<a name="l01060"></a>01060 <span class="comment">// Test against this on each iteration for safety.</span>
<a name="l01061"></a><a class="code" href="namespacetesseract.html#a688dc51b653c642009af87c6d9b9dea2">01061</a> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="namespacetesseract.html#a688dc51b653c642009af87c6d9b9dea2">kMaxBytesPerLine</a> = <a class="code" href="namespacetesseract.html#aa46d9454c58be9a34a7a91737d553900">kNumbersPerBlob</a> * (<a class="code" href="namespacetesseract.html#a6007ea2fe11067865156fb804c36079e">kBytesPer64BitNumber</a> + 1) + 1 +
<a name="l01062"></a>01062     <a class="code" href="unichar_8h.html#a902bc40c9d89802bc063afe30ce9e708">UNICHAR_LEN</a>;
<a name="l01063"></a>01063 
<a name="l01064"></a>01064 <span class="comment">// The recognized text is returned as a char* which is coded</span>
<a name="l01065"></a>01065 <span class="comment">// as a UTF8 box file and must be freed with the delete [] operator.</span>
<a name="l01066"></a>01066 <span class="comment">// page_number is a 0-base page index that will appear in the box file.</span>
<a name="l01067"></a><a class="code" href="group___advanced_a_p_i.html#gaadda8cd6abe770d2f6a70a18329b1973">01067</a> <span class="keywordtype">char</span>* <a class="code" href="group___advanced_a_p_i.html#gaadda8cd6abe770d2f6a70a18329b1973">TessBaseAPI::GetBoxText</a>(<span class="keywordtype">int</span> page_number) {
<a name="l01068"></a>01068   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a> == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> ||
<a name="l01069"></a>01069       (!<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a7d4627f300b1096d43a3e7d54d8aa5df" title="page_res_ contains recognition data.">recognition_done_</a> &amp;&amp; <a class="code" href="group___advanced_a_p_i.html#ga0e4065c20b142d69a2324ee0c74ae0b0">Recognize</a>(<a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) &lt; 0))
<a name="l01070"></a>01070     <span class="keywordflow">return</span> <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01071"></a>01071   <span class="keywordtype">int</span> blob_count;
<a name="l01072"></a>01072   <span class="keywordtype">int</span> utf8_length = <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#aed3d481fc0c7dffad24572bd1f449598">TextLength</a>(&amp;blob_count);
<a name="l01073"></a>01073   <span class="keywordtype">int</span> total_length = blob_count * <a class="code" href="namespacetesseract.html#a294e870871cf3fb0928cbd5686346b3d">kBytesPerBoxFileLine</a> + utf8_length +
<a name="l01074"></a>01074       <a class="code" href="namespacetesseract.html#a688dc51b653c642009af87c6d9b9dea2">kMaxBytesPerLine</a>;
<a name="l01075"></a>01075   <span class="keywordtype">char</span>* result = <span class="keyword">new</span> <span class="keywordtype">char</span>[total_length];
<a name="l01076"></a>01076   <span class="keywordtype">int</span> output_length = 0;
<a name="l01077"></a>01077   <a class="code" href="classtesseract_1_1_l_t_r_result_iterator.html">LTRResultIterator</a>* it = <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ad7a9b7f45f94801d7891035bf38d4861">GetLTRIterator</a>();
<a name="l01078"></a>01078   <span class="keywordflow">do</span> {
<a name="l01079"></a>01079     <span class="keywordtype">int</span> left, top, right, bottom;
<a name="l01080"></a>01080     <span class="keywordflow">if</span> (it-&gt;<a class="code" href="classtesseract_1_1_page_iterator.html#a38f6d7da2a9b9ef8983286383729fa73">BoundingBox</a>(<a class="code" href="namespacetesseract.html#aa26c22b65cc9765a0e747120f4287fd7adbd62c7f34a9ebdd6e3b813a34cd812d">RIL_SYMBOL</a>, &amp;left, &amp;top, &amp;right, &amp;bottom)) {
<a name="l01081"></a>01081       <span class="keywordtype">char</span>* text = it-&gt;<a class="code" href="classtesseract_1_1_l_t_r_result_iterator.html#a48717a8736c388b8f86d617dd4d1e3b6">GetUTF8Text</a>(<a class="code" href="namespacetesseract.html#aa26c22b65cc9765a0e747120f4287fd7adbd62c7f34a9ebdd6e3b813a34cd812d">RIL_SYMBOL</a>);
<a name="l01082"></a>01082       <span class="comment">// Tesseract uses space for recognition failure. Fix to a reject</span>
<a name="l01083"></a>01083       <span class="comment">// character, kTesseractReject so we don&#39;t create illegal box files.</span>
<a name="l01084"></a>01084       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; text[i] != <span class="charliteral">&#39;\0&#39;</span>; ++i) {
<a name="l01085"></a>01085         <span class="keywordflow">if</span> (text[i] == <span class="charliteral">&#39; &#39;</span>)
<a name="l01086"></a>01086           text[i] = <a class="code" href="namespacetesseract.html#a1083ed81b6adbb6930e87d0c58671e26">kTesseractReject</a>;
<a name="l01087"></a>01087       }
<a name="l01088"></a>01088       snprintf(result + output_length, total_length - output_length,
<a name="l01089"></a>01089                <span class="stringliteral">&quot;%s %d %d %d %d %d\n&quot;</span>,
<a name="l01090"></a>01090                text, left, <a class="code" href="group___thresholder_params.html#gab7d24a78f3565c5bfb42b2592b9e8df0">image_height_</a> - bottom,
<a name="l01091"></a>01091                right, <a class="code" href="group___thresholder_params.html#gab7d24a78f3565c5bfb42b2592b9e8df0">image_height_</a> - top, page_number);
<a name="l01092"></a>01092       output_length += strlen(result + output_length);
<a name="l01093"></a>01093       <span class="keyword">delete</span> [] text;
<a name="l01094"></a>01094       <span class="comment">// Just in case...</span>
<a name="l01095"></a>01095       <span class="keywordflow">if</span> (output_length + kMaxBytesPerLine &gt; total_length)
<a name="l01096"></a>01096         <span class="keywordflow">break</span>;
<a name="l01097"></a>01097     }
<a name="l01098"></a>01098   } <span class="keywordflow">while</span> (it-&gt;<a class="code" href="classtesseract_1_1_page_iterator.html#a415ea7c61e24868bc67e676184be0bb9">Next</a>(<a class="code" href="namespacetesseract.html#aa26c22b65cc9765a0e747120f4287fd7adbd62c7f34a9ebdd6e3b813a34cd812d">RIL_SYMBOL</a>));
<a name="l01099"></a>01099   <span class="keyword">delete</span> it;
<a name="l01100"></a>01100   <span class="keywordflow">return</span> result;
<a name="l01101"></a>01101 }
<a name="l01102"></a>01102 
<a name="l01103"></a>01103 <span class="comment">// Conversion table for non-latin characters.</span>
<a name="l01104"></a>01104 <span class="comment">// Maps characters out of the latin set into the latin set.</span>
<a name="l01105"></a>01105 <span class="comment">// TODO(rays) incorporate this translation into unicharset.</span>
<a name="l01106"></a><a class="code" href="namespacetesseract.html#afa62cc25480d6eee8b1bb2ef4a1f8fc3">01106</a> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="namespacetesseract.html#afa62cc25480d6eee8b1bb2ef4a1f8fc3">kUniChs</a>[] = {
<a name="l01107"></a>01107   0x20ac, 0x201c, 0x201d, 0x2018, 0x2019, 0x2022, 0x2014, 0
<a name="l01108"></a>01108 };
<a name="l01109"></a>01109 <span class="comment">// Latin chars corresponding to the unicode chars above.</span>
<a name="l01110"></a><a class="code" href="namespacetesseract.html#a7e0c7c50e2e05e503a51b8c33d35ade6">01110</a> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="namespacetesseract.html#a7e0c7c50e2e05e503a51b8c33d35ade6">kLatinChs</a>[] = {
<a name="l01111"></a>01111   0x00a2, 0x0022, 0x0022, 0x0027, 0x0027, 0x00b7, 0x002d, 0
<a name="l01112"></a>01112 };
<a name="l01113"></a>01113 
<a name="l01114"></a>01114 <span class="comment">// The recognized text is returned as a char* which is coded</span>
<a name="l01115"></a>01115 <span class="comment">// as UNLV format Latin-1 with specific reject and suspect codes</span>
<a name="l01116"></a>01116 <span class="comment">// and must be freed with the delete [] operator.</span>
<a name="l01117"></a><a class="code" href="group___advanced_a_p_i.html#ga173b4289191b6c2faf2a4a4b7c94affc">01117</a> <span class="keywordtype">char</span>* <a class="code" href="group___advanced_a_p_i.html#ga173b4289191b6c2faf2a4a4b7c94affc">TessBaseAPI::GetUNLVText</a>() {
<a name="l01118"></a>01118   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a> == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> ||
<a name="l01119"></a>01119       (!<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a7d4627f300b1096d43a3e7d54d8aa5df" title="page_res_ contains recognition data.">recognition_done_</a> &amp;&amp; <a class="code" href="group___advanced_a_p_i.html#ga0e4065c20b142d69a2324ee0c74ae0b0">Recognize</a>(<a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) &lt; 0))
<a name="l01120"></a>01120     <span class="keywordflow">return</span> <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01121"></a>01121   <span class="keywordtype">bool</span> tilde_crunch_written = <span class="keyword">false</span>;
<a name="l01122"></a>01122   <span class="keywordtype">bool</span> last_char_was_newline = <span class="keyword">true</span>;
<a name="l01123"></a>01123   <span class="keywordtype">bool</span> last_char_was_tilde = <span class="keyword">false</span>;
<a name="l01124"></a>01124 
<a name="l01125"></a>01125   <span class="keywordtype">int</span> total_length = <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#aed3d481fc0c7dffad24572bd1f449598">TextLength</a>(<a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01126"></a>01126   <a class="code" href="class_p_a_g_e___r_e_s___i_t.html">PAGE_RES_IT</a>   page_res_it(<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a12dda612630eba40e15f9d0b9955a04c" title="The page-level data.">page_res_</a>);
<a name="l01127"></a>01127   <span class="keywordtype">char</span>* result = <span class="keyword">new</span> <span class="keywordtype">char</span>[total_length];
<a name="l01128"></a>01128   <span class="keywordtype">char</span>* ptr = result;
<a name="l01129"></a>01129   <span class="keywordflow">for</span> (page_res_it.<a class="code" href="class_p_a_g_e___r_e_s___i_t.html#a15febd45d0904bb3c5f7d506368177f0">restart_page</a>(); page_res_it.<a class="code" href="class_p_a_g_e___r_e_s___i_t.html#ab84b4850200ba8802791c6197c113fd0">word</a> () != <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01130"></a>01130        page_res_it.<a class="code" href="class_p_a_g_e___r_e_s___i_t.html#ab29005f235cc738eebafb7d9ed6fe70b">forward</a>()) {
<a name="l01131"></a>01131     <a class="code" href="class_w_e_r_d___r_e_s.html">WERD_RES</a> *word = page_res_it.<a class="code" href="class_p_a_g_e___r_e_s___i_t.html#ab84b4850200ba8802791c6197c113fd0">word</a>();
<a name="l01132"></a>01132     <span class="comment">// Process the current word.</span>
<a name="l01133"></a>01133     <span class="keywordflow">if</span> (word-&gt;<a class="code" href="class_w_e_r_d___r_e_s.html#a82d32a9f59bc1c08da9537303c56615b">unlv_crunch_mode</a> != <a class="code" href="pageres_8h.html#affc9a96d31e23e645355e534f11c40e9a1eac25752f2c55f1809d11d4ef917ff9">CR_NONE</a>) {
<a name="l01134"></a>01134       <span class="keywordflow">if</span> (word-&gt;<a class="code" href="class_w_e_r_d___r_e_s.html#a82d32a9f59bc1c08da9537303c56615b">unlv_crunch_mode</a> != <a class="code" href="pageres_8h.html#affc9a96d31e23e645355e534f11c40e9a1799c83261446306e1d1527f1779d6a4">CR_DELETE</a> &amp;&amp;
<a name="l01135"></a>01135           (!tilde_crunch_written ||
<a name="l01136"></a>01136            (word-&gt;<a class="code" href="class_w_e_r_d___r_e_s.html#a82d32a9f59bc1c08da9537303c56615b">unlv_crunch_mode</a> == <a class="code" href="pageres_8h.html#affc9a96d31e23e645355e534f11c40e9ad0198ebd5b9e3299dd94f0c5f4d3e003">CR_KEEP_SPACE</a> &amp;&amp;
<a name="l01137"></a>01137             word-&gt;<a class="code" href="class_w_e_r_d___r_e_s.html#afc15fa7c1b5ad55d6772dea0d6865df1">word</a>-&gt;<a class="code" href="class_w_e_r_d.html#ab2979974cf23f5c66f4e77cc51f2e189">space</a>() &gt; 0 &amp;&amp;
<a name="l01138"></a>01138             !word-&gt;<a class="code" href="class_w_e_r_d___r_e_s.html#afc15fa7c1b5ad55d6772dea0d6865df1">word</a>-&gt;<a class="code" href="class_w_e_r_d.html#a81edde8597a3d9fd8a664d703d332c41">flag</a>(<a class="code" href="werd_8h.html#ad6968adbf8f2cc44adf333ec96efb0bea675eadd051ea82d1f288751799bfa31c">W_FUZZY_NON</a>) &amp;&amp;
<a name="l01139"></a>01139             !word-&gt;<a class="code" href="class_w_e_r_d___r_e_s.html#afc15fa7c1b5ad55d6772dea0d6865df1">word</a>-&gt;<a class="code" href="class_w_e_r_d.html#a81edde8597a3d9fd8a664d703d332c41">flag</a>(<a class="code" href="werd_8h.html#ad6968adbf8f2cc44adf333ec96efb0bea3580884b5b0335502fb928db4a0a2024">W_FUZZY_SP</a>)))) {
<a name="l01140"></a>01140         <span class="keywordflow">if</span> (!word-&gt;<a class="code" href="class_w_e_r_d___r_e_s.html#afc15fa7c1b5ad55d6772dea0d6865df1">word</a>-&gt;<a class="code" href="class_w_e_r_d.html#a81edde8597a3d9fd8a664d703d332c41">flag</a>(<a class="code" href="werd_8h.html#ad6968adbf8f2cc44adf333ec96efb0beaff21d7c8c8992120fff35942408a00d2">W_BOL</a>) &amp;&amp;
<a name="l01141"></a>01141             word-&gt;<a class="code" href="class_w_e_r_d___r_e_s.html#afc15fa7c1b5ad55d6772dea0d6865df1">word</a>-&gt;<a class="code" href="class_w_e_r_d.html#ab2979974cf23f5c66f4e77cc51f2e189">space</a>() &gt; 0 &amp;&amp;
<a name="l01142"></a>01142             !word-&gt;<a class="code" href="class_w_e_r_d___r_e_s.html#afc15fa7c1b5ad55d6772dea0d6865df1">word</a>-&gt;<a class="code" href="class_w_e_r_d.html#a81edde8597a3d9fd8a664d703d332c41">flag</a>(<a class="code" href="werd_8h.html#ad6968adbf8f2cc44adf333ec96efb0bea675eadd051ea82d1f288751799bfa31c">W_FUZZY_NON</a>) &amp;&amp;
<a name="l01143"></a>01143             !word-&gt;<a class="code" href="class_w_e_r_d___r_e_s.html#afc15fa7c1b5ad55d6772dea0d6865df1">word</a>-&gt;<a class="code" href="class_w_e_r_d.html#a81edde8597a3d9fd8a664d703d332c41">flag</a>(<a class="code" href="werd_8h.html#ad6968adbf8f2cc44adf333ec96efb0bea3580884b5b0335502fb928db4a0a2024">W_FUZZY_SP</a>)) {
<a name="l01144"></a>01144           <span class="comment">/* Write a space to separate from preceeding good text */</span>
<a name="l01145"></a>01145           *ptr++ = <span class="charliteral">&#39; &#39;</span>;
<a name="l01146"></a>01146           last_char_was_tilde = <span class="keyword">false</span>;
<a name="l01147"></a>01147         }
<a name="l01148"></a>01148         <span class="keywordflow">if</span> (!last_char_was_tilde) {
<a name="l01149"></a>01149           <span class="comment">// Write a reject char.</span>
<a name="l01150"></a>01150           last_char_was_tilde = <span class="keyword">true</span>;
<a name="l01151"></a>01151           *ptr++ = <a class="code" href="namespacetesseract.html#a99bec48b41ccb504c28851dbe5b1f106">kUNLVReject</a>;
<a name="l01152"></a>01152           tilde_crunch_written = <span class="keyword">true</span>;
<a name="l01153"></a>01153           last_char_was_newline = <span class="keyword">false</span>;
<a name="l01154"></a>01154         }
<a name="l01155"></a>01155       }
<a name="l01156"></a>01156     } <span class="keywordflow">else</span> {
<a name="l01157"></a>01157       <span class="comment">// NORMAL PROCESSING of non tilde crunched words.</span>
<a name="l01158"></a>01158       tilde_crunch_written = <span class="keyword">false</span>;
<a name="l01159"></a>01159       <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#a2888f59985750554a12f173073305ad3">set_unlv_suspects</a>(word);
<a name="l01160"></a>01160       <span class="keyword">const</span> <span class="keywordtype">char</span>* wordstr = word-&gt;<a class="code" href="class_w_e_r_d___r_e_s.html#a3d42ac7ec121263e757c9b7160dfd50d">best_choice</a>-&gt;<a class="code" href="class_w_e_r_d___c_h_o_i_c_e.html#a41d740f0accccdfb245d34d554122116">unichar_string</a>().<a class="code" href="class_s_t_r_i_n_g.html#a32beee43ecab1bed8bebc3466896ad6e">string</a>();
<a name="l01161"></a>01161       <span class="keyword">const</span> <a class="code" href="class_s_t_r_i_n_g.html">STRING</a>&amp; lengths = word-&gt;<a class="code" href="class_w_e_r_d___r_e_s.html#a3d42ac7ec121263e757c9b7160dfd50d">best_choice</a>-&gt;<a class="code" href="class_w_e_r_d___c_h_o_i_c_e.html#a93ab94b6fa6d5c0469fb52d66c62968c">unichar_lengths</a>();
<a name="l01162"></a>01162       <span class="keywordtype">int</span> length = lengths.<a class="code" href="class_s_t_r_i_n_g.html#a168505a533eda60219c93e25adf4cdc5">length</a>();
<a name="l01163"></a>01163       <span class="keywordtype">int</span> i = 0;
<a name="l01164"></a>01164       <span class="keywordtype">int</span> offset = 0;
<a name="l01165"></a>01165 
<a name="l01166"></a>01166       <span class="keywordflow">if</span> (last_char_was_tilde &amp;&amp;
<a name="l01167"></a>01167           word-&gt;<a class="code" href="class_w_e_r_d___r_e_s.html#afc15fa7c1b5ad55d6772dea0d6865df1">word</a>-&gt;<a class="code" href="class_w_e_r_d.html#ab2979974cf23f5c66f4e77cc51f2e189">space</a>() == 0 &amp;&amp; wordstr[offset] == <span class="charliteral">&#39; &#39;</span>) {
<a name="l01168"></a>01168         <span class="comment">// Prevent adjacent tilde across words - we know that adjacent tildes</span>
<a name="l01169"></a>01169         <span class="comment">// within words have been removed.</span>
<a name="l01170"></a>01170         <span class="comment">// Skip the first character.</span>
<a name="l01171"></a>01171         offset = lengths[i++];
<a name="l01172"></a>01172       }
<a name="l01173"></a>01173       <span class="keywordflow">if</span> (i &lt; length &amp;&amp; wordstr[offset] != 0) {
<a name="l01174"></a>01174         <span class="keywordflow">if</span> (!last_char_was_newline)
<a name="l01175"></a>01175           *ptr++ = <span class="charliteral">&#39; &#39;</span>;
<a name="l01176"></a>01176         <span class="keywordflow">else</span>
<a name="l01177"></a>01177           last_char_was_newline = <span class="keyword">false</span>;
<a name="l01178"></a>01178         <span class="keywordflow">for</span> (; i &lt; length; offset += lengths[i++]) {
<a name="l01179"></a>01179           <span class="keywordflow">if</span> (wordstr[offset] == <span class="charliteral">&#39; &#39;</span> ||
<a name="l01180"></a>01180               wordstr[offset] == <a class="code" href="namespacetesseract.html#a1083ed81b6adbb6930e87d0c58671e26">kTesseractReject</a>) {
<a name="l01181"></a>01181             *ptr++ = <a class="code" href="namespacetesseract.html#a99bec48b41ccb504c28851dbe5b1f106">kUNLVReject</a>;
<a name="l01182"></a>01182             last_char_was_tilde = <span class="keyword">true</span>;
<a name="l01183"></a>01183           } <span class="keywordflow">else</span> {
<a name="l01184"></a>01184             <span class="keywordflow">if</span> (word-&gt;<a class="code" href="class_w_e_r_d___r_e_s.html#ae24eb58be06cf275aee411d947fd31ef">reject_map</a>[i].rejected())
<a name="l01185"></a>01185               *ptr++ = <a class="code" href="namespacetesseract.html#af7e73b761f145b66ffcc7585ed69d940">kUNLVSuspect</a>;
<a name="l01186"></a>01186             <a class="code" href="class_u_n_i_c_h_a_r.html">UNICHAR</a> ch(wordstr + offset, lengths[i]);
<a name="l01187"></a>01187             <span class="keywordtype">int</span> uni_ch = ch.<a class="code" href="class_u_n_i_c_h_a_r.html#a59ffb904d7e604da0fea3fad1c63ee64">first_uni</a>();
<a name="l01188"></a>01188             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; <a class="code" href="namespacetesseract.html#afa62cc25480d6eee8b1bb2ef4a1f8fc3">kUniChs</a>[j] != 0; ++j) {
<a name="l01189"></a>01189               <span class="keywordflow">if</span> (<a class="code" href="namespacetesseract.html#afa62cc25480d6eee8b1bb2ef4a1f8fc3">kUniChs</a>[j] == uni_ch) {
<a name="l01190"></a>01190                 uni_ch = <a class="code" href="namespacetesseract.html#a7e0c7c50e2e05e503a51b8c33d35ade6">kLatinChs</a>[j];
<a name="l01191"></a>01191                 <span class="keywordflow">break</span>;
<a name="l01192"></a>01192               }
<a name="l01193"></a>01193             }
<a name="l01194"></a>01194             <span class="keywordflow">if</span> (uni_ch &lt;= 0xff) {
<a name="l01195"></a>01195               *ptr++ = <span class="keyword">static_cast&lt;</span><span class="keywordtype">char</span><span class="keyword">&gt;</span>(uni_ch);
<a name="l01196"></a>01196               last_char_was_tilde = <span class="keyword">false</span>;
<a name="l01197"></a>01197             } <span class="keywordflow">else</span> {
<a name="l01198"></a>01198               *ptr++ = <a class="code" href="namespacetesseract.html#a99bec48b41ccb504c28851dbe5b1f106">kUNLVReject</a>;
<a name="l01199"></a>01199               last_char_was_tilde = <span class="keyword">true</span>;
<a name="l01200"></a>01200             }
<a name="l01201"></a>01201           }
<a name="l01202"></a>01202         }
<a name="l01203"></a>01203       }
<a name="l01204"></a>01204     }
<a name="l01205"></a>01205     <span class="keywordflow">if</span> (word-&gt;<a class="code" href="class_w_e_r_d___r_e_s.html#afc15fa7c1b5ad55d6772dea0d6865df1">word</a>-&gt;<a class="code" href="class_w_e_r_d.html#a81edde8597a3d9fd8a664d703d332c41">flag</a>(<a class="code" href="werd_8h.html#ad6968adbf8f2cc44adf333ec96efb0bea62efb985a62d85e014ee5ab039dd50ce">W_EOL</a>) &amp;&amp; !last_char_was_newline) {
<a name="l01206"></a>01206       <span class="comment">/* Add a new line output */</span>
<a name="l01207"></a>01207       *ptr++ = <span class="charliteral">&#39;\n&#39;</span>;
<a name="l01208"></a>01208       tilde_crunch_written = <span class="keyword">false</span>;
<a name="l01209"></a>01209       last_char_was_newline = <span class="keyword">true</span>;
<a name="l01210"></a>01210       last_char_was_tilde = <span class="keyword">false</span>;
<a name="l01211"></a>01211     }
<a name="l01212"></a>01212   }
<a name="l01213"></a>01213   *ptr++ = <span class="charliteral">&#39;\n&#39;</span>;
<a name="l01214"></a>01214   *ptr = <span class="charliteral">&#39;\0&#39;</span>;
<a name="l01215"></a>01215   <span class="keywordflow">return</span> result;
<a name="l01216"></a>01216 }
<a name="l01217"></a>01217 
<a name="l01218"></a>01218 <span class="comment">// Returns the average word confidence for Tesseract page result.</span>
<a name="l01219"></a><a class="code" href="group___advanced_a_p_i.html#ga027054e6176889ff49a7108e174fce0f">01219</a> <span class="keywordtype">int</span> <a class="code" href="group___advanced_a_p_i.html#ga027054e6176889ff49a7108e174fce0f">TessBaseAPI::MeanTextConf</a>() {
<a name="l01220"></a>01220   <span class="keywordtype">int</span>* conf = <a class="code" href="group___advanced_a_p_i.html#ga4a67a12db21b3569b2b50ad05b9e146a">AllWordConfidences</a>();
<a name="l01221"></a>01221   <span class="keywordflow">if</span> (!conf) <span class="keywordflow">return</span> 0;
<a name="l01222"></a>01222   <span class="keywordtype">int</span> sum = 0;
<a name="l01223"></a>01223   <span class="keywordtype">int</span> *pt = conf;
<a name="l01224"></a>01224   <span class="keywordflow">while</span> (*pt &gt;= 0) sum += *pt++;
<a name="l01225"></a>01225   <span class="keywordflow">if</span> (pt != conf) sum /= pt - conf;
<a name="l01226"></a>01226   <span class="keyword">delete</span> [] conf;
<a name="l01227"></a>01227   <span class="keywordflow">return</span> sum;
<a name="l01228"></a>01228 }
<a name="l01229"></a>01229 
<a name="l01230"></a>01230 <span class="comment">// Returns an array of all word confidences, terminated by -1.</span>
<a name="l01231"></a><a class="code" href="group___advanced_a_p_i.html#ga4a67a12db21b3569b2b50ad05b9e146a">01231</a> <span class="keywordtype">int</span>* <a class="code" href="group___advanced_a_p_i.html#ga4a67a12db21b3569b2b50ad05b9e146a">TessBaseAPI::AllWordConfidences</a>() {
<a name="l01232"></a>01232   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a> == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> ||
<a name="l01233"></a>01233       (!<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a7d4627f300b1096d43a3e7d54d8aa5df" title="page_res_ contains recognition data.">recognition_done_</a> &amp;&amp; <a class="code" href="group___advanced_a_p_i.html#ga0e4065c20b142d69a2324ee0c74ae0b0">Recognize</a>(<a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) &lt; 0))
<a name="l01234"></a>01234     <span class="keywordflow">return</span> <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01235"></a>01235   <span class="keywordtype">int</span> n_word = 0;
<a name="l01236"></a>01236   <a class="code" href="class_p_a_g_e___r_e_s___i_t.html">PAGE_RES_IT</a> res_it(<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a12dda612630eba40e15f9d0b9955a04c" title="The page-level data.">page_res_</a>);
<a name="l01237"></a>01237   <span class="keywordflow">for</span> (res_it.<a class="code" href="class_p_a_g_e___r_e_s___i_t.html#a15febd45d0904bb3c5f7d506368177f0">restart_page</a>(); res_it.<a class="code" href="class_p_a_g_e___r_e_s___i_t.html#ab84b4850200ba8802791c6197c113fd0">word</a>() != <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>; res_it.<a class="code" href="class_p_a_g_e___r_e_s___i_t.html#ab29005f235cc738eebafb7d9ed6fe70b">forward</a>())
<a name="l01238"></a>01238     n_word++;
<a name="l01239"></a>01239 
<a name="l01240"></a>01240   <span class="keywordtype">int</span>* conf = <span class="keyword">new</span> <span class="keywordtype">int</span>[n_word+1];
<a name="l01241"></a>01241   n_word = 0;
<a name="l01242"></a>01242   <span class="keywordflow">for</span> (res_it.<a class="code" href="class_p_a_g_e___r_e_s___i_t.html#a15febd45d0904bb3c5f7d506368177f0">restart_page</a>(); res_it.<a class="code" href="class_p_a_g_e___r_e_s___i_t.html#ab84b4850200ba8802791c6197c113fd0">word</a>() != <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>; res_it.<a class="code" href="class_p_a_g_e___r_e_s___i_t.html#ab29005f235cc738eebafb7d9ed6fe70b">forward</a>()) {
<a name="l01243"></a>01243     <a class="code" href="class_w_e_r_d___r_e_s.html">WERD_RES</a> *word = res_it.<a class="code" href="class_p_a_g_e___r_e_s___i_t.html#ab84b4850200ba8802791c6197c113fd0">word</a>();
<a name="l01244"></a>01244     <a class="code" href="class_w_e_r_d___c_h_o_i_c_e.html">WERD_CHOICE</a>* choice = word-&gt;<a class="code" href="class_w_e_r_d___r_e_s.html#a3d42ac7ec121263e757c9b7160dfd50d">best_choice</a>;
<a name="l01245"></a>01245     <span class="keywordtype">int</span> w_conf = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(100 + 5 * choice-&gt;<a class="code" href="class_w_e_r_d___c_h_o_i_c_e.html#a1b25ef2b44d21a7204483a7ca804f293">certainty</a>());
<a name="l01246"></a>01246                  <span class="comment">// This is the eq for converting Tesseract confidence to 1..100</span>
<a name="l01247"></a>01247     <span class="keywordflow">if</span> (w_conf &lt; 0) w_conf = 0;
<a name="l01248"></a>01248     <span class="keywordflow">if</span> (w_conf &gt; 100) w_conf = 100;
<a name="l01249"></a>01249     conf[n_word++] = w_conf;
<a name="l01250"></a>01250   }
<a name="l01251"></a>01251   conf[n_word] = -1;
<a name="l01252"></a>01252   <span class="keywordflow">return</span> conf;
<a name="l01253"></a>01253 }
<a name="l01254"></a>01254 
<a name="l01265"></a><a class="code" href="group___advanced_a_p_i.html#gab8c2ee5d614382f0d25deb9a7adfe199">01265</a> <span class="keywordtype">bool</span> <a class="code" href="group___advanced_a_p_i.html#gab8c2ee5d614382f0d25deb9a7adfe199">TessBaseAPI::AdaptToWordStr</a>(<a class="code" href="namespacetesseract.html#a338d4c8b5d497b5ec3e6e4269d8ac66a">PageSegMode</a> <a class="code" href="pgedit_8cpp.html#afc03cf3e39248c2e339fee4d31f5f750">mode</a>, <span class="keyword">const</span> <span class="keywordtype">char</span>* wordstr) {
<a name="l01266"></a>01266   <span class="keywordtype">int</span> debug = 0;
<a name="l01267"></a>01267   <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a5923cccbe20988f0f99072844d1af573">GetIntVariable</a>(<span class="stringliteral">&quot;applybox_debug&quot;</span>, &amp;debug);
<a name="l01268"></a>01268   <span class="keywordtype">bool</span> success = <span class="keyword">true</span>;
<a name="l01269"></a>01269   <a class="code" href="namespacetesseract.html#a338d4c8b5d497b5ec3e6e4269d8ac66a">PageSegMode</a> current_psm = <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a943206e3548bfb517c67354ee50661f3">GetPageSegMode</a>();
<a name="l01270"></a>01270   <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a15a7a9c1afbba3078a55b4566de891ab">SetPageSegMode</a>(mode);
<a name="l01271"></a>01271   <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a2e09259c558c6d8e0f7e523cbaf5adf5">SetVariable</a>(<span class="stringliteral">&quot;classify_enable_learning&quot;</span>, <span class="stringliteral">&quot;0&quot;</span>);
<a name="l01272"></a>01272   <span class="keywordtype">char</span>* text = <a class="code" href="group___advanced_a_p_i.html#ga115ef656f83352ba608b4f0bf9cfa2c4">GetUTF8Text</a>();
<a name="l01273"></a>01273   <span class="keywordflow">if</span> (debug) {
<a name="l01274"></a>01274     <a class="code" href="tprintf_8cpp.html#a0c2bcd4462ec67ab0971b34a0f610f55">tprintf</a>(<span class="stringliteral">&quot;Trying to adapt \&quot;%s\&quot; to \&quot;%s\&quot;\n&quot;</span>, text, wordstr);
<a name="l01275"></a>01275   }
<a name="l01276"></a>01276   <span class="keywordflow">if</span> (text != <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l01277"></a>01277     <a class="code" href="class_p_a_g_e___r_e_s___i_t.html">PAGE_RES_IT</a> it(<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a12dda612630eba40e15f9d0b9955a04c" title="The page-level data.">page_res_</a>);
<a name="l01278"></a>01278     <a class="code" href="class_w_e_r_d___r_e_s.html">WERD_RES</a>* word_res = it.<a class="code" href="class_p_a_g_e___r_e_s___i_t.html#ab84b4850200ba8802791c6197c113fd0">word</a>();
<a name="l01279"></a>01279     <span class="keywordflow">if</span> (word_res != <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l01280"></a>01280       word_res-&gt;<a class="code" href="class_w_e_r_d___r_e_s.html#afc15fa7c1b5ad55d6772dea0d6865df1">word</a>-&gt;<a class="code" href="class_w_e_r_d.html#a5decd0b33533bf908c26ad4b10336fb0">set_text</a>(wordstr);
<a name="l01281"></a>01281     } <span class="keywordflow">else</span> {
<a name="l01282"></a>01282       success = <span class="keyword">false</span>;
<a name="l01283"></a>01283     }
<a name="l01284"></a>01284     <span class="comment">// Check to see if text matches wordstr.</span>
<a name="l01285"></a>01285     <span class="keywordtype">int</span> w = 0;
<a name="l01286"></a>01286     <span class="keywordtype">int</span> t = 0;
<a name="l01287"></a>01287     <span class="keywordflow">for</span> (t = 0; text[t] != <span class="charliteral">&#39;\0&#39;</span>; ++t) {
<a name="l01288"></a>01288       <span class="keywordflow">if</span> (text[t] == <span class="charliteral">&#39;\n&#39;</span> || text[t] == <span class="charliteral">&#39; &#39;</span>)
<a name="l01289"></a>01289         <span class="keywordflow">continue</span>;
<a name="l01290"></a>01290       <span class="keywordflow">while</span> (wordstr[w] != <span class="charliteral">&#39;\0&#39;</span> &amp;&amp; wordstr[w] == <span class="charliteral">&#39; &#39;</span>)
<a name="l01291"></a>01291         ++w;
<a name="l01292"></a>01292       <span class="keywordflow">if</span> (text[t] != wordstr[w])
<a name="l01293"></a>01293         <span class="keywordflow">break</span>;
<a name="l01294"></a>01294       ++w;
<a name="l01295"></a>01295     }
<a name="l01296"></a>01296     <span class="keywordflow">if</span> (text[t] != <span class="charliteral">&#39;\0&#39;</span> || wordstr[w] != <span class="charliteral">&#39;\0&#39;</span>) {
<a name="l01297"></a>01297       <span class="comment">// No match.</span>
<a name="l01298"></a>01298       <span class="keyword">delete</span> <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a12dda612630eba40e15f9d0b9955a04c" title="The page-level data.">page_res_</a>;
<a name="l01299"></a>01299       <a class="code" href="class_generic_vector.html">GenericVector&lt;TBOX&gt;</a> boxes;
<a name="l01300"></a>01300       <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a12dda612630eba40e15f9d0b9955a04c" title="The page-level data.">page_res_</a> = <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#a8dea5db2452f327200936d6e9f2ab593">SetupApplyBoxes</a>(boxes, <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ac22c36258b0cd727188505a9a1dbc7e1" title="The page layout.">block_list_</a>);
<a name="l01301"></a>01301       <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#a6193fb469b62b12c1b999194fc5cd569">ReSegmentByClassification</a>(<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a12dda612630eba40e15f9d0b9955a04c" title="The page-level data.">page_res_</a>);
<a name="l01302"></a>01302       <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#a420654e409a9d28fd133515b5f3ed2c3">TidyUp</a>(<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a12dda612630eba40e15f9d0b9955a04c" title="The page-level data.">page_res_</a>);
<a name="l01303"></a>01303       <a class="code" href="class_p_a_g_e___r_e_s___i_t.html">PAGE_RES_IT</a> pr_it(<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a12dda612630eba40e15f9d0b9955a04c" title="The page-level data.">page_res_</a>);
<a name="l01304"></a>01304       <span class="keywordflow">if</span> (pr_it.<a class="code" href="class_p_a_g_e___r_e_s___i_t.html#ab84b4850200ba8802791c6197c113fd0">word</a>() == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l01305"></a>01305         success = <span class="keyword">false</span>;
<a name="l01306"></a>01306       <span class="keywordflow">else</span>
<a name="l01307"></a>01307         word_res = pr_it.<a class="code" href="class_p_a_g_e___r_e_s___i_t.html#ab84b4850200ba8802791c6197c113fd0">word</a>();
<a name="l01308"></a>01308     } <span class="keywordflow">else</span> {
<a name="l01309"></a>01309       word_res-&gt;<a class="code" href="class_w_e_r_d___r_e_s.html#a8d4f5c6ed2c60b756a5c63e091cd331c">BestChoiceToCorrectText</a>();
<a name="l01310"></a>01310     }
<a name="l01311"></a>01311     <span class="keywordflow">if</span> (success) {
<a name="l01312"></a>01312       <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_classify.html#a7d0ccfd06421346d8cda0f1b76fd8516">EnableLearning</a> = <span class="keyword">true</span>;
<a name="l01313"></a>01313       <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_classify.html#abbbd86871758c036d7ba2af682abb45f">LearnWord</a>(<a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, word_res);
<a name="l01314"></a>01314     }
<a name="l01315"></a>01315     <span class="keyword">delete</span> [] text;
<a name="l01316"></a>01316   } <span class="keywordflow">else</span> {
<a name="l01317"></a>01317     success = <span class="keyword">false</span>;
<a name="l01318"></a>01318   }
<a name="l01319"></a>01319   <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a15a7a9c1afbba3078a55b4566de891ab">SetPageSegMode</a>(current_psm);
<a name="l01320"></a>01320   <span class="keywordflow">return</span> success;
<a name="l01321"></a>01321 }
<a name="l01322"></a>01322 
<a name="l01323"></a>01323 <span class="comment">// Free up recognition results and any stored image data, without actually</span>
<a name="l01324"></a>01324 <span class="comment">// freeing any recognition data that would be time-consuming to reload.</span>
<a name="l01325"></a>01325 <span class="comment">// Afterwards, you must call SetImage or TesseractRect before doing</span>
<a name="l01326"></a>01326 <span class="comment">// any Recognize or Get* operation.</span>
<a name="l01327"></a><a class="code" href="group___advanced_a_p_i.html#ga953b401286da174e609f09c5f275734e">01327</a> <span class="keywordtype">void</span> <a class="code" href="group___advanced_a_p_i.html#ga953b401286da174e609f09c5f275734e">TessBaseAPI::Clear</a>() {
<a name="l01328"></a>01328   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a9d93e1d92ca230ae02b81d44bc88a55c" title="Image thresholding module.">thresholder_</a> != <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l01329"></a>01329     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a9d93e1d92ca230ae02b81d44bc88a55c" title="Image thresholding module.">thresholder_</a>-&gt;<a class="code" href="classtesseract_1_1_image_thresholder.html#afe5b51a09de405a0fc04b1d72c3c908d" title="Destroy the Pix if there is one, freeing memory.">Clear</a>();
<a name="l01330"></a>01330   <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a83ca325b5e521416b1edcd020b169be0">ClearResults</a>();
<a name="l01331"></a>01331 }
<a name="l01332"></a>01332 
<a name="l01333"></a>01333 <span class="comment">// Close down tesseract and free up all memory. End() is equivalent to</span>
<a name="l01334"></a>01334 <span class="comment">// destructing and reconstructing your TessBaseAPI.</span>
<a name="l01335"></a>01335 <span class="comment">// Once End() has been used, none of the other API functions may be used</span>
<a name="l01336"></a>01336 <span class="comment">// other than Init and anything declared above it in the class definition.</span>
<a name="l01337"></a><a class="code" href="group___advanced_a_p_i.html#ga38027513ee9c0348de1790bddcdc3391">01337</a> <span class="keywordtype">void</span> <a class="code" href="group___advanced_a_p_i.html#ga38027513ee9c0348de1790bddcdc3391">TessBaseAPI::End</a>() {
<a name="l01338"></a>01338   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a9d93e1d92ca230ae02b81d44bc88a55c" title="Image thresholding module.">thresholder_</a> != <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l01339"></a>01339     <span class="keyword">delete</span> <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a9d93e1d92ca230ae02b81d44bc88a55c" title="Image thresholding module.">thresholder_</a>;
<a name="l01340"></a>01340     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a9d93e1d92ca230ae02b81d44bc88a55c" title="Image thresholding module.">thresholder_</a> = <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01341"></a>01341   }
<a name="l01342"></a>01342   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a12dda612630eba40e15f9d0b9955a04c" title="The page-level data.">page_res_</a> != <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l01343"></a>01343     <span class="keyword">delete</span> <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a12dda612630eba40e15f9d0b9955a04c" title="The page-level data.">page_res_</a>;
<a name="l01344"></a>01344     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a12dda612630eba40e15f9d0b9955a04c" title="The page-level data.">page_res_</a> = <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01345"></a>01345   }
<a name="l01346"></a>01346   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ac22c36258b0cd727188505a9a1dbc7e1" title="The page layout.">block_list_</a> != <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l01347"></a>01347     <span class="keyword">delete</span> <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ac22c36258b0cd727188505a9a1dbc7e1" title="The page layout.">block_list_</a>;
<a name="l01348"></a>01348     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ac22c36258b0cd727188505a9a1dbc7e1" title="The page layout.">block_list_</a> = <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01349"></a>01349   }
<a name="l01350"></a>01350   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a06084d66b830a388515663761d842041">paragraph_models_</a> != <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l01351"></a>01351     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a06084d66b830a388515663761d842041">paragraph_models_</a>-&gt;<a class="code" href="class_generic_vector.html#a98f62dccd75224a60437c2761bd215cd">delete_data_pointers</a>();
<a name="l01352"></a>01352     <span class="keyword">delete</span> <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a06084d66b830a388515663761d842041">paragraph_models_</a>;
<a name="l01353"></a>01353     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a06084d66b830a388515663761d842041">paragraph_models_</a> = <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01354"></a>01354   }
<a name="l01355"></a>01355   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a> != <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l01356"></a>01356     <span class="keyword">delete</span> <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>;
<a name="l01357"></a>01357     <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ad7b44f5b470c9e04289c348d82726b27" title="For orientation &amp; script detection.">osd_tesseract_</a> == <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>)
<a name="l01358"></a>01358       <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ad7b44f5b470c9e04289c348d82726b27" title="For orientation &amp; script detection.">osd_tesseract_</a> = <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01359"></a>01359     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a> = <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01360"></a>01360   }
<a name="l01361"></a>01361   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ad7b44f5b470c9e04289c348d82726b27" title="For orientation &amp; script detection.">osd_tesseract_</a> != <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l01362"></a>01362     <span class="keyword">delete</span> <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ad7b44f5b470c9e04289c348d82726b27" title="For orientation &amp; script detection.">osd_tesseract_</a>;
<a name="l01363"></a>01363     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ad7b44f5b470c9e04289c348d82726b27" title="For orientation &amp; script detection.">osd_tesseract_</a> = <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01364"></a>01364   }
<a name="l01365"></a>01365   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a0222d0f645909860d13f71c078008133" title="The equation detector.">equ_detect_</a> != <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l01366"></a>01366     <span class="keyword">delete</span> <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a0222d0f645909860d13f71c078008133" title="The equation detector.">equ_detect_</a>;
<a name="l01367"></a>01367     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a0222d0f645909860d13f71c078008133" title="The equation detector.">equ_detect_</a> = <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01368"></a>01368   }
<a name="l01369"></a>01369   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a4690919aa9d4eabda36bdefdaadf7ac9" title="Name used by training code.">input_file_</a> != <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l01370"></a>01370     <span class="keyword">delete</span> <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a4690919aa9d4eabda36bdefdaadf7ac9" title="Name used by training code.">input_file_</a>;
<a name="l01371"></a>01371     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a4690919aa9d4eabda36bdefdaadf7ac9" title="Name used by training code.">input_file_</a> = <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01372"></a>01372   }
<a name="l01373"></a>01373   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a22a0c520bc88e2d80fb8b6a10b7caba1" title="Name used by debug code.">output_file_</a> != <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l01374"></a>01374     <span class="keyword">delete</span> <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a22a0c520bc88e2d80fb8b6a10b7caba1" title="Name used by debug code.">output_file_</a>;
<a name="l01375"></a>01375     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a22a0c520bc88e2d80fb8b6a10b7caba1" title="Name used by debug code.">output_file_</a> = <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01376"></a>01376   }
<a name="l01377"></a>01377   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ad7c3d4ead7b9c8e27e45e710e5407913" title="Current location of tessdata.">datapath_</a> != <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l01378"></a>01378     <span class="keyword">delete</span> <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ad7c3d4ead7b9c8e27e45e710e5407913" title="Current location of tessdata.">datapath_</a>;
<a name="l01379"></a>01379     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ad7c3d4ead7b9c8e27e45e710e5407913" title="Current location of tessdata.">datapath_</a> = <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01380"></a>01380   }
<a name="l01381"></a>01381   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a74a291190aa0bbf90b57f678b1fb0a5c" title="Last initialized language.">language_</a> != <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l01382"></a>01382     <span class="keyword">delete</span> <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a74a291190aa0bbf90b57f678b1fb0a5c" title="Last initialized language.">language_</a>;
<a name="l01383"></a>01383     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a74a291190aa0bbf90b57f678b1fb0a5c" title="Last initialized language.">language_</a> = <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01384"></a>01384   }
<a name="l01385"></a>01385 }
<a name="l01386"></a>01386 
<a name="l01387"></a>01387 <span class="comment">// Check whether a word is valid according to Tesseract&#39;s language model</span>
<a name="l01388"></a>01388 <span class="comment">// returns 0 if the word is invalid, non-zero if valid</span>
<a name="l01389"></a><a class="code" href="group___advanced_a_p_i.html#ga2c06caf08c9a8aa97a08a2de2f6200df">01389</a> <span class="keywordtype">int</span> <a class="code" href="group___advanced_a_p_i.html#ga2c06caf08c9a8aa97a08a2de2f6200df">TessBaseAPI::IsValidWord</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *word) {
<a name="l01390"></a>01390   <span class="keywordflow">return</span> <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_classify.html#a83e4207353a1bb07adfaa6a82a74c9ce">getDict</a>().<a class="code" href="classtesseract_1_1_dict.html#a22a45cd03f5d2191d0aeba41e3b4f52f">valid_word</a>(word);
<a name="l01391"></a>01391 }
<a name="l01392"></a>01392 
<a name="l01393"></a>01393 
<a name="l01394"></a><a class="code" href="group___advanced_a_p_i.html#ga535728aa13f5f5eb66cbece59a7737e5">01394</a> <span class="keywordtype">bool</span> <a class="code" href="group___advanced_a_p_i.html#ga535728aa13f5f5eb66cbece59a7737e5">TessBaseAPI::GetTextDirection</a>(<span class="keywordtype">int</span>* out_offset, <span class="keywordtype">float</span>* out_slope) {
<a name="l01395"></a>01395   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a12dda612630eba40e15f9d0b9955a04c" title="The page-level data.">page_res_</a> == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l01396"></a>01396     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a86899716a1adde396be4efd57b547d27">FindLines</a>();
<a name="l01397"></a>01397   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ac22c36258b0cd727188505a9a1dbc7e1" title="The page layout.">block_list_</a>-&gt;length() &lt; 1) {
<a name="l01398"></a>01398     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01399"></a>01399   }
<a name="l01400"></a>01400 
<a name="l01401"></a>01401   <span class="comment">// Get first block</span>
<a name="l01402"></a>01402   BLOCK_IT block_it(<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ac22c36258b0cd727188505a9a1dbc7e1" title="The page layout.">block_list_</a>);
<a name="l01403"></a>01403   block_it.move_to_first();
<a name="l01404"></a>01404   ROW_LIST* rows = block_it.data()-&gt;row_list();
<a name="l01405"></a>01405   <span class="keywordflow">if</span> (rows-&gt;length() &lt; 1) {
<a name="l01406"></a>01406     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01407"></a>01407   }
<a name="l01408"></a>01408 
<a name="l01409"></a>01409   <span class="comment">// Get first line of block</span>
<a name="l01410"></a>01410   ROW_IT row_it(rows);
<a name="l01411"></a>01411   row_it.move_to_first();
<a name="l01412"></a>01412   <a class="code" href="class_r_o_w.html">ROW</a>* row = row_it.data();
<a name="l01413"></a>01413 
<a name="l01414"></a>01414   <span class="comment">// Calculate offset and slope (NOTE: Kind of ugly)</span>
<a name="l01415"></a>01415   *out_offset = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(row-&gt;<a class="code" href="class_r_o_w.html#a097b3543fa3ca5768eb50033d4c4db9c">base_line</a>(0.0));
<a name="l01416"></a>01416   *out_slope = row-&gt;<a class="code" href="class_r_o_w.html#a097b3543fa3ca5768eb50033d4c4db9c">base_line</a>(1.0) - row-&gt;<a class="code" href="class_r_o_w.html#a097b3543fa3ca5768eb50033d4c4db9c">base_line</a>(0.0);
<a name="l01417"></a>01417 
<a name="l01418"></a>01418   <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01419"></a>01419 }
<a name="l01420"></a>01420 
<a name="l01421"></a>01421 <span class="comment">// Sets Dict::letter_is_okay_ function to point to the given function.</span>
<a name="l01422"></a><a class="code" href="group___advanced_a_p_i.html#ga7a7b2870798363811c011cec2bfbf22c">01422</a> <span class="keywordtype">void</span> <a class="code" href="group___advanced_a_p_i.html#ga7a7b2870798363811c011cec2bfbf22c">TessBaseAPI::SetDictFunc</a>(<a class="code" href="namespacetesseract.html#a8405c121c1d39fbfff2ee0318496d5f6">DictFunc</a> <a class="code" href="imgscale_8cpp.html#a469169df397b589e709dc744f1346831">f</a>) {
<a name="l01423"></a>01423   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a> != <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l01424"></a>01424     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_classify.html#a83e4207353a1bb07adfaa6a82a74c9ce">getDict</a>().<a class="code" href="classtesseract_1_1_dict.html#a802de385e07531ace182d16653e35f71">letter_is_okay_</a> = <a class="code" href="imgscale_8cpp.html#a469169df397b589e709dc744f1346831">f</a>;
<a name="l01425"></a>01425   }
<a name="l01426"></a>01426 }
<a name="l01427"></a>01427 
<a name="l01428"></a>01428 <span class="comment">// Sets Dict::probability_in_context_ function to point to the given function.</span>
<a name="l01429"></a><a class="code" href="group___advanced_a_p_i.html#gad7a52133fe0ebab22e97166c5e5cab67">01429</a> <span class="keywordtype">void</span> <a class="code" href="group___advanced_a_p_i.html#gad7a52133fe0ebab22e97166c5e5cab67">TessBaseAPI::SetProbabilityInContextFunc</a>(<a class="code" href="namespacetesseract.html#acff22894b78fa786f06840a81caf7650">ProbabilityInContextFunc</a> <a class="code" href="imgscale_8cpp.html#a469169df397b589e709dc744f1346831">f</a>) {
<a name="l01430"></a>01430   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a> != <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l01431"></a>01431     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_classify.html#a83e4207353a1bb07adfaa6a82a74c9ce">getDict</a>().<a class="code" href="classtesseract_1_1_dict.html#a7ac1496aaae5e9977a31a2781e7866f0" title="Probability in context function used by the ngram permuter.">probability_in_context_</a> = <a class="code" href="imgscale_8cpp.html#a469169df397b589e709dc744f1346831">f</a>;
<a name="l01432"></a>01432     <span class="comment">// Set it for the sublangs too.</span>
<a name="l01433"></a>01433     <span class="keywordtype">int</span> num_subs = <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#acdb611d653926772113b91423edbd004">num_sub_langs</a>();
<a name="l01434"></a>01434     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; num_subs; ++i) {
<a name="l01435"></a>01435       <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#afe9d7c06d9190dc4b686cb7342a01b52">get_sub_lang</a>(i)-&gt;<a class="code" href="classtesseract_1_1_classify.html#a83e4207353a1bb07adfaa6a82a74c9ce">getDict</a>().<a class="code" href="classtesseract_1_1_dict.html#a7ac1496aaae5e9977a31a2781e7866f0" title="Probability in context function used by the ngram permuter.">probability_in_context_</a> = <a class="code" href="imgscale_8cpp.html#a469169df397b589e709dc744f1346831">f</a>;
<a name="l01436"></a>01436     }
<a name="l01437"></a>01437   }
<a name="l01438"></a>01438 }
<a name="l01439"></a>01439 
<a name="l01440"></a>01440 <span class="comment">// Sets Wordrec::fill_lattice_ function to point to the given function.</span>
<a name="l01441"></a><a class="code" href="group___advanced_a_p_i.html#ga36a739bd0dc23a819170ca40f35c4b58">01441</a> <span class="keywordtype">void</span> <a class="code" href="group___advanced_a_p_i.html#ga36a739bd0dc23a819170ca40f35c4b58">TessBaseAPI::SetFillLatticeFunc</a>(<a class="code" href="namespacetesseract.html#a1d9d5b16b1c6d8d4add27aaf89267ce9">FillLatticeFunc</a> <a class="code" href="imgscale_8cpp.html#a469169df397b589e709dc744f1346831">f</a>) {
<a name="l01442"></a>01442   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a> != <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_wordrec.html#a7a4f5e2cb7957a5decbc91eb2d31f87c">fill_lattice_</a> = <a class="code" href="imgscale_8cpp.html#a469169df397b589e709dc744f1346831">f</a>;
<a name="l01443"></a>01443 }
<a name="l01444"></a>01444 
<a name="l01445"></a>01445 <span class="comment">// Common code for setting the image.</span>
<a name="l01446"></a><a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a17820a43c31b66c3a12eda59e0b51bba">01446</a> <span class="keywordtype">bool</span> <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a17820a43c31b66c3a12eda59e0b51bba">TessBaseAPI::InternalSetImage</a>() {
<a name="l01447"></a>01447   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a> == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l01448"></a>01448     <a class="code" href="tprintf_8cpp.html#a0c2bcd4462ec67ab0971b34a0f610f55">tprintf</a>(<span class="stringliteral">&quot;Please call Init before attempting to send an image.&quot;</span>);
<a name="l01449"></a>01449     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01450"></a>01450   }
<a name="l01451"></a>01451   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a9d93e1d92ca230ae02b81d44bc88a55c" title="Image thresholding module.">thresholder_</a> == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l01452"></a>01452     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a9d93e1d92ca230ae02b81d44bc88a55c" title="Image thresholding module.">thresholder_</a> = <span class="keyword">new</span> <a class="code" href="classtesseract_1_1_image_thresholder.html">ImageThresholder</a>;
<a name="l01453"></a>01453   <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a83ca325b5e521416b1edcd020b169be0">ClearResults</a>();
<a name="l01454"></a>01454   <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01455"></a>01455 }
<a name="l01456"></a>01456 
<a name="l01457"></a>01457 <span class="comment">// Run the thresholder to make the thresholded image, returned in pix,</span>
<a name="l01458"></a>01458 <span class="comment">// which must not be NULL. *pix must be initialized to NULL, or point</span>
<a name="l01459"></a>01459 <span class="comment">// to an existing pixDestroyable Pix.</span>
<a name="l01460"></a>01460 <span class="comment">// The usual argument to Threshold is Tesseract::mutable_pix_binary().</span>
<a name="l01461"></a><a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a8c8a3b050d6c356c4846345a3818f79e">01461</a> <span class="keywordtype">void</span> <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a8c8a3b050d6c356c4846345a3818f79e">TessBaseAPI::Threshold</a>(Pix** pix) {
<a name="l01462"></a>01462   <a class="code" href="errcode_8h.html#a93a603f4063a6b9403d81caa245a583b">ASSERT_HOST</a>(pix != <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01463"></a>01463   <span class="keywordflow">if</span> (!<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a9d93e1d92ca230ae02b81d44bc88a55c" title="Image thresholding module.">thresholder_</a>-&gt;<a class="code" href="classtesseract_1_1_image_thresholder.html#a3399e9237569c4b2a5fd5268db593363" title="Returns true if the source image is binary.">IsBinary</a>()) {
<a name="l01464"></a>01464     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#a2c7fb16774479af5df8e8102aaa86ca1">set_pix_grey</a>(<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a9d93e1d92ca230ae02b81d44bc88a55c" title="Image thresholding module.">thresholder_</a>-&gt;<a class="code" href="classtesseract_1_1_image_thresholder.html#a0a01ac88f9d1193ebb80c96a09a9b01f">GetPixRectGrey</a>());
<a name="l01465"></a>01465   }
<a name="l01466"></a>01466   <span class="keywordflow">if</span> (*pix != <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l01467"></a>01467     pixDestroy(pix);
<a name="l01468"></a>01468   <span class="comment">// Zero resolution messes up the algorithms, so make sure it is credible.</span>
<a name="l01469"></a>01469   <span class="keywordtype">int</span> y_res = <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a9d93e1d92ca230ae02b81d44bc88a55c" title="Image thresholding module.">thresholder_</a>-&gt;<a class="code" href="classtesseract_1_1_image_thresholder.html#a2fb94a4d1697c06bff68e33269297c59">GetScaledYResolution</a>();
<a name="l01470"></a>01470   <span class="keywordflow">if</span> (y_res &lt; kMinCredibleResolution || y_res &gt; <a class="code" href="namespacetesseract.html#a8ce8daeb42d63f39924c0a342e2cfdf4">kMaxCredibleResolution</a>) {
<a name="l01471"></a>01471     <span class="comment">// Use the minimum default resolution, as it is safer to under-estimate</span>
<a name="l01472"></a>01472     <span class="comment">// than over-estimate resolution.</span>
<a name="l01473"></a>01473     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a9d93e1d92ca230ae02b81d44bc88a55c" title="Image thresholding module.">thresholder_</a>-&gt;<a class="code" href="classtesseract_1_1_image_thresholder.html#af96fa2b6f4d1271640d5c8842f4fa9d6">SetSourceYResolution</a>(<a class="code" href="namespacetesseract.html#af670abba9a6fc5f36a04b8650e53d1b7" title="Minimum believable resolution.">kMinCredibleResolution</a>);
<a name="l01474"></a>01474   }
<a name="l01475"></a>01475   <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a9d93e1d92ca230ae02b81d44bc88a55c" title="Image thresholding module.">thresholder_</a>-&gt;<a class="code" href="classtesseract_1_1_image_thresholder.html#a8240c360cff397784e7e9f635d9ed7a3">ThresholdToPix</a>(pix);
<a name="l01476"></a>01476   <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a9d93e1d92ca230ae02b81d44bc88a55c" title="Image thresholding module.">thresholder_</a>-&gt;<a class="code" href="classtesseract_1_1_image_thresholder.html#a4e7f450e7c88d85a3e8dd8fa2baa3776">GetImageSizes</a>(&amp;<a class="code" href="group___thresholder_params.html#gab3c90d43a3628dc7abeb93e9ca01bc97">rect_left_</a>, &amp;<a class="code" href="group___thresholder_params.html#gac71648cd860510ca65b94d87d7d9bb1f">rect_top_</a>,
<a name="l01477"></a>01477                               &amp;<a class="code" href="group___thresholder_params.html#ga31dbaec91a5dd8ee7d399786a4bd5ef8">rect_width_</a>, &amp;<a class="code" href="group___thresholder_params.html#ga978edc537da096ec07d4bb8e4ae5332d">rect_height_</a>,
<a name="l01478"></a>01478                               &amp;<a class="code" href="group___thresholder_params.html#gaf3238cd7ff2c0995e647c8c7846bdba3">image_width_</a>, &amp;<a class="code" href="group___thresholder_params.html#gab7d24a78f3565c5bfb42b2592b9e8df0">image_height_</a>);
<a name="l01479"></a>01479   <span class="comment">// Set the internal resolution that is used for layout parameters from the</span>
<a name="l01480"></a>01480   <span class="comment">// estimated resolution, rather than the image resolution, which may be</span>
<a name="l01481"></a>01481   <span class="comment">// fabricated, but we will use the image resolution, if there is one, to</span>
<a name="l01482"></a>01482   <span class="comment">// report output point sizes.</span>
<a name="l01483"></a>01483   <span class="keywordtype">int</span> estimated_res = <a class="code" href="helpers_8h.html#af8739168d5b3235996eeb25dac3c4044">ClipToRange</a>(<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a9d93e1d92ca230ae02b81d44bc88a55c" title="Image thresholding module.">thresholder_</a>-&gt;<a class="code" href="classtesseract_1_1_image_thresholder.html#ac132bc7502f0e9d2f71f34afd6d2eb83">GetScaledEstimatedResolution</a>(),
<a name="l01484"></a>01484                                   <a class="code" href="namespacetesseract.html#af670abba9a6fc5f36a04b8650e53d1b7" title="Minimum believable resolution.">kMinCredibleResolution</a>,
<a name="l01485"></a>01485                                   <a class="code" href="namespacetesseract.html#a8ce8daeb42d63f39924c0a342e2cfdf4">kMaxCredibleResolution</a>);
<a name="l01486"></a>01486   <span class="keywordflow">if</span> (estimated_res != <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a9d93e1d92ca230ae02b81d44bc88a55c" title="Image thresholding module.">thresholder_</a>-&gt;<a class="code" href="classtesseract_1_1_image_thresholder.html#ac132bc7502f0e9d2f71f34afd6d2eb83">GetScaledEstimatedResolution</a>()) {
<a name="l01487"></a>01487     <a class="code" href="tprintf_8cpp.html#a0c2bcd4462ec67ab0971b34a0f610f55">tprintf</a>(<span class="stringliteral">&quot;Estimated resolution %d out of range! Corrected to %d\n&quot;</span>,
<a name="l01488"></a>01488             <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a9d93e1d92ca230ae02b81d44bc88a55c" title="Image thresholding module.">thresholder_</a>-&gt;<a class="code" href="classtesseract_1_1_image_thresholder.html#ac132bc7502f0e9d2f71f34afd6d2eb83">GetScaledEstimatedResolution</a>(), estimated_res);
<a name="l01489"></a>01489   }
<a name="l01490"></a>01490   <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#aa9ae12f56af64186b021aea99cb6bd52">set_source_resolution</a>(estimated_res);
<a name="l01491"></a>01491 }
<a name="l01492"></a>01492 
<a name="l01493"></a>01493 <span class="comment">// Find lines from the image making the BLOCK_LIST.</span>
<a name="l01494"></a><a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a86899716a1adde396be4efd57b547d27">01494</a> <span class="keywordtype">int</span> <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a86899716a1adde396be4efd57b547d27">TessBaseAPI::FindLines</a>() {
<a name="l01495"></a>01495   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a9d93e1d92ca230ae02b81d44bc88a55c" title="Image thresholding module.">thresholder_</a> == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a9d93e1d92ca230ae02b81d44bc88a55c" title="Image thresholding module.">thresholder_</a>-&gt;<a class="code" href="classtesseract_1_1_image_thresholder.html#a4a643445e9ab0e22fabe45308c6d2548" title="Return true if no image has been set.">IsEmpty</a>()) {
<a name="l01496"></a>01496     <a class="code" href="tprintf_8cpp.html#a0c2bcd4462ec67ab0971b34a0f610f55">tprintf</a>(<span class="stringliteral">&quot;Please call SetImage before attempting recognition.&quot;</span>);
<a name="l01497"></a>01497     <span class="keywordflow">return</span> -1;
<a name="l01498"></a>01498   }
<a name="l01499"></a>01499   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a7d4627f300b1096d43a3e7d54d8aa5df" title="page_res_ contains recognition data.">recognition_done_</a>)
<a name="l01500"></a>01500     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a83ca325b5e521416b1edcd020b169be0">ClearResults</a>();
<a name="l01501"></a>01501   <span class="keywordflow">if</span> (!<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ac22c36258b0cd727188505a9a1dbc7e1" title="The page layout.">block_list_</a>-&gt;empty()) {
<a name="l01502"></a>01502     <span class="keywordflow">return</span> 0;
<a name="l01503"></a>01503   }
<a name="l01504"></a>01504   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a> == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l01505"></a>01505     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a> = <span class="keyword">new</span> <a class="code" href="classtesseract_1_1_tesseract.html">Tesseract</a>;
<a name="l01506"></a>01506     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_classify.html#a2f9389a2d855d2a59e7892d3ba884887">InitAdaptiveClassifier</a>(<span class="keyword">false</span>);
<a name="l01507"></a>01507   }
<a name="l01508"></a>01508   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#a97fde2a457aa76137737b247a2418cb7">pix_binary</a>() == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l01509"></a>01509     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a8c8a3b050d6c356c4846345a3818f79e">Threshold</a>(<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#a512809e371c7bff1a24bb531721010a3">mutable_pix_binary</a>());
<a name="l01510"></a>01510   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#a8fc86e36e2808c9762f4b21d94c0bb4b">ImageWidth</a>() &gt; <a class="code" href="host_8h.html#a3905e54374e49708219791e7d59c60fb">MAX_INT16</a> ||
<a name="l01511"></a>01511       <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#a64ed376faed498243afb5637bb9a78e2">ImageHeight</a>() &gt; <a class="code" href="host_8h.html#a3905e54374e49708219791e7d59c60fb">MAX_INT16</a>) {
<a name="l01512"></a>01512     <a class="code" href="tprintf_8cpp.html#a0c2bcd4462ec67ab0971b34a0f610f55">tprintf</a>(<span class="stringliteral">&quot;Image too large: (%d, %d)\n&quot;</span>,
<a name="l01513"></a>01513             <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#a8fc86e36e2808c9762f4b21d94c0bb4b">ImageWidth</a>(), <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#a64ed376faed498243afb5637bb9a78e2">ImageHeight</a>());
<a name="l01514"></a>01514     <span class="keywordflow">return</span> -1;
<a name="l01515"></a>01515   }
<a name="l01516"></a>01516 
<a name="l01517"></a>01517   <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#ac91217d377d153e34cf89961cd9b0b2f">PrepareForPageseg</a>();
<a name="l01518"></a>01518 
<a name="l01519"></a>01519   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#aeec853f13be0d94e02e0f9dfad90e9bf">textord_equation_detect</a>) {
<a name="l01520"></a>01520     <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a0222d0f645909860d13f71c078008133" title="The equation detector.">equ_detect_</a> == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ad7c3d4ead7b9c8e27e45e710e5407913" title="Current location of tessdata.">datapath_</a> != <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l01521"></a>01521       <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a0222d0f645909860d13f71c078008133" title="The equation detector.">equ_detect_</a> = <span class="keyword">new</span> <a class="code" href="classtesseract_1_1_equation_detect.html">EquationDetect</a>(<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ad7c3d4ead7b9c8e27e45e710e5407913" title="Current location of tessdata.">datapath_</a>-&gt;<a class="code" href="class_s_t_r_i_n_g.html#a32beee43ecab1bed8bebc3466896ad6e">string</a>(), <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01522"></a>01522     }
<a name="l01523"></a>01523     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#a0fd6abd523392fabfa8ec77c4a6bd550">SetEquationDetect</a>(<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a0222d0f645909860d13f71c078008133" title="The equation detector.">equ_detect_</a>);
<a name="l01524"></a>01524   }
<a name="l01525"></a>01525 
<a name="l01526"></a>01526   <a class="code" href="classtesseract_1_1_tesseract.html">Tesseract</a>* osd_tess = <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ad7b44f5b470c9e04289c348d82726b27" title="For orientation &amp; script detection.">osd_tesseract_</a>;
<a name="l01527"></a>01527   <a class="code" href="struct_o_s_results.html">OSResults</a> osr;
<a name="l01528"></a>01528   <span class="keywordflow">if</span> (<a class="code" href="publictypes_8h.html#a3995a2a4ca67e595f22d7d540b03504b">PSM_OSD_ENABLED</a>(<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#a053d30f2b3df317e0d12e4a64f10d831">tessedit_pageseg_mode</a>) &amp;&amp; osd_tess == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l01529"></a>01529     <span class="keywordflow">if</span> (strcmp(<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a74a291190aa0bbf90b57f678b1fb0a5c" title="Last initialized language.">language_</a>-&gt;<a class="code" href="class_s_t_r_i_n_g.html#a32beee43ecab1bed8bebc3466896ad6e">string</a>(), <span class="stringliteral">&quot;osd&quot;</span>) == 0) {
<a name="l01530"></a>01530       osd_tess = <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>;
<a name="l01531"></a>01531     } <span class="keywordflow">else</span> {
<a name="l01532"></a>01532       <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ad7b44f5b470c9e04289c348d82726b27" title="For orientation &amp; script detection.">osd_tesseract_</a> = <span class="keyword">new</span> <a class="code" href="classtesseract_1_1_tesseract.html">Tesseract</a>;
<a name="l01533"></a>01533       <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ad7b44f5b470c9e04289c348d82726b27" title="For orientation &amp; script detection.">osd_tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#ae4558a3c1f64abeec1e1829056d8d1f3">init_tesseract</a>(
<a name="l01534"></a>01534           <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ad7c3d4ead7b9c8e27e45e710e5407913" title="Current location of tessdata.">datapath_</a>-&gt;<a class="code" href="class_s_t_r_i_n_g.html#a32beee43ecab1bed8bebc3466896ad6e">string</a>(), <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <span class="stringliteral">&quot;osd&quot;</span>, <a class="code" href="namespacetesseract.html#a04550a0ed1279562027bf2fc92c421aeaea8028f61e76a0f4def7cbe7905206cf">OEM_TESSERACT_ONLY</a>,
<a name="l01535"></a>01535           <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <span class="keyword">false</span>) == 0) {
<a name="l01536"></a>01536         osd_tess = <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ad7b44f5b470c9e04289c348d82726b27" title="For orientation &amp; script detection.">osd_tesseract_</a>;
<a name="l01537"></a>01537         <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ad7b44f5b470c9e04289c348d82726b27" title="For orientation &amp; script detection.">osd_tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#aa9ae12f56af64186b021aea99cb6bd52">set_source_resolution</a>(
<a name="l01538"></a>01538             <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a9d93e1d92ca230ae02b81d44bc88a55c" title="Image thresholding module.">thresholder_</a>-&gt;<a class="code" href="classtesseract_1_1_image_thresholder.html#abb962b7a1fc65945d08112f7496acce2">GetSourceYResolution</a>());
<a name="l01539"></a>01539       } <span class="keywordflow">else</span> {
<a name="l01540"></a>01540         <a class="code" href="tprintf_8cpp.html#a0c2bcd4462ec67ab0971b34a0f610f55">tprintf</a>(<span class="stringliteral">&quot;Warning: Auto orientation and script detection requested,&quot;</span>
<a name="l01541"></a>01541                 <span class="stringliteral">&quot; but osd language failed to load\n&quot;</span>);
<a name="l01542"></a>01542         <span class="keyword">delete</span> <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ad7b44f5b470c9e04289c348d82726b27" title="For orientation &amp; script detection.">osd_tesseract_</a>;
<a name="l01543"></a>01543         <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ad7b44f5b470c9e04289c348d82726b27" title="For orientation &amp; script detection.">osd_tesseract_</a> = <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01544"></a>01544       }
<a name="l01545"></a>01545     }
<a name="l01546"></a>01546   }
<a name="l01547"></a>01547 
<a name="l01548"></a>01548   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#a2f72a5b81529df216d9422ff92ab2762">SegmentPage</a>(<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a4690919aa9d4eabda36bdefdaadf7ac9" title="Name used by training code.">input_file_</a>, <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ac22c36258b0cd727188505a9a1dbc7e1" title="The page layout.">block_list_</a>, osd_tess, &amp;osr) &lt; 0)
<a name="l01549"></a>01549     <span class="keywordflow">return</span> -1;
<a name="l01550"></a>01550   <span class="comment">// If Devanagari is being recognized, we use different images for page seg</span>
<a name="l01551"></a>01551   <span class="comment">// and for OCR.</span>
<a name="l01552"></a>01552   <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#a8c193bd6f78f20373ed9b0fb63984733">PrepareForTessOCR</a>(<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ac22c36258b0cd727188505a9a1dbc7e1" title="The page layout.">block_list_</a>, osd_tess, &amp;osr);
<a name="l01553"></a>01553   <span class="keywordflow">return</span> 0;
<a name="l01554"></a>01554 }
<a name="l01555"></a>01555 
<a name="l01556"></a>01556 <span class="comment">// Delete the pageres and clear the block list ready for a new page.</span>
<a name="l01557"></a><a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a83ca325b5e521416b1edcd020b169be0">01557</a> <span class="keywordtype">void</span> <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a83ca325b5e521416b1edcd020b169be0">TessBaseAPI::ClearResults</a>() {
<a name="l01558"></a>01558   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a> != <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l01559"></a>01559     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#a55a27935c2314529c6fb4522ccf1de5a">Clear</a>();
<a name="l01560"></a>01560   }
<a name="l01561"></a>01561   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a12dda612630eba40e15f9d0b9955a04c" title="The page-level data.">page_res_</a> != <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l01562"></a>01562     <span class="keyword">delete</span> <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a12dda612630eba40e15f9d0b9955a04c" title="The page-level data.">page_res_</a>;
<a name="l01563"></a>01563     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a12dda612630eba40e15f9d0b9955a04c" title="The page-level data.">page_res_</a> = <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01564"></a>01564   }
<a name="l01565"></a>01565   <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a7d4627f300b1096d43a3e7d54d8aa5df" title="page_res_ contains recognition data.">recognition_done_</a> = <span class="keyword">false</span>;
<a name="l01566"></a>01566   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ac22c36258b0cd727188505a9a1dbc7e1" title="The page layout.">block_list_</a> == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l01567"></a>01567     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ac22c36258b0cd727188505a9a1dbc7e1" title="The page layout.">block_list_</a> = <span class="keyword">new</span> BLOCK_LIST;
<a name="l01568"></a>01568   <span class="keywordflow">else</span>
<a name="l01569"></a>01569     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ac22c36258b0cd727188505a9a1dbc7e1" title="The page layout.">block_list_</a>-&gt;clear();
<a name="l01570"></a>01570   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a06084d66b830a388515663761d842041">paragraph_models_</a> != <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l01571"></a>01571     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a06084d66b830a388515663761d842041">paragraph_models_</a>-&gt;<a class="code" href="class_generic_vector.html#a98f62dccd75224a60437c2761bd215cd">delete_data_pointers</a>();
<a name="l01572"></a>01572     <span class="keyword">delete</span> <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a06084d66b830a388515663761d842041">paragraph_models_</a>;
<a name="l01573"></a>01573     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a06084d66b830a388515663761d842041">paragraph_models_</a> = <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01574"></a>01574   }
<a name="l01575"></a>01575 }
<a name="l01576"></a>01576 
<a name="l01577"></a>01577 <span class="comment">// Return the length of the output text string, as UTF8, assuming</span>
<a name="l01578"></a>01578 <span class="comment">// liberally two spacing marks after each word (as paragraphs end with two</span>
<a name="l01579"></a>01579 <span class="comment">// newlines), and assuming a single character reject marker for each rejected</span>
<a name="l01580"></a>01580 <span class="comment">// character.</span>
<a name="l01581"></a>01581 <span class="comment">// Also return the number of recognized blobs in blob_count.</span>
<a name="l01582"></a><a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#aed3d481fc0c7dffad24572bd1f449598">01582</a> <span class="keywordtype">int</span> <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#aed3d481fc0c7dffad24572bd1f449598">TessBaseAPI::TextLength</a>(<span class="keywordtype">int</span>* blob_count) {
<a name="l01583"></a>01583   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a> == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a12dda612630eba40e15f9d0b9955a04c" title="The page-level data.">page_res_</a> == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l01584"></a>01584     <span class="keywordflow">return</span> 0;
<a name="l01585"></a>01585 
<a name="l01586"></a>01586   <a class="code" href="class_p_a_g_e___r_e_s___i_t.html">PAGE_RES_IT</a>   page_res_it(<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a12dda612630eba40e15f9d0b9955a04c" title="The page-level data.">page_res_</a>);
<a name="l01587"></a>01587   <span class="keywordtype">int</span> total_length = 2;
<a name="l01588"></a>01588   <span class="keywordtype">int</span> total_blobs = 0;
<a name="l01589"></a>01589   <span class="comment">// Iterate over the data structures to extract the recognition result.</span>
<a name="l01590"></a>01590   <span class="keywordflow">for</span> (page_res_it.<a class="code" href="class_p_a_g_e___r_e_s___i_t.html#a15febd45d0904bb3c5f7d506368177f0">restart_page</a>(); page_res_it.<a class="code" href="class_p_a_g_e___r_e_s___i_t.html#ab84b4850200ba8802791c6197c113fd0">word</a> () != <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01591"></a>01591        page_res_it.<a class="code" href="class_p_a_g_e___r_e_s___i_t.html#ab29005f235cc738eebafb7d9ed6fe70b">forward</a>()) {
<a name="l01592"></a>01592     <a class="code" href="class_w_e_r_d___r_e_s.html">WERD_RES</a> *word = page_res_it.<a class="code" href="class_p_a_g_e___r_e_s___i_t.html#ab84b4850200ba8802791c6197c113fd0">word</a>();
<a name="l01593"></a>01593     <a class="code" href="class_w_e_r_d___c_h_o_i_c_e.html">WERD_CHOICE</a>* choice = word-&gt;<a class="code" href="class_w_e_r_d___r_e_s.html#a3d42ac7ec121263e757c9b7160dfd50d">best_choice</a>;
<a name="l01594"></a>01594     <span class="keywordflow">if</span> (choice != <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l01595"></a>01595       total_blobs += choice-&gt;<a class="code" href="class_w_e_r_d___c_h_o_i_c_e.html#a7be59abe97b052dd3aaa324aea8c4a6c">length</a>() + 2;
<a name="l01596"></a>01596       total_length += choice-&gt;<a class="code" href="class_w_e_r_d___c_h_o_i_c_e.html#a41d740f0accccdfb245d34d554122116">unichar_string</a>().<a class="code" href="class_s_t_r_i_n_g.html#a168505a533eda60219c93e25adf4cdc5">length</a>() + 2;
<a name="l01597"></a>01597       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; word-&gt;<a class="code" href="class_w_e_r_d___r_e_s.html#ae24eb58be06cf275aee411d947fd31ef">reject_map</a>.<a class="code" href="class_r_e_j_m_a_p.html#ab3760d96d63b5ca6c4bfeb32ffc8183c">length</a>(); ++i) {
<a name="l01598"></a>01598         <span class="keywordflow">if</span> (word-&gt;<a class="code" href="class_w_e_r_d___r_e_s.html#ae24eb58be06cf275aee411d947fd31ef">reject_map</a>[i].rejected())
<a name="l01599"></a>01599           ++total_length;
<a name="l01600"></a>01600       }
<a name="l01601"></a>01601     }
<a name="l01602"></a>01602   }
<a name="l01603"></a>01603   <span class="keywordflow">if</span> (blob_count != <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l01604"></a>01604     *blob_count = total_blobs;
<a name="l01605"></a>01605   <span class="keywordflow">return</span> total_length;
<a name="l01606"></a>01606 }
<a name="l01607"></a>01607 
<a name="l01608"></a>01608 <span class="comment">// Estimates the Orientation And Script of the image.</span>
<a name="l01609"></a>01609 <span class="comment">// Returns true if the image was processed successfully.</span>
<a name="l01610"></a><a class="code" href="group___advanced_a_p_i.html#ga5ed6e495e7f1c269588a8b85e4e19ca8">01610</a> <span class="keywordtype">bool</span> <a class="code" href="group___advanced_a_p_i.html#ga5ed6e495e7f1c269588a8b85e4e19ca8">TessBaseAPI::DetectOS</a>(<a class="code" href="struct_o_s_results.html">OSResults</a>* osr) {
<a name="l01611"></a>01611   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a> == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l01612"></a>01612     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01613"></a>01613   <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a83ca325b5e521416b1edcd020b169be0">ClearResults</a>();
<a name="l01614"></a>01614   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#a97fde2a457aa76137737b247a2418cb7">pix_binary</a>() == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l01615"></a>01615     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a8c8a3b050d6c356c4846345a3818f79e">Threshold</a>(<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#a512809e371c7bff1a24bb531721010a3">mutable_pix_binary</a>());
<a name="l01616"></a>01616   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a4690919aa9d4eabda36bdefdaadf7ac9" title="Name used by training code.">input_file_</a> == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l01617"></a>01617     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a4690919aa9d4eabda36bdefdaadf7ac9" title="Name used by training code.">input_file_</a> = <span class="keyword">new</span> <a class="code" href="class_s_t_r_i_n_g.html">STRING</a>(<a class="code" href="namespacetesseract.html#a3ba7b8d4b2132f72118c62fba346ffd0">kInputFile</a>);
<a name="l01618"></a>01618   <span class="keywordflow">return</span> <a class="code" href="osdetect_8cpp.html#aec0e2284de8927ea9f29b61ff30d052a">orientation_and_script_detection</a>(*<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a4690919aa9d4eabda36bdefdaadf7ac9" title="Name used by training code.">input_file_</a>, osr, <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>);
<a name="l01619"></a>01619 }
<a name="l01620"></a>01620 
<a name="l01621"></a><a class="code" href="group___advanced_a_p_i.html#gac4a301ee35d57b0a7572d4434cae284c">01621</a> <span class="keywordtype">void</span> <a class="code" href="group___advanced_a_p_i.html#gac4a301ee35d57b0a7572d4434cae284c">TessBaseAPI::set_min_orientation_margin</a>(<span class="keywordtype">double</span> margin) {
<a name="l01622"></a>01622   <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#a08c494cab700c493b52a3417b16e9afa">min_orientation_margin</a>.set_value(margin);
<a name="l01623"></a>01623 }
<a name="l01624"></a>01624 
<a name="l01625"></a>01625 <span class="comment">// Return text orientation of each block as determined in an earlier page layout</span>
<a name="l01626"></a>01626 <span class="comment">// analysis operation. Orientation is returned as the number of ccw 90-degree</span>
<a name="l01627"></a>01627 <span class="comment">// rotations (in [0..3]) required to make the text in the block upright</span>
<a name="l01628"></a>01628 <span class="comment">// (readable). Note that this may not necessary be the block orientation</span>
<a name="l01629"></a>01629 <span class="comment">// preferred for recognition (such as the case of vertical CJK text).</span>
<a name="l01630"></a>01630 <span class="comment">//</span>
<a name="l01631"></a>01631 <span class="comment">// Also returns whether the text in the block is believed to have vertical</span>
<a name="l01632"></a>01632 <span class="comment">// writing direction (when in an upright page orientation).</span>
<a name="l01633"></a>01633 <span class="comment">//</span>
<a name="l01634"></a>01634 <span class="comment">// The returned array is of length equal to the number of text blocks, which may</span>
<a name="l01635"></a>01635 <span class="comment">// be less than the total number of blocks. The ordering is intended to be</span>
<a name="l01636"></a>01636 <span class="comment">// consistent with GetTextLines().</span>
<a name="l01637"></a><a class="code" href="group___advanced_a_p_i.html#ga16c4b28cadc2160bf18b84c3f897a2d2">01637</a> <span class="keywordtype">void</span> <a class="code" href="group___advanced_a_p_i.html#ga16c4b28cadc2160bf18b84c3f897a2d2">TessBaseAPI::GetBlockTextOrientations</a>(<span class="keywordtype">int</span>** block_orientation,
<a name="l01638"></a>01638                                            <span class="keywordtype">bool</span>** vertical_writing) {
<a name="l01639"></a>01639   <span class="keyword">delete</span>[] *block_orientation;
<a name="l01640"></a>01640   *block_orientation = <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01641"></a>01641   <span class="keyword">delete</span>[] *vertical_writing;
<a name="l01642"></a>01642   *vertical_writing = <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01643"></a>01643   BLOCK_IT block_it(<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ac22c36258b0cd727188505a9a1dbc7e1" title="The page layout.">block_list_</a>);
<a name="l01644"></a>01644 
<a name="l01645"></a>01645   block_it.move_to_first();
<a name="l01646"></a>01646   <span class="keywordtype">int</span> num_blocks = 0;
<a name="l01647"></a>01647   <span class="keywordflow">for</span> (block_it.mark_cycle_pt(); !block_it.cycled_list(); block_it.forward()) {
<a name="l01648"></a>01648     <span class="keywordflow">if</span> (!block_it.data()-&gt;poly_block()-&gt;IsText()) {
<a name="l01649"></a>01649       <span class="keywordflow">continue</span>;
<a name="l01650"></a>01650     }
<a name="l01651"></a>01651     ++num_blocks;
<a name="l01652"></a>01652   }
<a name="l01653"></a>01653   <span class="keywordflow">if</span> (!num_blocks) {
<a name="l01654"></a>01654     <a class="code" href="tprintf_8cpp.html#a0c2bcd4462ec67ab0971b34a0f610f55">tprintf</a>(<span class="stringliteral">&quot;WARNING: Found no blocks\n&quot;</span>);
<a name="l01655"></a>01655     <span class="keywordflow">return</span>;
<a name="l01656"></a>01656   }
<a name="l01657"></a>01657   *block_orientation = <span class="keyword">new</span> <span class="keywordtype">int</span>[num_blocks];
<a name="l01658"></a>01658   *vertical_writing = <span class="keyword">new</span> <span class="keywordtype">bool</span>[num_blocks];
<a name="l01659"></a>01659   block_it.move_to_first();
<a name="l01660"></a>01660   <span class="keywordtype">int</span> i = 0;
<a name="l01661"></a>01661   <span class="keywordflow">for</span> (block_it.mark_cycle_pt(); !block_it.cycled_list();
<a name="l01662"></a>01662        block_it.forward()) {
<a name="l01663"></a>01663     <span class="keywordflow">if</span> (!block_it.data()-&gt;poly_block()-&gt;IsText()) {
<a name="l01664"></a>01664       <span class="keywordflow">continue</span>;
<a name="l01665"></a>01665     }
<a name="l01666"></a>01666     <a class="code" href="class_f_c_o_o_r_d.html">FCOORD</a> re_rotation = block_it.data()-&gt;re_rotation();
<a name="l01667"></a>01667     <span class="keywordtype">float</span> re_theta = re_rotation.<a class="code" href="class_f_c_o_o_r_d.html#a4ab61cbf07eeb3473ae0ba6558fe9fb6" title="find angle">angle</a>();
<a name="l01668"></a>01668     <a class="code" href="class_f_c_o_o_r_d.html">FCOORD</a> classify_rotation = block_it.data()-&gt;classify_rotation();
<a name="l01669"></a>01669     <span class="keywordtype">float</span> classify_theta = classify_rotation.<a class="code" href="class_f_c_o_o_r_d.html#a4ab61cbf07eeb3473ae0ba6558fe9fb6" title="find angle">angle</a>();
<a name="l01670"></a>01670     <span class="keywordtype">double</span> rot_theta = - (re_theta - classify_theta) * 2.0 / <a class="code" href="const_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a>;
<a name="l01671"></a>01671     <span class="keywordflow">if</span> (rot_theta &lt; 0) rot_theta += 4;
<a name="l01672"></a>01672     <span class="keywordtype">int</span> num_rotations = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(rot_theta + 0.5);
<a name="l01673"></a>01673     (*block_orientation)[i] = num_rotations;
<a name="l01674"></a>01674     <span class="comment">// The classify_rotation is non-zero only if the text has vertical</span>
<a name="l01675"></a>01675     <span class="comment">// writing direction.</span>
<a name="l01676"></a>01676     (*vertical_writing)[i] = classify_rotation.<a class="code" href="class_f_c_o_o_r_d.html#a397f7ce997b246df18e7bd5a20cc422e">y</a>() != 0.0f;
<a name="l01677"></a>01677     ++i;
<a name="l01678"></a>01678   }
<a name="l01679"></a>01679 }
<a name="l01680"></a>01680 
<a name="l01681"></a>01681 <span class="comment">// ____________________________________________________________________________</span>
<a name="l01682"></a>01682 <span class="comment">// Ocropus add-ons.</span>
<a name="l01683"></a>01683 
<a name="l01684"></a>01684 <span class="comment">// Find lines from the image making the BLOCK_LIST.</span>
<a name="l01685"></a><a class="code" href="group___advanced_a_p_i.html#ga12273df6a36cd7b618029c21d0c53cfa">01685</a> BLOCK_LIST* <a class="code" href="group___advanced_a_p_i.html#ga12273df6a36cd7b618029c21d0c53cfa">TessBaseAPI::FindLinesCreateBlockList</a>() {
<a name="l01686"></a>01686   <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a86899716a1adde396be4efd57b547d27">FindLines</a>();
<a name="l01687"></a>01687   BLOCK_LIST* result = <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ac22c36258b0cd727188505a9a1dbc7e1" title="The page layout.">block_list_</a>;
<a name="l01688"></a>01688   <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#ac22c36258b0cd727188505a9a1dbc7e1" title="The page layout.">block_list_</a> = <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01689"></a>01689   <span class="keywordflow">return</span> result;
<a name="l01690"></a>01690 }
<a name="l01691"></a>01691 
<a name="l01692"></a>01692 <span class="comment">// Delete a block list.</span>
<a name="l01693"></a>01693 <span class="comment">// This is to keep BLOCK_LIST pointer opaque</span>
<a name="l01694"></a>01694 <span class="comment">// and let go of including the other headers.</span>
<a name="l01695"></a><a class="code" href="group___advanced_a_p_i.html#ga8f69791ff9730a032068c87bd7b92ca1">01695</a> <span class="keywordtype">void</span> <a class="code" href="group___advanced_a_p_i.html#ga8f69791ff9730a032068c87bd7b92ca1">TessBaseAPI::DeleteBlockList</a>(BLOCK_LIST *block_list) {
<a name="l01696"></a>01696   <span class="keyword">delete</span> block_list;
<a name="l01697"></a>01697 }
<a name="l01698"></a>01698 
<a name="l01699"></a>01699 
<a name="l01700"></a><a class="code" href="group___advanced_a_p_i.html#ga6188cb0fdcf944408db772131c545429">01700</a> <a class="code" href="class_r_o_w.html">ROW</a> *<a class="code" href="group___advanced_a_p_i.html#ga6188cb0fdcf944408db772131c545429">TessBaseAPI::MakeTessOCRRow</a>(<span class="keywordtype">float</span> <a class="code" href="mfoutline_8h.html#a2a4b69f9a2827dc98bc4cbc233118865a83297de004f4e58b9be2108c6cd08a23">baseline</a>,
<a name="l01701"></a>01701                                  <span class="keywordtype">float</span> xheight,
<a name="l01702"></a>01702                                  <span class="keywordtype">float</span> descender,
<a name="l01703"></a>01703                                  <span class="keywordtype">float</span> ascender) {
<a name="l01704"></a>01704   <a class="code" href="host_8h.html#aba1f582fd0168f3ff9225d8c90fa9eb8">inT32</a> xstarts[] = {-32000};
<a name="l01705"></a>01705   <span class="keywordtype">double</span> quad_coeffs[] = {0, 0, baseline};
<a name="l01706"></a>01706   <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="class_r_o_w.html">ROW</a>(1,
<a name="l01707"></a>01707                  xstarts,
<a name="l01708"></a>01708                  quad_coeffs,
<a name="l01709"></a>01709                  xheight,
<a name="l01710"></a>01710                  ascender - (baseline + xheight),
<a name="l01711"></a>01711                  descender - baseline,
<a name="l01712"></a>01712                  0,
<a name="l01713"></a>01713                  0);
<a name="l01714"></a>01714 }
<a name="l01715"></a>01715 
<a name="l01716"></a>01716 <span class="comment">// Creates a TBLOB* from the whole pix.</span>
<a name="l01717"></a><a class="code" href="group___advanced_a_p_i.html#ga0306bec5d154260922c203d8022832ca">01717</a> <a class="code" href="struct_t_b_l_o_b.html">TBLOB</a> *<a class="code" href="group___advanced_a_p_i.html#ga0306bec5d154260922c203d8022832ca">TessBaseAPI::MakeTBLOB</a>(Pix *pix) {
<a name="l01718"></a>01718   <span class="keywordtype">int</span> width = pixGetWidth(pix);
<a name="l01719"></a>01719   <span class="keywordtype">int</span> height = pixGetHeight(pix);
<a name="l01720"></a>01720   <a class="code" href="class_b_l_o_c_k.html">BLOCK</a> block(<span class="stringliteral">&quot;a character&quot;</span>, <a class="code" href="host_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>, 0, 0, 0, 0, width, height);
<a name="l01721"></a>01721 
<a name="l01722"></a>01722   <span class="comment">// Create C_BLOBs from the page</span>
<a name="l01723"></a>01723   <a class="code" href="edgblob_8cpp.html#a16ca13da58e65267e7e34355091ca891">extract_edges</a>(pix, &amp;block);
<a name="l01724"></a>01724 
<a name="l01725"></a>01725   <span class="comment">// Merge all C_BLOBs</span>
<a name="l01726"></a>01726   C_BLOB_LIST *list = block.<a class="code" href="class_b_l_o_c_k.html#a23196fe0d7230572b44aa77031a1d72a" title="get blobs">blob_list</a>();
<a name="l01727"></a>01727   C_BLOB_IT c_blob_it(list);
<a name="l01728"></a>01728   <span class="keywordflow">if</span> (c_blob_it.empty())
<a name="l01729"></a>01729     <span class="keywordflow">return</span> <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01730"></a>01730   <span class="comment">// Move all the outlines to the first blob.</span>
<a name="l01731"></a>01731   C_OUTLINE_IT ol_it(c_blob_it.data()-&gt;out_list());
<a name="l01732"></a>01732   <span class="keywordflow">for</span> (c_blob_it.forward();
<a name="l01733"></a>01733        !c_blob_it.at_first();
<a name="l01734"></a>01734        c_blob_it.forward()) {
<a name="l01735"></a>01735       <a class="code" href="class_c___b_l_o_b.html">C_BLOB</a> *c_blob = c_blob_it.data();
<a name="l01736"></a>01736       ol_it.add_list_after(c_blob-&gt;<a class="code" href="class_c___b_l_o_b.html#ae510f3d0e7398fbb46608082429eac89">out_list</a>());
<a name="l01737"></a>01737   }
<a name="l01738"></a>01738   <span class="comment">// Convert the first blob to the output TBLOB.</span>
<a name="l01739"></a>01739   <span class="keywordflow">return</span> <a class="code" href="struct_t_b_l_o_b.html#a49b1279a5ff4e05d6dd0beacd2d99395">TBLOB::PolygonalCopy</a>(c_blob_it.data());
<a name="l01740"></a>01740 }
<a name="l01741"></a>01741 
<a name="l01742"></a>01742 <span class="comment">// This method baseline normalizes a TBLOB in-place. The input row is used</span>
<a name="l01743"></a>01743 <span class="comment">// for normalization. The denorm is an optional parameter in which the</span>
<a name="l01744"></a>01744 <span class="comment">// normalization-antidote is returned.</span>
<a name="l01745"></a><a class="code" href="group___advanced_a_p_i.html#ga52efb13dbc0127d903cb3ecc5734ec7c">01745</a> <span class="keywordtype">void</span> <a class="code" href="group___advanced_a_p_i.html#ga52efb13dbc0127d903cb3ecc5734ec7c">TessBaseAPI::NormalizeTBLOB</a>(<a class="code" href="struct_t_b_l_o_b.html">TBLOB</a> *tblob, <a class="code" href="class_r_o_w.html">ROW</a> *row,
<a name="l01746"></a>01746                                  <span class="keywordtype">bool</span> numeric_mode, <a class="code" href="class_d_e_n_o_r_m.html">DENORM</a> *denorm) {
<a name="l01747"></a>01747   <a class="code" href="struct_t_w_e_r_d.html">TWERD</a> word;
<a name="l01748"></a>01748   word.<a class="code" href="struct_t_w_e_r_d.html#aeec31d57df04c8dac1cf3e6990d358a7">blobs</a> = tblob;
<a name="l01749"></a>01749   <span class="keywordflow">if</span> (denorm != <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l01750"></a>01750     word.<a class="code" href="struct_t_w_e_r_d.html#afbd0a7b21dd6c9fcbc265fb4b5117265">SetupBLNormalize</a>(<a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, row, row-&gt;<a class="code" href="class_r_o_w.html#a2954f94ec4eefe1e3729912e5b8ea779">x_height</a>(), numeric_mode, denorm);
<a name="l01751"></a>01751     word.<a class="code" href="struct_t_w_e_r_d.html#a830ae54d262e8348e098b5bab2aa4985">Normalize</a>(*denorm);
<a name="l01752"></a>01752   } <span class="keywordflow">else</span> {
<a name="l01753"></a>01753     <a class="code" href="class_d_e_n_o_r_m.html">DENORM</a> normer;
<a name="l01754"></a>01754     word.<a class="code" href="struct_t_w_e_r_d.html#afbd0a7b21dd6c9fcbc265fb4b5117265">SetupBLNormalize</a>(<a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, row, row-&gt;<a class="code" href="class_r_o_w.html#a2954f94ec4eefe1e3729912e5b8ea779">x_height</a>(), numeric_mode, &amp;normer);
<a name="l01755"></a>01755     word.<a class="code" href="struct_t_w_e_r_d.html#a830ae54d262e8348e098b5bab2aa4985">Normalize</a>(normer);
<a name="l01756"></a>01756   }
<a name="l01757"></a>01757   word.<a class="code" href="struct_t_w_e_r_d.html#aeec31d57df04c8dac1cf3e6990d358a7">blobs</a> = <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01758"></a>01758 }
<a name="l01759"></a>01759 
<a name="l01760"></a>01760 <span class="comment">// Return a TBLOB * from the whole pix.</span>
<a name="l01761"></a>01761 <span class="comment">// To be freed later with delete.</span>
<a name="l01762"></a><a class="code" href="namespacetesseract.html#a920259f2171a834a4e379e8a6a8460c5">01762</a> <a class="code" href="struct_t_b_l_o_b.html">TBLOB</a> *<a class="code" href="namespacetesseract.html#a920259f2171a834a4e379e8a6a8460c5">make_tesseract_blob</a>(<span class="keywordtype">float</span> <a class="code" href="mfoutline_8h.html#a2a4b69f9a2827dc98bc4cbc233118865a83297de004f4e58b9be2108c6cd08a23">baseline</a>, <span class="keywordtype">float</span> xheight,
<a name="l01763"></a>01763                            <span class="keywordtype">float</span> descender, <span class="keywordtype">float</span> ascender,
<a name="l01764"></a>01764                            <span class="keywordtype">bool</span> numeric_mode, Pix* pix) {
<a name="l01765"></a>01765   <a class="code" href="struct_t_b_l_o_b.html">TBLOB</a> *tblob = <a class="code" href="group___advanced_a_p_i.html#ga0306bec5d154260922c203d8022832ca">TessBaseAPI::MakeTBLOB</a>(pix);
<a name="l01766"></a>01766 
<a name="l01767"></a>01767   <span class="comment">// Normalize TBLOB</span>
<a name="l01768"></a>01768   <a class="code" href="class_r_o_w.html">ROW</a> *row =
<a name="l01769"></a>01769       <a class="code" href="group___advanced_a_p_i.html#ga6188cb0fdcf944408db772131c545429">TessBaseAPI::MakeTessOCRRow</a>(baseline, xheight, descender, ascender);
<a name="l01770"></a>01770   <a class="code" href="group___advanced_a_p_i.html#ga52efb13dbc0127d903cb3ecc5734ec7c">TessBaseAPI::NormalizeTBLOB</a>(tblob, row, numeric_mode, <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01771"></a>01771   <span class="keyword">delete</span> row;
<a name="l01772"></a>01772   <span class="keywordflow">return</span> tblob;
<a name="l01773"></a>01773 }
<a name="l01774"></a>01774 
<a name="l01775"></a>01775 
<a name="l01776"></a>01776 <span class="comment">// Adapt to recognize the current image as the given character.</span>
<a name="l01777"></a>01777 <span class="comment">// The image must be preloaded into pix_binary_ and be just an image</span>
<a name="l01778"></a>01778 <span class="comment">// of a single character.</span>
<a name="l01779"></a><a class="code" href="group__ocropus_add_ons.html#gaf62a3be9f3b8ca4f8260ec2cc1628ecc">01779</a> <span class="keywordtype">void</span> <a class="code" href="group__ocropus_add_ons.html#gaf62a3be9f3b8ca4f8260ec2cc1628ecc">TessBaseAPI::AdaptToCharacter</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *unichar_repr,
<a name="l01780"></a>01780                                    <span class="keywordtype">int</span> length,
<a name="l01781"></a>01781                                    <span class="keywordtype">float</span> <a class="code" href="mfoutline_8h.html#a2a4b69f9a2827dc98bc4cbc233118865a83297de004f4e58b9be2108c6cd08a23">baseline</a>,
<a name="l01782"></a>01782                                    <span class="keywordtype">float</span> xheight,
<a name="l01783"></a>01783                                    <span class="keywordtype">float</span> descender,
<a name="l01784"></a>01784                                    <span class="keywordtype">float</span> ascender) {
<a name="l01785"></a>01785   <a class="code" href="unichar_8h.html#a8578b19fa1ff5ca75080db1a18ecc32e">UNICHAR_ID</a> <span class="keywordtype">id</span> = <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_c_c_util.html#a69c5179ac5f10a24f3f97e16ca09460f">unicharset</a>.<a class="code" href="class_u_n_i_c_h_a_r_s_e_t.html#ae786fa834962ef4d6dbf8300c6c5d456">unichar_to_id</a>(unichar_repr, length);
<a name="l01786"></a>01786   <a class="code" href="struct_t_b_l_o_b.html">TBLOB</a> *blob = <a class="code" href="namespacetesseract.html#a920259f2171a834a4e379e8a6a8460c5">make_tesseract_blob</a>(baseline, xheight, descender, ascender,
<a name="l01787"></a>01787                                     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_classify.html#a57e449d38b255fe82e61d88ded8b0020">classify_bln_numeric_mode</a>,
<a name="l01788"></a>01788                                     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#a97fde2a457aa76137737b247a2418cb7">pix_binary</a>());
<a name="l01789"></a>01789   <span class="keywordtype">float</span> threshold;
<a name="l01790"></a>01790   <a class="code" href="unichar_8h.html#a8578b19fa1ff5ca75080db1a18ecc32e">UNICHAR_ID</a> best_class = 0;
<a name="l01791"></a>01791   <span class="keywordtype">float</span> best_rating = -100;
<a name="l01792"></a>01792 
<a name="l01793"></a>01793 
<a name="l01794"></a>01794   <span class="comment">// Classify to get a raw choice.</span>
<a name="l01795"></a>01795   BLOB_CHOICE_LIST choices;
<a name="l01796"></a>01796   <a class="code" href="class_d_e_n_o_r_m.html">DENORM</a> denorm;
<a name="l01797"></a>01797   <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_classify.html#a1f058451e32538b4dc2c853b82bc6600">AdaptiveClassifier</a>(blob, denorm, &amp;choices, <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l01798"></a>01798   BLOB_CHOICE_IT choice_it;
<a name="l01799"></a>01799   choice_it.set_to_list(&amp;choices);
<a name="l01800"></a>01800   <span class="keywordflow">for</span> (choice_it.mark_cycle_pt(); !choice_it.cycled_list();
<a name="l01801"></a>01801        choice_it.forward()) {
<a name="l01802"></a>01802     <span class="keywordflow">if</span> (choice_it.data()-&gt;rating() &gt; best_rating) {
<a name="l01803"></a>01803       best_rating = choice_it.data()-&gt;rating();
<a name="l01804"></a>01804       best_class = choice_it.data()-&gt;unichar_id();
<a name="l01805"></a>01805     }
<a name="l01806"></a>01806   }
<a name="l01807"></a>01807 
<a name="l01808"></a>01808   threshold = <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_classify.html#adc3a809a1a219f741a9e45a32e0d11bc">matcher_good_threshold</a>;
<a name="l01809"></a>01809 
<a name="l01810"></a>01810   <span class="keywordflow">if</span> (blob-&gt;<a class="code" href="struct_t_b_l_o_b.html#a3c9282cad4102157d214bcc6311cda07">outlines</a>)
<a name="l01811"></a>01811     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_classify.html#a53629ef3f5562677ae096bbce864e5ab">AdaptToChar</a>(blob, denorm, <span class="keywordtype">id</span>, kUnknownFontinfoId, threshold);
<a name="l01812"></a>01812   <span class="keyword">delete</span> blob;
<a name="l01813"></a>01813 }
<a name="l01814"></a>01814 
<a name="l01815"></a>01815 
<a name="l01816"></a><a class="code" href="group__ocropus_add_ons.html#ga0384f67e497ea3e81436d09da0ad7270">01816</a> <a class="code" href="class_p_a_g_e___r_e_s.html">PAGE_RES</a>* <a class="code" href="group__ocropus_add_ons.html#ga0384f67e497ea3e81436d09da0ad7270">TessBaseAPI::RecognitionPass1</a>(BLOCK_LIST* block_list) {
<a name="l01817"></a>01817   <a class="code" href="class_p_a_g_e___r_e_s.html">PAGE_RES</a> *page_res = <span class="keyword">new</span> <a class="code" href="class_p_a_g_e___r_e_s.html">PAGE_RES</a>(block_list,
<a name="l01818"></a>01818                                     &amp;(<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_wordrec.html#a143608f482c6c0c4f312740e6a5f5fd9">prev_word_best_choice_</a>));
<a name="l01819"></a>01819   <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#af9c097177e82c5f5495a7dc1506d66ed">recog_all_words</a>(page_res, <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 1);
<a name="l01820"></a>01820   <span class="keywordflow">return</span> page_res;
<a name="l01821"></a>01821 }
<a name="l01822"></a>01822 
<a name="l01823"></a><a class="code" href="group__ocropus_add_ons.html#ga158cc2af7170f3efa8cb140f2745d9b8">01823</a> <a class="code" href="class_p_a_g_e___r_e_s.html">PAGE_RES</a>* <a class="code" href="group__ocropus_add_ons.html#ga158cc2af7170f3efa8cb140f2745d9b8">TessBaseAPI::RecognitionPass2</a>(BLOCK_LIST* block_list,
<a name="l01824"></a>01824                                         <a class="code" href="class_p_a_g_e___r_e_s.html">PAGE_RES</a>* pass1_result) {
<a name="l01825"></a>01825   <span class="keywordflow">if</span> (!pass1_result)
<a name="l01826"></a>01826     pass1_result = <span class="keyword">new</span> <a class="code" href="class_p_a_g_e___r_e_s.html">PAGE_RES</a>(block_list,
<a name="l01827"></a>01827                                 &amp;(<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_wordrec.html#a143608f482c6c0c4f312740e6a5f5fd9">prev_word_best_choice_</a>));
<a name="l01828"></a>01828   <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#af9c097177e82c5f5495a7dc1506d66ed">recog_all_words</a>(pass1_result, <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 2);
<a name="l01829"></a>01829   <span class="keywordflow">return</span> pass1_result;
<a name="l01830"></a>01830 }
<a name="l01831"></a>01831 
<a name="l01832"></a><a class="code" href="group__ocropus_add_ons.html#ga97bb9808a0759d47e056ef516e8df47e">01832</a> <span class="keywordtype">void</span> <a class="code" href="group__ocropus_add_ons.html#ga97bb9808a0759d47e056ef516e8df47e">TessBaseAPI::DetectParagraphs</a>(<span class="keywordtype">int</span> debug_level) {
<a name="l01833"></a>01833   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a06084d66b830a388515663761d842041">paragraph_models_</a> == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l01834"></a>01834     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a06084d66b830a388515663761d842041">paragraph_models_</a> = <span class="keyword">new</span> <a class="code" href="class_generic_vector.html">GenericVector&lt;ParagraphModel*&gt;</a>;
<a name="l01835"></a>01835   <a class="code" href="classtesseract_1_1_mutable_iterator.html">MutableIterator</a> *result_it = <a class="code" href="group___advanced_a_p_i.html#ga29906219f78adc7fd76a83bde37e09eb">GetMutableIterator</a>();
<a name="l01836"></a>01836   <span class="keywordflow">do</span> {  <span class="comment">// Detect paragraphs for this block</span>
<a name="l01837"></a>01837     <a class="code" href="class_generic_vector.html">GenericVector&lt;ParagraphModel *&gt;</a> models;
<a name="l01838"></a>01838     <a class="code" href="group__ocropus_add_ons.html#ga97bb9808a0759d47e056ef516e8df47e">::tesseract::DetectParagraphs</a>(debug_level, result_it, &amp;models);
<a name="l01839"></a>01839     *<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a06084d66b830a388515663761d842041">paragraph_models_</a> += models;
<a name="l01840"></a>01840   } <span class="keywordflow">while</span> (result_it-&gt;<a class="code" href="classtesseract_1_1_result_iterator.html#abd8987e2387f1945b53cf23f99b663e1">Next</a>(<a class="code" href="namespacetesseract.html#aa26c22b65cc9765a0e747120f4287fd7a2dcea8d4208c16055353029d26f9bf49">RIL_BLOCK</a>));
<a name="l01841"></a>01841   <span class="keyword">delete</span> result_it;
<a name="l01842"></a>01842 }
<a name="l01843"></a>01843 
<a name="l01844"></a><a class="code" href="structtesseract_1_1_t_e_s_s___c_h_a_r.html">01844</a> <span class="keyword">struct </span><a class="code" href="structtesseract_1_1_t_e_s_s___c_h_a_r.html">TESS_CHAR</a> : <a class="code" href="class_e_l_i_s_t___l_i_n_k.html">ELIST_LINK</a> {
<a name="l01845"></a><a class="code" href="structtesseract_1_1_t_e_s_s___c_h_a_r.html#a26571c64aee9fc53688c36e7b636f442">01845</a>   <span class="keywordtype">char</span> *<a class="code" href="structtesseract_1_1_t_e_s_s___c_h_a_r.html#a26571c64aee9fc53688c36e7b636f442">unicode_repr</a>;
<a name="l01846"></a><a class="code" href="structtesseract_1_1_t_e_s_s___c_h_a_r.html#addc50bcc00bf59b95831fe5c7a8de558">01846</a>   <span class="keywordtype">int</span> <a class="code" href="structtesseract_1_1_t_e_s_s___c_h_a_r.html#addc50bcc00bf59b95831fe5c7a8de558">length</a>;  <span class="comment">// of unicode_repr</span>
<a name="l01847"></a><a class="code" href="structtesseract_1_1_t_e_s_s___c_h_a_r.html#a59dbd81cf9a36e402f6bbecee62c1bb3">01847</a>   <span class="keywordtype">float</span> <a class="code" href="structtesseract_1_1_t_e_s_s___c_h_a_r.html#a59dbd81cf9a36e402f6bbecee62c1bb3">cost</a>;
<a name="l01848"></a><a class="code" href="structtesseract_1_1_t_e_s_s___c_h_a_r.html#a1ca1136f40f70eb41350f7cd5d65a244">01848</a>   <a class="code" href="class_t_b_o_x.html">TBOX</a> <a class="code" href="structtesseract_1_1_t_e_s_s___c_h_a_r.html#a1ca1136f40f70eb41350f7cd5d65a244">box</a>;
<a name="l01849"></a>01849 
<a name="l01850"></a><a class="code" href="structtesseract_1_1_t_e_s_s___c_h_a_r.html#ad9c35da31a6b36d0cf1dd9dce0572da4">01850</a>   <a class="code" href="structtesseract_1_1_t_e_s_s___c_h_a_r.html#ad9c35da31a6b36d0cf1dd9dce0572da4">TESS_CHAR</a>(<span class="keywordtype">float</span> _cost, <span class="keyword">const</span> <span class="keywordtype">char</span> *repr, <span class="keywordtype">int</span> len = -1) : <a class="code" href="structtesseract_1_1_t_e_s_s___c_h_a_r.html#a59dbd81cf9a36e402f6bbecee62c1bb3">cost</a>(_cost) {
<a name="l01851"></a>01851     <a class="code" href="structtesseract_1_1_t_e_s_s___c_h_a_r.html#addc50bcc00bf59b95831fe5c7a8de558">length</a> = (len == -1 ? strlen(repr) : len);
<a name="l01852"></a>01852     <a class="code" href="structtesseract_1_1_t_e_s_s___c_h_a_r.html#a26571c64aee9fc53688c36e7b636f442">unicode_repr</a> = <span class="keyword">new</span> <span class="keywordtype">char</span>[<a class="code" href="structtesseract_1_1_t_e_s_s___c_h_a_r.html#addc50bcc00bf59b95831fe5c7a8de558">length</a> + 1];
<a name="l01853"></a>01853     strncpy(<a class="code" href="structtesseract_1_1_t_e_s_s___c_h_a_r.html#a26571c64aee9fc53688c36e7b636f442">unicode_repr</a>, repr, <a class="code" href="structtesseract_1_1_t_e_s_s___c_h_a_r.html#addc50bcc00bf59b95831fe5c7a8de558">length</a>);
<a name="l01854"></a>01854   }
<a name="l01855"></a>01855 
<a name="l01856"></a><a class="code" href="structtesseract_1_1_t_e_s_s___c_h_a_r.html#a790acae1a0c7dcd6bf9622ee384d3e3c">01856</a>   <a class="code" href="structtesseract_1_1_t_e_s_s___c_h_a_r.html#a790acae1a0c7dcd6bf9622ee384d3e3c">TESS_CHAR</a>() {  <span class="comment">// Satisfies ELISTIZE.</span>
<a name="l01857"></a>01857   }
<a name="l01858"></a><a class="code" href="structtesseract_1_1_t_e_s_s___c_h_a_r.html#afe67e07224557403466b301b29acb124">01858</a>   <a class="code" href="structtesseract_1_1_t_e_s_s___c_h_a_r.html#afe67e07224557403466b301b29acb124">~TESS_CHAR</a>() {
<a name="l01859"></a>01859     <span class="keyword">delete</span> [] <a class="code" href="structtesseract_1_1_t_e_s_s___c_h_a_r.html#a26571c64aee9fc53688c36e7b636f442">unicode_repr</a>;
<a name="l01860"></a>01860   }
<a name="l01861"></a>01861 };
<a name="l01862"></a>01862 
<a name="l01863"></a>01863 <a class="code" href="namespacetesseract.html#aad9b817c74cee6bd76a4912e7f54ff7b">ELISTIZEH</a>(TESS_CHAR)
<a name="l01864"></a>01864 <a class="code" href="namespacetesseract.html#a7c9c6594de104bda28d30b82eb3f65a9">ELISTIZE</a>(TESS_CHAR)
<a name="l01865"></a>01865 
<a name="l01866"></a>01866 static <span class="keywordtype">void</span> add_space(TESS_CHAR_IT* it) {
<a name="l01867"></a>01867   TESS_CHAR *t = <span class="keyword">new</span> TESS_CHAR(0, <span class="stringliteral">&quot; &quot;</span>);
<a name="l01868"></a>01868   it-&gt;add_after_then_move(t);
<a name="l01869"></a>01869 }
<a name="l01870"></a>01870 
<a name="l01871"></a>01871 
<a name="l01872"></a>01872 <span class="keyword">static</span> <span class="keywordtype">float</span> rating_to_cost(<span class="keywordtype">float</span> rating) {
<a name="l01873"></a>01873   rating = 100 + rating;
<a name="l01874"></a>01874   <span class="comment">// cuddled that to save from coverage profiler</span>
<a name="l01875"></a>01875   <span class="comment">// (I have never seen ratings worse than -100,</span>
<a name="l01876"></a>01876   <span class="comment">//  but the check won&#39;t hurt)</span>
<a name="l01877"></a>01877   <span class="keywordflow">if</span> (rating &lt; 0) rating = 0;
<a name="l01878"></a>01878   <span class="keywordflow">return</span> rating;
<a name="l01879"></a>01879 }
<a name="l01880"></a>01880 
<a name="l01881"></a>01881 
<a name="l01882"></a>01882 <span class="comment">// Extract the OCR results, costs (penalty points for uncertainty),</span>
<a name="l01883"></a>01883 <span class="comment">// and the bounding boxes of the characters.</span>
<a name="l01884"></a>01884 <span class="keyword">static</span> <span class="keywordtype">void</span> extract_result(TESS_CHAR_IT* out,
<a name="l01885"></a>01885                            <a class="code" href="class_p_a_g_e___r_e_s.html">PAGE_RES</a>* page_res) {
<a name="l01886"></a>01886   <a class="code" href="class_p_a_g_e___r_e_s___i_t.html">PAGE_RES_IT</a> page_res_it(page_res);
<a name="l01887"></a>01887   <span class="keywordtype">int</span> word_count = 0;
<a name="l01888"></a>01888   <span class="keywordflow">while</span> (page_res_it.word() != <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l01889"></a>01889     <a class="code" href="class_w_e_r_d___r_e_s.html">WERD_RES</a> *word = page_res_it.<a class="code" href="class_w_e_r_d___r_e_s.html#afc15fa7c1b5ad55d6772dea0d6865df1">word</a>();
<a name="l01890"></a>01890     <span class="keyword">const</span> <span class="keywordtype">char</span> *str = word-&gt;<a class="code" href="class_w_e_r_d___r_e_s.html#a3d42ac7ec121263e757c9b7160dfd50d">best_choice</a>-&gt;<a class="code" href="class_w_e_r_d___c_h_o_i_c_e.html#a41d740f0accccdfb245d34d554122116">unichar_string</a>().<a class="code" href="class_s_t_r_i_n_g.html#a32beee43ecab1bed8bebc3466896ad6e">string</a>();
<a name="l01891"></a>01891     <span class="keyword">const</span> <span class="keywordtype">char</span> *len = word-&gt;<a class="code" href="class_w_e_r_d___r_e_s.html#a3d42ac7ec121263e757c9b7160dfd50d">best_choice</a>-&gt;<a class="code" href="class_w_e_r_d___c_h_o_i_c_e.html#a93ab94b6fa6d5c0469fb52d66c62968c">unichar_lengths</a>().<a class="code" href="class_s_t_r_i_n_g.html#a32beee43ecab1bed8bebc3466896ad6e">string</a>();
<a name="l01892"></a>01892     <a class="code" href="class_t_b_o_x.html">TBOX</a> real_rect = word-&gt;<a class="code" href="class_w_e_r_d___r_e_s.html#afc15fa7c1b5ad55d6772dea0d6865df1">word</a>-&gt;<a class="code" href="class_w_e_r_d.html#a151bbfb39ecdef93ab1a14b0f9e4ac74">bounding_box</a>();
<a name="l01893"></a>01893 
<a name="l01894"></a>01894     <span class="keywordflow">if</span> (word_count)
<a name="l01895"></a>01895       add_space(out);
<a name="l01896"></a>01896     <span class="keywordtype">int</span> n = strlen(len);
<a name="l01897"></a>01897     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n; i++) {
<a name="l01898"></a>01898       TESS_CHAR *tc = <span class="keyword">new</span> TESS_CHAR(rating_to_cost(word-&gt;<a class="code" href="class_w_e_r_d___r_e_s.html#a3d42ac7ec121263e757c9b7160dfd50d">best_choice</a>-&gt;<a class="code" href="class_w_e_r_d___c_h_o_i_c_e.html#a52ea24dcb5ff15ad8aee3fd774622216">rating</a>()),
<a name="l01899"></a>01899                                     str, *len);
<a name="l01900"></a>01900       tc-&gt;box = real_rect.<a class="code" href="class_t_b_o_x.html#a33e45c7389737cdf1a908bca0af315c4">intersection</a>(word-&gt;<a class="code" href="class_w_e_r_d___r_e_s.html#a3a92c8c9750d78631d75998f008f366a">box_word</a>-&gt;<a class="code" href="classtesseract_1_1_box_word.html#a022cfe52a644e9e800595f014b1fbcf5">BlobBox</a>(i));
<a name="l01901"></a>01901       out-&gt;add_after_then_move(tc);
<a name="l01902"></a>01902        str += *len;
<a name="l01903"></a>01903       len++;
<a name="l01904"></a>01904     }
<a name="l01905"></a>01905     page_res_it.forward();
<a name="l01906"></a>01906     word_count++;
<a name="l01907"></a>01907   }
<a name="l01908"></a>01908 }
<a name="l01909"></a>01909 
<a name="l01910"></a>01910 
<a name="l01911"></a>01911 <span class="comment">// Extract the OCR results, costs (penalty points for uncertainty),</span>
<a name="l01912"></a>01912 <span class="comment">// and the bounding boxes of the characters.</span>
<a name="l01913"></a><a class="code" href="group__ocropus_add_ons.html#ga554e33b4a8fa10ccd2200698ded6753d">01913</a> <span class="keywordtype">int</span> <a class="code" href="group__ocropus_add_ons.html#ga554e33b4a8fa10ccd2200698ded6753d">TessBaseAPI::TesseractExtractResult</a>(<span class="keywordtype">char</span>** text,
<a name="l01914"></a>01914                                         <span class="keywordtype">int</span>** lengths,
<a name="l01915"></a>01915                                         <span class="keywordtype">float</span>** costs,
<a name="l01916"></a>01916                                         <span class="keywordtype">int</span>** x0,
<a name="l01917"></a>01917                                         <span class="keywordtype">int</span>** y0,
<a name="l01918"></a>01918                                         <span class="keywordtype">int</span>** x1,
<a name="l01919"></a>01919                                         <span class="keywordtype">int</span>** y1,
<a name="l01920"></a>01920                                         <a class="code" href="class_p_a_g_e___r_e_s.html">PAGE_RES</a>* page_res) {
<a name="l01921"></a>01921   TESS_CHAR_LIST tess_chars;
<a name="l01922"></a>01922   TESS_CHAR_IT tess_chars_it(&amp;tess_chars);
<a name="l01923"></a>01923   extract_result(&amp;tess_chars_it, page_res);
<a name="l01924"></a>01924   tess_chars_it.move_to_first();
<a name="l01925"></a>01925   <span class="keywordtype">int</span> n = tess_chars.length();
<a name="l01926"></a>01926   <span class="keywordtype">int</span> text_len = 0;
<a name="l01927"></a>01927   *lengths = <span class="keyword">new</span> <span class="keywordtype">int</span>[n];
<a name="l01928"></a>01928   *costs = <span class="keyword">new</span> <span class="keywordtype">float</span>[n];
<a name="l01929"></a>01929   *x0 = <span class="keyword">new</span> <span class="keywordtype">int</span>[n];
<a name="l01930"></a>01930   *y0 = <span class="keyword">new</span> <span class="keywordtype">int</span>[n];
<a name="l01931"></a>01931   *x1 = <span class="keyword">new</span> <span class="keywordtype">int</span>[n];
<a name="l01932"></a>01932   *y1 = <span class="keyword">new</span> <span class="keywordtype">int</span>[n];
<a name="l01933"></a>01933   <span class="keywordtype">int</span> i = 0;
<a name="l01934"></a>01934   <span class="keywordflow">for</span> (tess_chars_it.mark_cycle_pt();
<a name="l01935"></a>01935        !tess_chars_it.cycled_list();
<a name="l01936"></a>01936        tess_chars_it.forward(), i++) {
<a name="l01937"></a>01937     <a class="code" href="structtesseract_1_1_t_e_s_s___c_h_a_r.html">TESS_CHAR</a> *tc = tess_chars_it.data();
<a name="l01938"></a>01938     text_len += (*lengths)[i] = tc-&gt;<a class="code" href="structtesseract_1_1_t_e_s_s___c_h_a_r.html#addc50bcc00bf59b95831fe5c7a8de558">length</a>;
<a name="l01939"></a>01939     (*costs)[i] = tc-&gt;<a class="code" href="structtesseract_1_1_t_e_s_s___c_h_a_r.html#a59dbd81cf9a36e402f6bbecee62c1bb3">cost</a>;
<a name="l01940"></a>01940     (*x0)[i] = tc-&gt;<a class="code" href="structtesseract_1_1_t_e_s_s___c_h_a_r.html#a1ca1136f40f70eb41350f7cd5d65a244">box</a>.<a class="code" href="class_t_b_o_x.html#a724fabf566586b663577dfa944ffbc61">left</a>();
<a name="l01941"></a>01941     (*y0)[i] = tc-&gt;<a class="code" href="structtesseract_1_1_t_e_s_s___c_h_a_r.html#a1ca1136f40f70eb41350f7cd5d65a244">box</a>.<a class="code" href="class_t_b_o_x.html#a4451d237f1cd18c4982d63fe36a11fc3">bottom</a>();
<a name="l01942"></a>01942     (*x1)[i] = tc-&gt;<a class="code" href="structtesseract_1_1_t_e_s_s___c_h_a_r.html#a1ca1136f40f70eb41350f7cd5d65a244">box</a>.<a class="code" href="class_t_b_o_x.html#a8703081c1a1c26db3a4dddaca1028e34">right</a>();
<a name="l01943"></a>01943     (*y1)[i] = tc-&gt;<a class="code" href="structtesseract_1_1_t_e_s_s___c_h_a_r.html#a1ca1136f40f70eb41350f7cd5d65a244">box</a>.<a class="code" href="class_t_b_o_x.html#adf92e9fdac1bdf11c10d1c4d1178791a">top</a>();
<a name="l01944"></a>01944   }
<a name="l01945"></a>01945   <span class="keywordtype">char</span> *p = *text = <span class="keyword">new</span> <span class="keywordtype">char</span>[text_len];
<a name="l01946"></a>01946 
<a name="l01947"></a>01947   tess_chars_it.move_to_first();
<a name="l01948"></a>01948   <span class="keywordflow">for</span> (tess_chars_it.mark_cycle_pt();
<a name="l01949"></a>01949         !tess_chars_it.cycled_list();
<a name="l01950"></a>01950        tess_chars_it.forward()) {
<a name="l01951"></a>01951     <a class="code" href="structtesseract_1_1_t_e_s_s___c_h_a_r.html">TESS_CHAR</a> *tc = tess_chars_it.data();
<a name="l01952"></a>01952     strncpy(p, tc-&gt;<a class="code" href="structtesseract_1_1_t_e_s_s___c_h_a_r.html#a26571c64aee9fc53688c36e7b636f442">unicode_repr</a>, tc-&gt;<a class="code" href="structtesseract_1_1_t_e_s_s___c_h_a_r.html#addc50bcc00bf59b95831fe5c7a8de558">length</a>);
<a name="l01953"></a>01953     p += tc-&gt;<a class="code" href="structtesseract_1_1_t_e_s_s___c_h_a_r.html#addc50bcc00bf59b95831fe5c7a8de558">length</a>;
<a name="l01954"></a>01954   }
<a name="l01955"></a>01955   <span class="keywordflow">return</span> n;
<a name="l01956"></a>01956 }
<a name="l01957"></a>01957 
<a name="l01958"></a>01958 <span class="comment">// This method returns the features associated with the input blob.</span>
<a name="l01959"></a><a class="code" href="group___advanced_a_p_i.html#ga7e60370845b53aefa2e58d0e639435e2">01959</a> <span class="keywordtype">void</span> <a class="code" href="group___advanced_a_p_i.html#ga7e60370845b53aefa2e58d0e639435e2">TessBaseAPI::GetFeaturesForBlob</a>(<a class="code" href="struct_t_b_l_o_b.html">TBLOB</a>* blob, <span class="keyword">const</span> <a class="code" href="class_d_e_n_o_r_m.html">DENORM</a>&amp; denorm,
<a name="l01960"></a>01960                                      <a class="code" href="baseapi_8h.html#a544a6c7d78d215e9a4da202daecfeb52">INT_FEATURE_ARRAY</a> int_features,
<a name="l01961"></a>01961                                      <span class="keywordtype">int</span>* num_features,
<a name="l01962"></a>01962                                      <span class="keywordtype">int</span>* FeatureOutlineIndex) {
<a name="l01963"></a>01963   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>) {
<a name="l01964"></a>01964     <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_classify.html#a62ffff7932680b25784bfca5079ce347">ResetFeaturesHaveBeenExtracted</a>();
<a name="l01965"></a>01965   }
<a name="l01966"></a>01966   <a class="code" href="host_8h.html#a458fe97f82495945f8071bb3c18d1783">uinT8</a>* norm_array = <span class="keyword">new</span> <a class="code" href="host_8h.html#a458fe97f82495945f8071bb3c18d1783">uinT8</a>[<a class="code" href="matchdefs_8h.html#adcc52d7d059a8ca452172df64faa231c">MAX_NUM_CLASSES</a>];
<a name="l01967"></a>01967   <a class="code" href="host_8h.html#aba1f582fd0168f3ff9225d8c90fa9eb8">inT32</a> len;
<a name="l01968"></a>01968   *num_features = <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_classify.html#a1076d5d08686e48d39ef3eb07e711fb6">GetCharNormFeatures</a>(
<a name="l01969"></a>01969       blob, denorm, <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_classify.html#a64383806f917e682c4a644efdd71d530">PreTrainedTemplates</a>,
<a name="l01970"></a>01970       int_features, norm_array, norm_array, &amp;len, FeatureOutlineIndex);
<a name="l01971"></a>01971   <span class="keyword">delete</span> [] norm_array;
<a name="l01972"></a>01972 }
<a name="l01973"></a>01973 
<a name="l01974"></a>01974 <span class="comment">// This method returns the row to which a box of specified dimensions would</span>
<a name="l01975"></a>01975 <span class="comment">// belong. If no good match is found, it returns NULL.</span>
<a name="l01976"></a><a class="code" href="group___advanced_a_p_i.html#gab73311ecd1bf8f7e6f98585a76328740">01976</a> <a class="code" href="class_r_o_w.html">ROW</a>* <a class="code" href="group___advanced_a_p_i.html#gab73311ecd1bf8f7e6f98585a76328740">TessBaseAPI::FindRowForBox</a>(BLOCK_LIST* blocks,
<a name="l01977"></a>01977                                 <span class="keywordtype">int</span> left, <span class="keywordtype">int</span> top, <span class="keywordtype">int</span> right, <span class="keywordtype">int</span> bottom) {
<a name="l01978"></a>01978   <a class="code" href="class_t_b_o_x.html">TBOX</a> box(left, bottom, right, top);
<a name="l01979"></a>01979   BLOCK_IT b_it(blocks);
<a name="l01980"></a>01980   <span class="keywordflow">for</span> (b_it.mark_cycle_pt(); !b_it.cycled_list(); b_it.forward()) {
<a name="l01981"></a>01981     <a class="code" href="class_b_l_o_c_k.html">BLOCK</a>* block = b_it.data();
<a name="l01982"></a>01982     <span class="keywordflow">if</span> (!box.<a class="code" href="class_t_b_o_x.html#aeabe87a0ee3912ca63550ffee4fb4115">major_overlap</a>(block-&gt;<a class="code" href="class_p_d_b_l_k.html#a91950a96127b4a0bb9b237e1f5f889a4" title="get box">bounding_box</a>()))
<a name="l01983"></a>01983       <span class="keywordflow">continue</span>;
<a name="l01984"></a>01984     ROW_IT r_it(block-&gt;<a class="code" href="class_b_l_o_c_k.html#ae9826e422b0bf17a7592dee8db3fe058" title="get rows">row_list</a>());
<a name="l01985"></a>01985     <span class="keywordflow">for</span> (r_it.mark_cycle_pt(); !r_it.cycled_list(); r_it.forward()) {
<a name="l01986"></a>01986       <a class="code" href="class_r_o_w.html">ROW</a>* row = r_it.data();
<a name="l01987"></a>01987       <span class="keywordflow">if</span> (!box.<a class="code" href="class_t_b_o_x.html#aeabe87a0ee3912ca63550ffee4fb4115">major_overlap</a>(row-&gt;<a class="code" href="class_r_o_w.html#a7bb838e55056e39e15d7e2cea8ebebb0">bounding_box</a>()))
<a name="l01988"></a>01988         <span class="keywordflow">continue</span>;
<a name="l01989"></a>01989       WERD_IT w_it(row-&gt;<a class="code" href="class_r_o_w.html#ac9d07f978420b3564bf5508ad294fb70">word_list</a>());
<a name="l01990"></a>01990       <span class="keywordflow">for</span> (w_it.mark_cycle_pt(); !w_it.cycled_list(); w_it.forward()) {
<a name="l01991"></a>01991         <a class="code" href="class_w_e_r_d.html">WERD</a>* word = w_it.data();
<a name="l01992"></a>01992         <span class="keywordflow">if</span> (box.<a class="code" href="class_t_b_o_x.html#aeabe87a0ee3912ca63550ffee4fb4115">major_overlap</a>(word-&gt;<a class="code" href="class_w_e_r_d.html#a151bbfb39ecdef93ab1a14b0f9e4ac74">bounding_box</a>()))
<a name="l01993"></a>01993           <span class="keywordflow">return</span> row;
<a name="l01994"></a>01994       }
<a name="l01995"></a>01995     }
<a name="l01996"></a>01996   }
<a name="l01997"></a>01997   <span class="keywordflow">return</span> <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01998"></a>01998 }
<a name="l01999"></a>01999 
<a name="l02000"></a>02000 <span class="comment">// Method to run adaptive classifier on a blob.</span>
<a name="l02001"></a><a class="code" href="group___advanced_a_p_i.html#ga34a1c103414dd0293ff4d40c275a5971">02001</a> <span class="keywordtype">void</span> <a class="code" href="group___advanced_a_p_i.html#ga34a1c103414dd0293ff4d40c275a5971">TessBaseAPI::RunAdaptiveClassifier</a>(<a class="code" href="struct_t_b_l_o_b.html">TBLOB</a>* blob, <span class="keyword">const</span> <a class="code" href="class_d_e_n_o_r_m.html">DENORM</a>&amp; denorm,
<a name="l02002"></a>02002                                         <span class="keywordtype">int</span> num_max_matches,
<a name="l02003"></a>02003                                         <span class="keywordtype">int</span>* unichar_ids,
<a name="l02004"></a>02004                                         <span class="keywordtype">float</span>* ratings,
<a name="l02005"></a>02005                                         <span class="keywordtype">int</span>* num_matches_returned) {
<a name="l02006"></a>02006   BLOB_CHOICE_LIST* choices = <span class="keyword">new</span> BLOB_CHOICE_LIST;
<a name="l02007"></a>02007   <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_classify.html#a1f058451e32538b4dc2c853b82bc6600">AdaptiveClassifier</a>(blob, denorm, choices, <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l02008"></a>02008   BLOB_CHOICE_IT choices_it(choices);
<a name="l02009"></a>02009   <span class="keywordtype">int</span>&amp; index = *num_matches_returned;
<a name="l02010"></a>02010   index = 0;
<a name="l02011"></a>02011   <span class="keywordflow">for</span> (choices_it.mark_cycle_pt();
<a name="l02012"></a>02012        !choices_it.cycled_list() &amp;&amp; index &lt; num_max_matches;
<a name="l02013"></a>02013        choices_it.forward()) {
<a name="l02014"></a>02014     <a class="code" href="class_b_l_o_b___c_h_o_i_c_e.html">BLOB_CHOICE</a>* choice = choices_it.data();
<a name="l02015"></a>02015     unichar_ids[index] = choice-&gt;<a class="code" href="class_b_l_o_b___c_h_o_i_c_e.html#aaba6190b77c5f3dc21905fc4118afa94">unichar_id</a>();
<a name="l02016"></a>02016     ratings[index] = choice-&gt;<a class="code" href="class_b_l_o_b___c_h_o_i_c_e.html#a7fbd2d505bf5b55beee424096fb1e9bc">rating</a>();
<a name="l02017"></a>02017     ++index;
<a name="l02018"></a>02018   }
<a name="l02019"></a>02019   *num_matches_returned = index;
<a name="l02020"></a>02020   <span class="keyword">delete</span> choices;
<a name="l02021"></a>02021 }
<a name="l02022"></a>02022 
<a name="l02023"></a>02023 <span class="comment">// This method returns the string form of the specified unichar.</span>
<a name="l02024"></a><a class="code" href="group___advanced_a_p_i.html#ga34314bb3635a6e0d171e33d4b4181db2">02024</a> <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="group___advanced_a_p_i.html#ga34314bb3635a6e0d171e33d4b4181db2">TessBaseAPI::GetUnichar</a>(<span class="keywordtype">int</span> unichar_id) {
<a name="l02025"></a>02025   <span class="keywordflow">return</span> <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_c_c_util.html#a69c5179ac5f10a24f3f97e16ca09460f">unicharset</a>.<a class="code" href="class_u_n_i_c_h_a_r_s_e_t.html#a421c0b6ebcbbe7547490252fb688c961">id_to_unichar</a>(unichar_id);
<a name="l02026"></a>02026 }
<a name="l02027"></a>02027 
<a name="l02028"></a>02028 <span class="comment">// Return the pointer to the i-th dawg loaded into tesseract_ object.</span>
<a name="l02029"></a><a class="code" href="group___advanced_a_p_i.html#ga01fc04b1c673045ed8736c02c5943eaf">02029</a> <span class="keyword">const</span> <a class="code" href="classtesseract_1_1_dawg.html">Dawg</a> *<a class="code" href="group___advanced_a_p_i.html#ga01fc04b1c673045ed8736c02c5943eaf">TessBaseAPI::GetDawg</a>(<span class="keywordtype">int</span> i)<span class="keyword"> const </span>{
<a name="l02030"></a>02030   <span class="keywordflow">if</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a> == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || i &gt;= <a class="code" href="group___advanced_a_p_i.html#gac0a13108ccd514cab99badcb014d2f43">NumDawgs</a>()) <span class="keywordflow">return</span> <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l02031"></a>02031   <span class="keywordflow">return</span> <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_classify.html#a83e4207353a1bb07adfaa6a82a74c9ce">getDict</a>().<a class="code" href="classtesseract_1_1_dict.html#a774c3a8e23c9e4f47412936b304dae03" title="Return i-th dawg pointer recorded in the dawgs_ vector.">GetDawg</a>(i);
<a name="l02032"></a>02032 }
<a name="l02033"></a>02033 
<a name="l02034"></a>02034 <span class="comment">// Return the number of dawgs loaded into tesseract_ object.</span>
<a name="l02035"></a><a class="code" href="group___advanced_a_p_i.html#gac0a13108ccd514cab99badcb014d2f43">02035</a> <span class="keywordtype">int</span> <a class="code" href="group___advanced_a_p_i.html#gac0a13108ccd514cab99badcb014d2f43">TessBaseAPI::NumDawgs</a>()<span class="keyword"> const </span>{
<a name="l02036"></a>02036   <span class="keywordflow">return</span> <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a> == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> ? 0 : <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_classify.html#a83e4207353a1bb07adfaa6a82a74c9ce">getDict</a>().<a class="code" href="classtesseract_1_1_dict.html#a0a380d8e3aa8e0d3827b18ad5355b258" title="Return the number of dawgs in the dawgs_ vector.">NumDawgs</a>();
<a name="l02037"></a>02037 }
<a name="l02038"></a>02038 
<a name="l02039"></a>02039 <span class="comment">// Return a pointer to underlying CubeRecoContext object if present.</span>
<a name="l02040"></a><a class="code" href="group___advanced_a_p_i.html#ga4b21b3a15434987381804258d79651fc">02040</a> <a class="code" href="classtesseract_1_1_cube_reco_context.html">CubeRecoContext</a> *<a class="code" href="group___advanced_a_p_i.html#ga4b21b3a15434987381804258d79651fc">TessBaseAPI::GetCubeRecoContext</a>()<span class="keyword"> const </span>{
<a name="l02041"></a>02041   <span class="keywordflow">return</span> (<a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a> == <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) ? <a class="code" href="host_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> : <a class="code" href="classtesseract_1_1_tess_base_a_p_i.html#a247f50792f581df05afe336a2aeda402" title="The underlying data object.">tesseract_</a>-&gt;<a class="code" href="classtesseract_1_1_tesseract.html#a5ec41afb14f223dd2ab976363efa8b58">GetCubeRecoContext</a>();
<a name="l02042"></a>02042 }
<a name="l02043"></a>02043 }  <span class="comment">// namespace tesseract.</span>
</pre></div></div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="baseapi_8cpp.html">baseapi.cpp</a>      </li>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>


    <li class="footer">Generated on Thu Mar 29 2012 23:42:08 for Tesseract by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.5.1 </li>
   </ul>
 </div>


</body>
</html>
